!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.ramlClientGeneratorPlugin=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){},{}],2:[function(require,module,exports){(function(global){"use strict";var buffer=require("buffer"),Buffer=buffer.Buffer,SlowBuffer=buffer.SlowBuffer,MAX_LEN=buffer.kMaxLength||2147483647;exports.alloc=function(size,fill,encoding){if("function"==typeof Buffer.alloc)return Buffer.alloc(size,fill,encoding);if("number"==typeof encoding)throw new TypeError("encoding must not be number");if("number"!=typeof size)throw new TypeError("size must be a number");if(size>MAX_LEN)throw new RangeError("size is too large");var enc=encoding,_fill=fill;void 0===_fill&&(enc=void 0,_fill=0);var buf=new Buffer(size);if("string"==typeof _fill)for(var fillBuf=new Buffer(_fill,enc),flen=fillBuf.length,i=-1;++i<size;)buf[i]=fillBuf[i%flen];else buf.fill(_fill);return buf},exports.allocUnsafe=function(size){if("function"==typeof Buffer.allocUnsafe)return Buffer.allocUnsafe(size);if("number"!=typeof size)throw new TypeError("size must be a number");if(size>MAX_LEN)throw new RangeError("size is too large");return new Buffer(size)},exports.from=function(value,encodingOrOffset,length){if("function"==typeof Buffer.from&&(!global.Uint8Array||Uint8Array.from!==Buffer.from))return Buffer.from(value,encodingOrOffset,length);if("number"==typeof value)throw new TypeError('"value" argument must not be a number');if("string"==typeof value)return new Buffer(value,encodingOrOffset);if("undefined"!=typeof ArrayBuffer&&value instanceof ArrayBuffer){var offset=encodingOrOffset;if(1===arguments.length)return new Buffer(value);"undefined"==typeof offset&&(offset=0);var len=length;if("undefined"==typeof len&&(len=value.byteLength-offset),offset>=value.byteLength)throw new RangeError("'offset' is out of bounds");if(len>value.byteLength-offset)throw new RangeError("'length' is out of bounds");return new Buffer(value.slice(offset,offset+len))}if(Buffer.isBuffer(value)){var out=new Buffer(value.length);return value.copy(out,0,0,value.length),out}if(value){if(Array.isArray(value)||"undefined"!=typeof ArrayBuffer&&value.buffer instanceof ArrayBuffer||"length"in value)return new Buffer(value);if("Buffer"===value.type&&Array.isArray(value.data))return new Buffer(value.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")},exports.allocUnsafeSlow=function(size){if("function"==typeof Buffer.allocUnsafeSlow)return Buffer.allocUnsafeSlow(size);if("number"!=typeof size)throw new TypeError("size must be a number");if(size>=MAX_LEN)throw new RangeError("size is too large");return new SlowBuffer(size)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{buffer:6}],3:[function(require,module,exports){(function(Buffer){function isArray(arg){return Array.isArray?Array.isArray(arg):"[object Array]"===objectToString(arg)}function isBoolean(arg){return"boolean"==typeof arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}function isNumber(arg){return"number"==typeof arg}function isString(arg){return"string"==typeof arg}function isSymbol(arg){return"symbol"==typeof arg}function isUndefined(arg){return void 0===arg}function isRegExp(re){return"[object RegExp]"===objectToString(re)}function isObject(arg){return"object"==typeof arg&&null!==arg}function isDate(d){return"[object Date]"===objectToString(d)}function isError(e){return"[object Error]"===objectToString(e)||e instanceof Error}function isFunction(arg){return"function"==typeof arg}function isPrimitive(arg){return null===arg||"boolean"==typeof arg||"number"==typeof arg||"string"==typeof arg||"symbol"==typeof arg||"undefined"==typeof arg}function objectToString(o){return Object.prototype.toString.call(o)}exports.isArray=isArray,exports.isBoolean=isBoolean,exports.isNull=isNull,exports.isNullOrUndefined=isNullOrUndefined,exports.isNumber=isNumber,exports.isString=isString,exports.isSymbol=isSymbol,exports.isUndefined=isUndefined,exports.isRegExp=isRegExp,exports.isObject=isObject,exports.isDate=isDate,exports.isError=isError,exports.isFunction=isFunction,exports.isPrimitive=isPrimitive,exports.isBuffer=Buffer.isBuffer}).call(this,{isBuffer:require("../../is-buffer/index.js")})},{"../../is-buffer/index.js":21}],4:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:code<NUMBER?-1:code<NUMBER+10?code-NUMBER+26+26:code<UPPER+26?code-UPPER:code<LOWER+26?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;i<l;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;i<length;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],5:[function(require,module,exports){arguments[4][1][0].apply(exports,arguments)},{dup:1}],6:[function(require,module,exports){(function(global){"use strict";function typedArraySupport(){function Bar(){}try{var arr=new Uint8Array(1);return arr.foo=function(){return 42},arr.constructor=Bar,42===arr.foo()&&arr.constructor===Bar&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){return this instanceof Buffer?(Buffer.TYPED_ARRAY_SUPPORT||(this.length=0,this.parent=void 0),"number"==typeof arg?fromNumber(this,arg):"string"==typeof arg?fromString(this,arg,arguments.length>1?arguments[1]:"utf8"):fromObject(this,arg)):arguments.length>1?new Buffer(arg,arguments[1]):new Buffer(arg)}function fromNumber(that,length){if(that=allocate(that,length<0?0:0|checked(length)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;i<length;i++)that[i]=0;return that}function fromString(that,string,encoding){"string"==typeof encoding&&""!==encoding||(encoding="utf8");var length=0|byteLength(string,encoding);return that=allocate(that,length),that.write(string,encoding),that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(null==object)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(object.buffer instanceof ArrayBuffer)return fromTypedArray(that,object);if(object instanceof ArrayBuffer)return fromArrayBuffer(that,object)}return object.length?fromArrayLike(that,object):fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=0|checked(buffer.length);return that=allocate(that,length),buffer.copy(that,0,0,length),that}function fromArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromTypedArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array){return Buffer.TYPED_ARRAY_SUPPORT?(array.byteLength,that=Buffer._augment(new Uint8Array(array))):that=fromTypedArray(that,new Uint8Array(array)),that}function fromArrayLike(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function fromJsonObject(that,object){var array,length=0;"Buffer"===object.type&&isArray(object.data)&&(array=object.data,length=0|checked(array.length)),that=allocate(that,length);for(var i=0;i<length;i+=1)that[i]=255&array[i];return that}function allocate(that,length){Buffer.TYPED_ARRAY_SUPPORT?(that=Buffer._augment(new Uint8Array(length)),that.__proto__=Buffer.prototype):(that.length=length,that._isBuffer=!0);var fromPool=0!==length&&length<=Buffer.poolSize>>>1;return fromPool&&(that.parent=rootParent),that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);return delete buf.parent,buf}function byteLength(string,encoding){"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if(start=0|start,end=void 0===end||end===1/0?this.length:0|end,encoding||(encoding="utf8"),start<0&&(start=0),end>this.length&&(end=this.length),end<=start)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;i<length;i++){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;i<end;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(i+bytesPerSequence<=end){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:firstByte<128&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128===(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte,tempCodePoint>127&&(codePoint=tempCodePoint));break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128===(192&secondByte)&&128===(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte,tempCodePoint>2047&&(tempCodePoint<55296||tempCodePoint>57343)&&(codePoint=tempCodePoint));break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128===(192&secondByte)&&128===(192&thirdByte)&&128===(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte,tempCodePoint>65535&&tempCodePoint<1114112&&(codePoint=tempCodePoint))}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(len<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;i<len;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(127&buf[i]);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;i<end;i++)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||start<0)&&(start=0),(!end||end<0||end>len)&&(end=len);for(var out="",i=start;i<end;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||offset<0)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){value<0&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);i<j;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){value<0&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);i<j;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||value<min)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(offset<0)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return n<16?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;i<length;i++){if(codePoint=string.charCodeAt(i),codePoint>55295&&codePoint<57344){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(codePoint<56320){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,codePoint<128){if((units-=1)<0)break;bytes.push(codePoint)}else if(codePoint<2048){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(codePoint<65536){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(codePoint<1114112))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;i<length&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("isarray");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT?(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array):(Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);i<len&&a[i]===b[i];)++i;return i!==len&&(x=a[i],y=b[i]),x<y?-1:y<x?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(0===list.length)return new Buffer(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;i++)length+=list[i].length;var buf=new Buffer(length),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=byteLength,Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b||0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:Buffer.compare(this,b)},Buffer.prototype.indexOf=function(val,byteOffset){function arrayIndexOf(arr,val,byteOffset){for(var foundIndex=-1,i=0;byteOffset+i<arr.length;i++)if(arr[byteOffset+i]===val[foundIndex===-1?0:i-foundIndex]){if(foundIndex===-1&&(foundIndex=i),i-foundIndex+1===val.length)return byteOffset+foundIndex}else foundIndex=-1;return-1}if(byteOffset>2147483647?byteOffset=2147483647:byteOffset<-2147483648&&(byteOffset=-2147483648),byteOffset>>=0,0===this.length)return-1;if(byteOffset>=this.length)return-1;if(byteOffset<0&&(byteOffset=Math.max(this.length+byteOffset,0)),"string"==typeof val)return 0===val.length?-1:String.prototype.indexOf.call(this,val,byteOffset);if(Buffer.isBuffer(val))return arrayIndexOf(this,val,byteOffset);if("number"==typeof val)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,val,byteOffset):arrayIndexOf(this,[val],byteOffset);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else if(isFinite(offset))offset=0|offset,isFinite(length)?(length=0|length,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=0|length,length=swap}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(length<0||offset<0)||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,start<0?(start+=len,start<0&&(start=0)):start>len&&(start=len),end<0?(end+=len,end<0&&(end=0)):end>len&&(end=len),end<start&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=Buffer._augment(this.subarray(start,end));else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,(void 0));for(var i=0;i<sliceLen;i++)newBuf[i]=this[i+start]}return newBuf.length&&(newBuf.parent=this.parent||this),newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?(255-this[offset]+1)*-1:this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=value<0?1:0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=value<0?1:0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),value<0&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),value<0&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){
if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&end<start&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(targetStart<0)throw new RangeError("targetStart out of bounds");if(start<0||start>=this.length)throw new RangeError("sourceStart out of bounds");if(end<0)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&start<targetStart&&targetStart<end)for(i=len-1;i>=0;i--)target[i+targetStart]=this[i+start];else if(len<1e3||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;i<len;i++)target[i+targetStart]=this[i+start];else target._set(this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),end<start)throw new RangeError("end < start");if(end!==start&&0!==this.length){if(start<0||start>=this.length)throw new RangeError("start out of bounds");if(end<0||end>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof value)for(i=start;i<end;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;i<end;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;i<len;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr.constructor=Buffer,arr._isBuffer=!0,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.indexOf=BP.indexOf,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUIntLE=BP.readUIntLE,arr.readUIntBE=BP.readUIntBE,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readIntLE=BP.readIntLE,arr.readIntBE=BP.readIntBE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUIntLE=BP.writeUIntLE,arr.writeUIntBE=BP.writeUIntBE,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeIntLE=BP.writeIntLE,arr.writeIntBE=BP.writeIntBE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":4,ieee754:17,isarray:7}],7:[function(require,module,exports){var toString={}.toString;module.exports=Array.isArray||function(arr){return"[object Array]"==toString.call(arr)}},{}],8:[function(require,module,exports){module.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{}],9:[function(require,module,exports){function EventEmitter(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function isFunction(arg){return"function"==typeof arg}function isNumber(arg){return"number"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isUndefined(arg){return void 0===arg}module.exports=EventEmitter,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._maxListeners=void 0,EventEmitter.defaultMaxListeners=10,EventEmitter.prototype.setMaxListeners=function(n){if(!isNumber(n)||n<0||isNaN(n))throw TypeError("n must be a positive number");return this._maxListeners=n,this},EventEmitter.prototype.emit=function(type){var er,handler,len,args,i,listeners;if(this._events||(this._events={}),"error"===type&&(!this._events.error||isObject(this._events.error)&&!this._events.error.length)){if(er=arguments[1],er instanceof Error)throw er;throw TypeError('Uncaught, unspecified "error" event.')}if(handler=this._events[type],isUndefined(handler))return!1;if(isFunction(handler))switch(arguments.length){case 1:handler.call(this);break;case 2:handler.call(this,arguments[1]);break;case 3:handler.call(this,arguments[1],arguments[2]);break;default:for(len=arguments.length,args=new Array(len-1),i=1;i<len;i++)args[i-1]=arguments[i];handler.apply(this,args)}else if(isObject(handler)){for(len=arguments.length,args=new Array(len-1),i=1;i<len;i++)args[i-1]=arguments[i];for(listeners=handler.slice(),len=listeners.length,i=0;i<len;i++)listeners[i].apply(this,args)}return!0},EventEmitter.prototype.addListener=function(type,listener){var m;if(!isFunction(listener))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",type,isFunction(listener.listener)?listener.listener:listener),this._events[type]?isObject(this._events[type])?this._events[type].push(listener):this._events[type]=[this._events[type],listener]:this._events[type]=listener,isObject(this._events[type])&&!this._events[type].warned){var m;m=isUndefined(this._maxListeners)?EventEmitter.defaultMaxListeners:this._maxListeners,m&&m>0&&this._events[type].length>m&&(this._events[type].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[type].length),"function"==typeof console.trace&&console.trace())}return this},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.once=function(type,listener){function g(){this.removeListener(type,g),fired||(fired=!0,listener.apply(this,arguments))}if(!isFunction(listener))throw TypeError("listener must be a function");var fired=!1;return g.listener=listener,this.on(type,g),this},EventEmitter.prototype.removeListener=function(type,listener){var list,position,length,i;if(!isFunction(listener))throw TypeError("listener must be a function");if(!this._events||!this._events[type])return this;if(list=this._events[type],length=list.length,position=-1,list===listener||isFunction(list.listener)&&list.listener===listener)delete this._events[type],this._events.removeListener&&this.emit("removeListener",type,listener);else if(isObject(list)){for(i=length;i-- >0;)if(list[i]===listener||list[i].listener&&list[i].listener===listener){position=i;break}if(position<0)return this;1===list.length?(list.length=0,delete this._events[type]):list.splice(position,1),this._events.removeListener&&this.emit("removeListener",type,listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var key,listeners;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[type]&&delete this._events[type],this;if(0===arguments.length){for(key in this._events)"removeListener"!==key&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events={},this}if(listeners=this._events[type],isFunction(listeners))this.removeListener(type,listeners);else for(;listeners.length;)this.removeListener(type,listeners[listeners.length-1]);return delete this._events[type],this},EventEmitter.prototype.listeners=function(type){var ret;return ret=this._events&&this._events[type]?isFunction(this._events[type])?[this._events[type]]:this._events[type].slice():[]},EventEmitter.listenerCount=function(emitter,type){var ret;return ret=emitter._events&&emitter._events[type]?isFunction(emitter._events[type])?1:emitter._events[type].length:0}},{}],10:[function(require,module,exports){var hasOwn=Object.prototype.hasOwnProperty,toString=Object.prototype.toString;module.exports=function(obj,fn,ctx){if("[object Function]"!==toString.call(fn))throw new TypeError("iterator must be a function");var l=obj.length;if(l===+l)for(var i=0;i<l;i++)fn.call(ctx,obj[i],i,obj);else for(var k in obj)hasOwn.call(obj,k)&&fn.call(ctx,obj[k],k,obj)}},{}],11:[function(require,module,exports){var ClientRequest=require("./lib/request"),extend=require("xtend"),statusCodes=require("builtin-status-codes"),url=require("url"),http=exports;http.request=function(opts,cb){opts="string"==typeof opts?url.parse(opts):extend(opts);var protocol=opts.protocol||"",host=opts.hostname||opts.host,port=opts.port,path=opts.path||"/";host&&host.indexOf(":")!==-1&&(host="["+host+"]"),opts.url=(host?protocol+"//"+host:"")+(port?":"+port:"")+path,opts.method=(opts.method||"GET").toUpperCase(),opts.headers=opts.headers||{};var req=new ClientRequest(opts);return cb&&req.on("response",cb),req},http.get=function(opts,cb){var req=http.request(opts,cb);return req.end(),req},http.Agent=function(){},http.Agent.defaultMaxSockets=4,http.STATUS_CODES=statusCodes,http.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]},{"./lib/request":13,"builtin-status-codes":8,url:15,xtend:70}],12:[function(require,module,exports){(function(global){function checkTypeSupport(type){try{return xhr.responseType=type,xhr.responseType===type}catch(e){}return!1}function isFunction(value){return"function"==typeof value}exports.fetch=isFunction(global.fetch)&&isFunction(global.ReadableByteStream),exports.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),exports.blobConstructor=!0}catch(e){}var xhr=new global.XMLHttpRequest;xhr.open("GET",global.location.host?"/":"https://example.com");var haveArrayBuffer="undefined"!=typeof global.ArrayBuffer,haveSlice=haveArrayBuffer&&isFunction(global.ArrayBuffer.prototype.slice);exports.arraybuffer=haveArrayBuffer&&checkTypeSupport("arraybuffer"),exports.msstream=!exports.fetch&&haveSlice&&checkTypeSupport("ms-stream"),exports.mozchunkedarraybuffer=!exports.fetch&&haveArrayBuffer&&checkTypeSupport("moz-chunked-arraybuffer"),exports.overrideMimeType=isFunction(xhr.overrideMimeType),exports.vbArray=isFunction(global.VBArray),xhr=null}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],13:[function(require,module,exports){(function(process,global,Buffer){function decideMode(preferBinary){return capability.fetch?"fetch":capability.mozchunkedarraybuffer?"moz-chunked-arraybuffer":capability.msstream?"ms-stream":capability.arraybuffer&&preferBinary?"arraybuffer":capability.vbArray&&preferBinary?"text:vbarray":"text"}function statusValid(xhr){try{return null!==xhr.status}catch(e){return!1}}var capability=require("./capability"),foreach=require("foreach"),indexOf=require("indexof"),inherits=require("inherits"),keys=require("object-keys"),response=require("./response"),stream=require("stream"),IncomingMessage=response.IncomingMessage,rStates=response.readyStates,ClientRequest=module.exports=function(opts){var self=this;stream.Writable.call(self),self._opts=opts,self._body=[],self._headers={},opts.auth&&self.setHeader("Authorization","Basic "+new Buffer(opts.auth).toString("base64")),foreach(keys(opts.headers),function(name){self.setHeader(name,opts.headers[name])});var preferBinary;if("prefer-streaming"===opts.mode)preferBinary=!1;else if("allow-wrong-content-type"===opts.mode)preferBinary=!capability.overrideMimeType;else{if(opts.mode&&"default"!==opts.mode&&"prefer-fast"!==opts.mode)throw new Error("Invalid value for opts.mode");preferBinary=!0}self._mode=decideMode(preferBinary),self.on("finish",function(){self._onFinish()})};inherits(ClientRequest,stream.Writable),ClientRequest.prototype.setHeader=function(name,value){var self=this,lowerName=name.toLowerCase();indexOf(unsafeHeaders,lowerName)===-1&&(self._headers[lowerName]={name:name,value:value})},ClientRequest.prototype.getHeader=function(name){var self=this;return self._headers[name.toLowerCase()].value},ClientRequest.prototype.removeHeader=function(name){var self=this;delete self._headers[name.toLowerCase()]},ClientRequest.prototype._onFinish=function(){var self=this;if(!self._destroyed){var body,opts=self._opts,headersObj=self._headers;if("POST"!==opts.method&&"PUT"!==opts.method||(body=capability.blobConstructor?new global.Blob(self._body.map(function(buffer){return buffer.toArrayBuffer()}),{type:(headersObj["content-type"]||{}).value||""}):Buffer.concat(self._body).toString()),"fetch"===self._mode){var headers=keys(headersObj).map(function(name){return[headersObj[name].name,headersObj[name].value]});global.fetch(self._opts.url,{method:self._opts.method,headers:headers,body:body,mode:"cors",credentials:opts.withCredentials?"include":"same-origin"}).then(function(response){self._fetchResponse=response,self._connect()}).then(void 0,function(reason){self.emit("error",reason)})}else{var xhr=self._xhr=new global.XMLHttpRequest;try{xhr.open(self._opts.method,self._opts.url,!0)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}"responseType"in xhr&&(xhr.responseType=self._mode.split(":")[0]),"withCredentials"in xhr&&(xhr.withCredentials=!!opts.withCredentials),"text"===self._mode&&"overrideMimeType"in xhr&&xhr.overrideMimeType("text/plain; charset=x-user-defined"),foreach(keys(headersObj),function(name){xhr.setRequestHeader(headersObj[name].name,headersObj[name].value)}),self._response=null,xhr.onreadystatechange=function(){switch(xhr.readyState){case rStates.LOADING:case rStates.DONE:self._onXHRProgress()}},"moz-chunked-arraybuffer"===self._mode&&(xhr.onprogress=function(){self._onXHRProgress()}),xhr.onerror=function(){self._destroyed||self.emit("error",new Error("XHR error"))};try{xhr.send(body)}catch(err){return void process.nextTick(function(){self.emit("error",err)})}}}},ClientRequest.prototype._onXHRProgress=function(){var self=this;statusValid(self._xhr)&&!self._destroyed&&(self._response||self._connect(),self._response._onXHRProgress())},ClientRequest.prototype._connect=function(){var self=this;self._destroyed||(self._response=new IncomingMessage(self._xhr,self._fetchResponse,self._mode),self.emit("response",self._response))},ClientRequest.prototype._write=function(chunk,encoding,cb){var self=this;self._body.push(chunk),cb()},ClientRequest.prototype.abort=ClientRequest.prototype.destroy=function(){var self=this;self._destroyed=!0,self._response&&(self._response._destroyed=!0),self._xhr&&self._xhr.abort()},ClientRequest.prototype.end=function(data,encoding,cb){var self=this;"function"==typeof data&&(cb=data,data=void 0),stream.Writable.prototype.end.call(self,data,encoding,cb)},ClientRequest.prototype.flushHeaders=function(){},ClientRequest.prototype.setTimeout=function(){},ClientRequest.prototype.setNoDelay=function(){},ClientRequest.prototype.setSocketKeepAlive=function(){};var unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"]}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":12,"./response":14,_process:27,buffer:6,foreach:10,indexof:18,inherits:20,"object-keys":24,stream:65}],14:[function(require,module,exports){(function(process,global,Buffer){var capability=require("./capability"),foreach=require("foreach"),inherits=require("inherits"),stream=require("stream"),rStates=exports.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},IncomingMessage=exports.IncomingMessage=function(xhr,response,mode){function read(){reader.read().then(function(result){if(!self._destroyed){if(result.done)return void self.push(null);self.push(new Buffer(result.value)),read()}})}var self=this;if(stream.Readable.call(self),self._mode=mode,self.headers={},self.rawHeaders=[],self.trailers={},self.rawTrailers=[],self.on("end",function(){process.nextTick(function(){self.emit("close")})}),"fetch"===mode){self._fetchResponse=response,self.statusCode=response.status,self.statusMessage=response.statusText;for(var header,_i,_it=response.headers[Symbol.iterator]();header=(_i=_it.next()).value,!_i.done;)self.headers[header[0].toLowerCase()]=header[1],self.rawHeaders.push(header[0],header[1]);var reader=response.body.getReader();read()}else{self._xhr=xhr,self._pos=0,self.statusCode=xhr.status,self.statusMessage=xhr.statusText;var headers=xhr.getAllResponseHeaders().split(/\r?\n/);if(foreach(headers,function(header){var matches=header.match(/^([^:]+):\s*(.*)/);if(matches){var key=matches[1].toLowerCase();void 0!==self.headers[key]?self.headers[key]+=", "+matches[2]:self.headers[key]=matches[2],self.rawHeaders.push(matches[1],matches[2])}}),self._charset="x-user-defined",!capability.overrideMimeType){var mimeType=self.rawHeaders["mime-type"];if(mimeType){var charsetMatch=mimeType.match(/;\s*charset=([^;])(;|$)/);charsetMatch&&(self._charset=charsetMatch[1].toLowerCase())}self._charset||(self._charset="utf-8")}}};inherits(IncomingMessage,stream.Readable),IncomingMessage.prototype._read=function(){},IncomingMessage.prototype._onXHRProgress=function(){var self=this,xhr=self._xhr,response=null;switch(self._mode){case"text:vbarray":if(xhr.readyState!==rStates.DONE)break;try{response=new global.VBArray(xhr.responseBody).toArray()}catch(e){}if(null!==response){self.push(new Buffer(response));break}case"text":try{response=xhr.responseText}catch(e){self._mode="text:vbarray";break}if(response.length>self._pos){var newData=response.substr(self._pos);if("x-user-defined"===self._charset){for(var buffer=new Buffer(newData.length),i=0;i<newData.length;i++)buffer[i]=255&newData.charCodeAt(i);self.push(buffer)}else self.push(newData,self._charset);self._pos=response.length}break;case"arraybuffer":if(xhr.readyState!==rStates.DONE)break;response=xhr.response,self.push(new Buffer(new Uint8Array(response)));break;case"moz-chunked-arraybuffer":if(response=xhr.response,xhr.readyState!==rStates.LOADING||!response)break;self.push(new Buffer(new Uint8Array(response)));break;case"ms-stream":if(response=xhr.response,xhr.readyState!==rStates.LOADING)break;var reader=new global.MSStreamReader;reader.onprogress=function(){reader.result.byteLength>self._pos&&(self.push(new Buffer(new Uint8Array(reader.result.slice(self._pos)))),self._pos=reader.result.byteLength)},reader.onload=function(){self.push(null)},reader.readAsArrayBuffer(response)}self._xhr.readyState===rStates.DONE&&"ms-stream"!==self._mode&&self.push(null)}}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},require("buffer").Buffer)},{"./capability":12,_process:27,buffer:6,foreach:10,inherits:20,stream:65}],15:[function(require,module,exports){function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}function isString(arg){return"string"==typeof arg}function isObject(arg){return"object"==typeof arg&&null!==arg}function isNull(arg){return null===arg}function isNullOrUndefined(arg){return null==arg}var punycode=require("punycode");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,delims=["<",">",'"',"`"," ","\r","\n","\t"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var rest=url;rest=rest.trim();var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);hec!==-1&&(hostEnd===-1||hec<hostEnd)&&(hostEnd=hec)}var auth,atSign;atSign=hostEnd===-1?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd),atSign!==-1&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);hec!==-1&&(hostEnd===-1||hec<hostEnd)&&(hostEnd=hec)}hostEnd===-1&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;i<l;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;j<k;j++)newpart+=part.charCodeAt(j)>127?"x":part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}if(this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),!ipv6Hostname){for(var domainArray=this.hostname.split("."),newOut=[],i=0;i<domainArray.length;++i){var s=domainArray[i];newOut.push(s.match(/[^A-Za-z0-9_-]/)?"xn--"+punycode.encode(s):s)}this.hostname=newOut.join(".")}var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;i<l;i++){var ae=autoEscape[i],esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}var hash=rest.indexOf("#");hash!==-1&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(qm!==-1?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=encodeURIComponent(auth),auth=auth.replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&host!==!1?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}),search=search.replace("#","%23"),protocol+host+pathname+search+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}var result=new Url;if(Object.keys(this).forEach(function(k){result[k]=this[k]},this),result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol)return Object.keys(relative).forEach(function(k){"protocol"!==k&&(result[k]=relative[k])}),slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result;if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol])return Object.keys(relative).forEach(function(k){result[k]=relative[k]}),result.href=result.format(),result;if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return result.search=relative.search,result.query=relative.query,isNull(result.pathname)&&isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)last=srcPath[i],"."==last?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=!!(result.host&&result.host.indexOf("@")>0)&&result.host.split("@");authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return mustEndAbs=mustEndAbs||result.host&&srcPath.length,mustEndAbs&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),isNull(result.pathname)&&isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(port=port[0],":"!==port&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{punycode:28,querystring:32}],16:[function(require,module,exports){var http=require("http"),https=module.exports;for(var key in http)http.hasOwnProperty(key)&&(https[key]=http[key]);https.request=function(params,cb){return params||(params={}),params.scheme="https",params.protocol="https:",http.request.call(this,params,cb)}},{http:11}],17:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){
var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=value<0||0===value&&1/value<0?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],18:[function(require,module,exports){var indexOf=[].indexOf;module.exports=function(arr,obj){if(indexOf)return arr.indexOf(obj);for(var i=0;i<arr.length;++i)if(arr[i]===obj)return i;return-1}},{}],19:[function(require,module,exports){!function(root,factory){"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?module.exports=factory():root.inflection=factory()}(this,function(){var uncountable_words=["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],plural_rules=[[new RegExp("(m)en$","gi")],[new RegExp("(pe)ople$","gi")],[new RegExp("(child)ren$","gi")],[new RegExp("([ti])a$","gi")],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi")],[new RegExp("(hive)s$","gi")],[new RegExp("(tive)s$","gi")],[new RegExp("(curve)s$","gi")],[new RegExp("([lr])ves$","gi")],[new RegExp("([^fo])ves$","gi")],[new RegExp("([^aeiouy]|qu)ies$","gi")],[new RegExp("(s)eries$","gi")],[new RegExp("(m)ovies$","gi")],[new RegExp("(x|ch|ss|sh)es$","gi")],[new RegExp("([m|l])ice$","gi")],[new RegExp("(bus)es$","gi")],[new RegExp("(o)es$","gi")],[new RegExp("(shoe)s$","gi")],[new RegExp("(cris|ax|test)es$","gi")],[new RegExp("(octop|vir)i$","gi")],[new RegExp("(alias|status)es$","gi")],[new RegExp("^(ox)en","gi")],[new RegExp("(vert|ind)ices$","gi")],[new RegExp("(matr)ices$","gi")],[new RegExp("(quiz)zes$","gi")],[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],singular_rules=[[new RegExp("(m)an$","gi")],[new RegExp("(pe)rson$","gi")],[new RegExp("(child)$","gi")],[new RegExp("^(ox)$","gi")],[new RegExp("(ax|test)is$","gi")],[new RegExp("(octop|vir)us$","gi")],[new RegExp("(alias|status)$","gi")],[new RegExp("(bu)s$","gi")],[new RegExp("(buffal|tomat|potat)o$","gi")],[new RegExp("([ti])um$","gi")],[new RegExp("sis$","gi")],[new RegExp("(?:([^f])fe|([lr])f)$","gi")],[new RegExp("(hive)$","gi")],[new RegExp("([^aeiouy]|qu)y$","gi")],[new RegExp("(x|ch|ss|sh)$","gi")],[new RegExp("(matr|vert|ind)ix|ex$","gi")],[new RegExp("([m|l])ouse$","gi")],[new RegExp("(quiz)$","gi")],[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("ss$","gi"),"ss"],[new RegExp("s$","gi"),""]],non_titlecased_words=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],id_suffix=new RegExp("(_ids|_id)$","g"),underbar=new RegExp("_","g"),space_or_underbar=new RegExp("[ _]","g"),uppercase=new RegExp("([A-Z])","g"),underbar_prefix=new RegExp("^_"),inflector={_apply_rules:function(str,rules,skip,override){if(override)str=override;else{var ignore=inflector.indexOf(skip,str.toLowerCase())>-1;if(!ignore)for(var i=0,j=rules.length;i<j;i++)if(str.match(rules[i][0])){void 0!==rules[i][1]&&(str=str.replace(rules[i][0],rules[i][1]));break}}return str},indexOf:function(arr,item,from_index,compare_func){from_index||(from_index=-1);for(var index=-1,i=from_index,j=arr.length;i<j;i++)if(arr[i]===item||compare_func&&compare_func(arr[i],item)){index=i;break}return index},pluralize:function(str,plural){return inflector._apply_rules(str,plural_rules,uncountable_words,plural)},singularize:function(str,singular){return inflector._apply_rules(str,singular_rules,uncountable_words,singular)},camelize:function(str,low_first_letter){for(var str_arr,k,l,first,str_path=str.split("/"),i=0,j=str_path.length;i<j;i++){for(str_arr=str_path[i].split("_"),k=0,l=str_arr.length;k<l;k++)0!==k&&(str_arr[k]=str_arr[k].toLowerCase()),first=str_arr[k].charAt(0),first=low_first_letter&&0===i&&0===k?first.toLowerCase():first.toUpperCase(),str_arr[k]=first+str_arr[k].substring(1);str_path[i]=str_arr.join("")}return str_path.join("::")},underscore:function(str,all_upper_case){if(all_upper_case&&str===str.toUpperCase())return str;for(var str_path=str.split("::"),i=0,j=str_path.length;i<j;i++)str_path[i]=str_path[i].replace(uppercase,"_$1"),str_path[i]=str_path[i].replace(underbar_prefix,"");return str_path.join("/").toLowerCase()},humanize:function(str,low_first_letter){return str=str.toLowerCase(),str=str.replace(id_suffix,""),str=str.replace(underbar," "),low_first_letter||(str=inflector.capitalize(str)),str},capitalize:function(str){return str=str.toLowerCase(),str.substring(0,1).toUpperCase()+str.substring(1)},dasherize:function(str){return str.replace(space_or_underbar,"-")},titleize:function(str){str=str.toLowerCase().replace(underbar," ");for(var d,k,l,str_arr=str.split(" "),i=0,j=str_arr.length;i<j;i++){for(d=str_arr[i].split("-"),k=0,l=d.length;k<l;k++)inflector.indexOf(non_titlecased_words,d[k].toLowerCase())<0&&(d[k]=inflector.capitalize(d[k]));str_arr[i]=d.join("-")}return str=str_arr.join(" "),str=str.substring(0,1).toUpperCase()+str.substring(1)},demodulize:function(str){var str_arr=str.split("::");return str_arr[str_arr.length-1]},tableize:function(str){return str=inflector.underscore(str),str=inflector.pluralize(str)},classify:function(str){return str=inflector.camelize(str),str=inflector.singularize(str)},foreign_key:function(str,drop_id_ubar){return str=inflector.demodulize(str),str=inflector.underscore(str)+(drop_id_ubar?"":"_")+"id"},ordinalize:function(str){for(var str_arr=str.split(" "),i=0,j=str_arr.length;i<j;i++){var k=parseInt(str_arr[i],10);if(!isNaN(k)){var ltd=str_arr[i].substring(str_arr[i].length-2),ld=str_arr[i].substring(str_arr[i].length-1),suf="th";"11"!=ltd&&"12"!=ltd&&"13"!=ltd&&("1"===ld?suf="st":"2"===ld?suf="nd":"3"===ld&&(suf="rd")),str_arr[i]+=suf}}return str_arr.join(" ")},transform:function(str,arr){for(var i=0,j=arr.length;i<j;i++){var method=arr[i];this.hasOwnProperty(method)&&(str=this[method](str))}return str}};return inflector.version="1.3.8",inflector})},{}],20:[function(require,module,exports){"function"==typeof Object.create?module.exports=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})}:module.exports=function(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}},{}],21:[function(require,module,exports){function isBuffer(obj){return!!obj.constructor&&"function"==typeof obj.constructor.isBuffer&&obj.constructor.isBuffer(obj)}function isSlowBuffer(obj){return"function"==typeof obj.readFloatLE&&"function"==typeof obj.slice&&isBuffer(obj.slice(0,0))}module.exports=function(obj){return null!=obj&&(isBuffer(obj)||isSlowBuffer(obj)||!!obj._isBuffer)}},{}],22:[function(require,module,exports){arguments[4][7][0].apply(exports,arguments)},{dup:7}],23:[function(require,module,exports){!function(glob,undefined){function JSONLint(json,options){var self=this;if(!(self instanceof JSONLint))return new JSONLint(json,options);self.json=json||"",self.options=options||{},self.lower=self.json.toLowerCase(),self.options.hasOwnProperty("comments")||(self.options.comments=!0),self.c="",self.i=-1,self.length=self.json.length,self.line=1,self.character=0,self._evidence=self.json.split(revidence),self.endblock="",self.commabreak=!1;try{self.render()}catch(e){if("string"!=typeof e)throw e;self.error=e,self.setEvidence()}}var rnumber=/[0-9]/,rnewline=/(\r\n|\r|\n)/,revidence=/\r\n|\r|\n/,rwhitespace=/(\s|\t)/,rvalidsolidus=/\\("|\\|\/|b|f|n|r|t|u[0-9]{4})/,rE=/^(\-|\+)?[0-9]/;JSONLint.contact="Corey Hart (corey@codenothing.com)",JSONLint.version="[VERSION]",JSONLint.date="[DATE]",JSONLint.prototype={render:function(){for(var self=this,peek="",content=!1;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,self.options.comments&&"/"==self.c)if(peek=self.json[self.i+1],"*"==peek)self.multicomment();else{if("/"!=peek)throw"Unknown character '/', maybe a comment?";self.comment()}else if(rnewline.exec(self.c))self.line++,self.character=0;else{if(rwhitespace.exec(self.c))continue;if(content)throw"Unknown character '"+self.c+"', expecting end of file.";if("["==self.c)content=!0,self.array();else{if("{"!=self.c)throw"Unknown character '"+self.c+"', expecting opening block '{' or '[', or maybe a comment";content=!0,self.object()}}if(!content)throw"Invalid JSON, no content."},multicomment:function(){for(var self=this;++self.i<self.length;){if(self.c=self.json[self.i],self.character++,"*"==self.c&&"/"==self.json[self.i+1]){self.i++,self.character++;break}rnewline.exec(self.c)&&(self.line++,self.character=0)}},comment:function(){for(var self=this;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,rnewline.exec(self.c)){self.line++,self.character=0;break}},array:function(){var self=this,_endblock=self.endblock,_commabreak=self.commabreak,ended=!1;for(self.endblock="]",self.commabreak=!1;(ended=self.value())!==!0&&self.i<self.length;);if(!ended)throw"EOF Error. Expecting closing ']'";self.endblock=_endblock,self.commabreak=_commabreak},object:function(){var self=this,_endblock=self.endblock,_commabreak=self.commabreak,found=!1,peek="",empty=!0;for(self.endblock="}",self.commabreak=!1;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,self.options.comments&&"/"==self.c)if(peek=self.json[self.i+1],"*"==peek)self.multicomment();else{if("/"!=peek)throw"Unknown character '/', maybe a comment?";self.comment()}else if(rnewline.exec(self.c))self.line++,self.character=0;else{if(rwhitespace.exec(self.c))continue;if('"'!=self.c){if(empty&&"}"==self.c){self.endblock=_endblock,self.commabreak=_commabreak,found=!0;break}throw"Unknown Character '"+self.c+"', expecting a string for key statement."}if(empty=!1,self.key()===!0){self.endblock=_endblock,self.commabreak=_commabreak,found=!0;break}}if(!found)throw"EOF Error, expecting closing '}'."},key:function(){var self=this;self.string();for(var peek="";++self.i<self.length;)if(self.c=self.json[self.i],self.character++,self.options.comments&&"/"==self.c)if(peek=self.json[self.i+1],"*"==peek)self.multicomment();else{if("/"!=peek)throw"Unknown character '/', maybe a comment?";self.comment()}else{if(!rnewline.exec(self.c)){if(rwhitespace.exec(self.c))continue;if(":"==self.c)return self.value();throw"Unknown Character '"+self.c+"', expecting a semicolon."}self.line++,self.character=0}},value:function(){for(var self=this,peek="";++self.i<self.length;)if(self.c=self.json[self.i],self.character++,self.options.comments&&"/"==self.c)if(peek=self.json[self.i+1],"*"==peek)self.multicomment();else{if("/"!=peek)throw"Unknown character '/', maybe a comment?";self.comment()}else{if(!rnewline.exec(self.c)){if(rwhitespace.exec(self.c))continue;if("{"==self.c)return self.object(),self.endval();if("["==self.c)return self.array(),self.endval();if('"'==self.c)return self.string(),self.endval();if(self.json.indexOf("true",self.i)===self.i)return self.i+=3,self.character+=3,self.endval();if(self.json.indexOf("false",self.i)===self.i)return self.i+=4,self.character+=4,self.endval();if(self.json.indexOf("null",self.i)===self.i)return self.i+=3,self.character+=3,self.endval();if("-"==self.c||rnumber.exec(self.c))return self.numeric();if("]"==self.c&&"]"==self.endblock){if(self.commabreak)throw"Unexpected End Of Array Error. Expecting a value statement.";return!0}throw"Unknown Character '"+self.c+"', expecting a value."}self.line++,self.character=0}},string:function(){for(var m,self=this,found=!1;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,"\\"==self.c){if(!(m=rvalidsolidus.exec(self.json.substr(self.i)))||0!==m.index)throw"Invalid Reverse Solidus '\\' declaration.";self.i+=m[1].length,self.character+=m[1].length}else if(rnewline.exec(self.c))self.line++,self.character=0;else if('"'==self.c){found=!0;break}if(!found)throw"EOF: No close string '\"' found."},numeric:function(){var self=this,negative=!0,decimal=null,e=null;for(self.i--,self.character--;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,negative&&(negative=!1,"-"==self.c)){if(!rnumber.exec(self.json[self.i+1]))throw"Unknown Character '"+self.c+"' following a negative, expecting a numeric value."}else if(decimal&&"."==self.c)decimal=!1,e=!0;else if(e&&"e"==self.c.toLowerCase()){if(e=!1,negative=!0,!rE.exec(self.json.substr(self.i+1,2)))throw self.character++,"Unknown Character '"+self.json[self.i+1]+"' following e notation, expecting a numeric value.";self.character++,self.i++}else{if(!rnumber.exec(self.c))return self.i--,self.character--,self.endval();null===decimal&&(decimal=!0)}},endval:function(){var self=this,peek="";for(self.commabreak=!1;++self.i<self.length;)if(self.c=self.json[self.i],self.character++,self.options.comments&&"/"==self.c)if(peek=self.json[self.i+1],"*"==peek)self.multicomment();else{if("/"!=peek)throw"Unknown character '/', maybe a comment?";self.comment()}else{if(!rnewline.exec(self.c)){if(rwhitespace.exec(self.c))continue;if(","==self.c){self.commabreak=!0;break}if(self.c==self.endblock)return!0;throw"Unknown Character '"+self.c+"', expecting a comma or a closing '"+self.endblock+"'"}self.line++,self.character=0}},setEvidence:function(){var self=this,start=self.line-5,end=start+8,evidence="";for(start<0&&(start=0,end=8),end>=self._evidence.length&&(end=self._evidence.length);start<end;start++)evidence+=(start===self.line-1?"-> ":"   ")+(start+1)+"| "+self._evidence[start]+"\n";self.evidence=evidence}},"object"==typeof exports&&"object"==typeof module?module.exports=JSONLint:glob.JSONLint=JSONLint}(this)},{}],24:[function(require,module,exports){"use strict";var has=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,slice=Array.prototype.slice,isArgs=require("./isArguments"),isEnumerable=Object.prototype.propertyIsEnumerable,hasDontEnumBug=!isEnumerable.call({toString:null},"toString"),hasProtoEnumBug=isEnumerable.call(function(){},"prototype"),dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],equalsConstructorPrototype=function(o){var ctor=o.constructor;return ctor&&ctor.prototype===o},excludedKeys={$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},hasAutomationEqualityBug=function(){if("undefined"==typeof window)return!1;for(var k in window)try{if(!excludedKeys["$"+k]&&has.call(window,k)&&null!==window[k]&&"object"==typeof window[k])try{equalsConstructorPrototype(window[k])}catch(e){return!0}}catch(e){return!0}return!1}(),equalsConstructorPrototypeIfNotBuggy=function(o){if("undefined"==typeof window||!hasAutomationEqualityBug)return equalsConstructorPrototype(o);try{return equalsConstructorPrototype(o)}catch(e){return!1}},keysShim=function(object){var isObject=null!==object&&"object"==typeof object,isFunction="[object Function]"===toStr.call(object),isArguments=isArgs(object),isString=isObject&&"[object String]"===toStr.call(object),theKeys=[];if(!isObject&&!isFunction&&!isArguments)throw new TypeError("Object.keys called on a non-object");var skipProto=hasProtoEnumBug&&isFunction;if(isString&&object.length>0&&!has.call(object,0))for(var i=0;i<object.length;++i)theKeys.push(String(i));if(isArguments&&object.length>0)for(var j=0;j<object.length;++j)theKeys.push(String(j));else for(var name in object)skipProto&&"prototype"===name||!has.call(object,name)||theKeys.push(String(name));if(hasDontEnumBug)for(var skipConstructor=equalsConstructorPrototypeIfNotBuggy(object),k=0;k<dontEnums.length;++k)skipConstructor&&"constructor"===dontEnums[k]||!has.call(object,dontEnums[k])||theKeys.push(dontEnums[k]);return theKeys};keysShim.shim=function(){if(Object.keys){var keysWorksWithArguments=function(){return 2===(Object.keys(arguments)||"").length}(1,2);if(!keysWorksWithArguments){var originalKeys=Object.keys;Object.keys=function(object){return originalKeys(isArgs(object)?slice.call(object):object)}}}else Object.keys=keysShim;return Object.keys||keysShim},module.exports=keysShim},{"./isArguments":25}],25:[function(require,module,exports){"use strict";var toStr=Object.prototype.toString;module.exports=function(value){var str=toStr.call(value),isArgs="[object Arguments]"===str;return isArgs||(isArgs="[object Array]"!==str&&null!==value&&"object"==typeof value&&"number"==typeof value.length&&value.length>=0&&"[object Function]"===toStr.call(value.callee)),isArgs}},{}],26:[function(require,module,exports){(function(process){"use strict";function nextTick(fn,arg1,arg2,arg3){if("function"!=typeof fn)throw new TypeError('"callback" argument must be a function');var args,i,len=arguments.length;switch(len){case 0:case 1:return process.nextTick(fn);case 2:return process.nextTick(function(){fn.call(null,arg1)});case 3:return process.nextTick(function(){fn.call(null,arg1,arg2)});case 4:return process.nextTick(function(){fn.call(null,arg1,arg2,arg3)});default:for(args=new Array(len-1),i=0;i<args.length;)args[i++]=arguments[i];return process.nextTick(function(){fn.apply(null,args)})}}!process.version||0===process.version.indexOf("v0.")||0===process.version.indexOf("v1.")&&0!==process.version.indexOf("v1.8.")?module.exports=nextTick:module.exports=process.nextTick}).call(this,require("_process"))},{_process:27}],27:[function(require,module,exports){function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,runClearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var cachedSetTimeout,cachedClearTimeout,process=module.exports={};!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],28:[function(require,module,exports){(function(global){!function(root){function error(type){throw new RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";parts.length>1&&(result=parts[0]+"@",string=parts[1]),string=string.replace(regexSeparators,".");var labels=string.split("."),encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;counter<length;)value=string.charCodeAt(counter++),value>=55296&&value<=56319&&counter<length?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function basicToDigit(codePoint){return codePoint-48<10?codePoint-22:codePoint-65<26?codePoint-65:codePoint-97<26?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(digit<26)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for(basic=input.lastIndexOf(delimiter),basic<0&&(basic=0),j=0;j<basic;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;index<inputLength;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),digit=basicToDigit(input.charCodeAt(index++)),(digit>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(digit<t);k+=base)baseMinusT=base-t,w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT;out=output.length+1,bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(input=ucs2decode(input),inputLength=input.length,n=initialN,delta=0,bias=initialBias,j=0;j<inputLength;++j)currentValue=input[j],currentValue<128&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);handledCPCount<inputLength;){for(m=maxInt,j=0;j<inputLength;++j)currentValue=input[j],currentValue>=n&&currentValue<m&&(m=currentValue);for(handledCPCountPlusOne=handledCPCount+1,m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;j<inputLength;++j)if(currentValue=input[j],currentValue<n&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;t=k<=bias?tMin:k>=bias+tMax?tMax:k-bias,!(q<t);k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;freeGlobal.global!==freeGlobal&&freeGlobal.window!==freeGlobal&&freeGlobal.self!==freeGlobal||(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;if(punycode={version:"1.4.1",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(require,module,exports){(function(process){!function(definition){if("function"==typeof bootstrap)bootstrap("promise",definition);else if("object"==typeof exports)module.exports=definition();else if("function"==typeof define&&define.amd)define(definition);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=definition}else Q=definition()}(function(){"use strict";function uncurryThis(f){return function(){return call.apply(f,arguments)}}function isObject(value){return value===Object(value)}function isStopIteration(exception){return"[object StopIteration]"===object_toString(exception)||exception instanceof QReturnValue}function makeStackTraceLong(error,promise){if(hasStacks&&promise.stack&&"object"==typeof error&&null!==error&&error.stack&&error.stack.indexOf(STACK_JUMP_SEPARATOR)===-1){for(var stacks=[],p=promise;p;p=p.source)p.stack&&stacks.unshift(p.stack);stacks.unshift(error.stack);var concatedStacks=stacks.join("\n"+STACK_JUMP_SEPARATOR+"\n");error.stack=filterStackString(concatedStacks)}}function filterStackString(stackString){for(var lines=stackString.split("\n"),desiredLines=[],i=0;i<lines.length;++i){var line=lines[i];isInternalFrame(line)||isNodeFrame(line)||!line||desiredLines.push(line)}return desiredLines.join("\n")}function isNodeFrame(stackLine){return stackLine.indexOf("(module.js:")!==-1||stackLine.indexOf("(node.js:")!==-1}function getFileNameAndLineNumber(stackLine){var attempt1=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(stackLine);if(attempt1)return[attempt1[1],Number(attempt1[2])];var attempt2=/at ([^ ]+):(\d+):(?:\d+)$/.exec(stackLine);if(attempt2)return[attempt2[1],Number(attempt2[2])];var attempt3=/.*@(.+):(\d+)$/.exec(stackLine);return attempt3?[attempt3[1],Number(attempt3[2])]:void 0}function isInternalFrame(stackLine){var fileNameAndLineNumber=getFileNameAndLineNumber(stackLine);if(!fileNameAndLineNumber)return!1;var fileName=fileNameAndLineNumber[0],lineNumber=fileNameAndLineNumber[1];return fileName===qFileName&&lineNumber>=qStartingLine&&lineNumber<=qEndingLine}function captureLine(){if(hasStacks)try{throw new Error}catch(e){var lines=e.stack.split("\n"),firstLine=lines[0].indexOf("@")>0?lines[1]:lines[2],fileNameAndLineNumber=getFileNameAndLineNumber(firstLine);if(!fileNameAndLineNumber)return;return qFileName=fileNameAndLineNumber[0],fileNameAndLineNumber[1]}}function deprecate(callback,name,alternative){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(name+" is deprecated, use "+alternative+" instead.",new Error("").stack),callback.apply(callback,arguments)}}function Q(value){return isPromise(value)?value:isPromiseAlike(value)?coerce(value):fulfill(value)}function defer(){function become(newPromise){resolvedPromise=newPromise,promise.source=newPromise,array_reduce(messages,function(undefined,message){nextTick(function(){newPromise.promiseDispatch.apply(newPromise,message)})},void 0),messages=void 0,progressListeners=void 0}var resolvedPromise,messages=[],progressListeners=[],deferred=object_create(defer.prototype),promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,operands){var args=array_slice(arguments);messages?(messages.push(args),"when"===op&&operands[1]&&progressListeners.push(operands[1])):nextTick(function(){resolvedPromise.promiseDispatch.apply(resolvedPromise,args)})},promise.valueOf=deprecate(function(){if(messages)return promise;var nearerValue=nearer(resolvedPromise);return isPromise(nearerValue)&&(resolvedPromise=nearerValue),nearerValue},"valueOf","inspect"),promise.inspect=function(){return resolvedPromise?resolvedPromise.inspect():{state:"pending"}},Q.longStackSupport&&hasStacks)try{throw new Error}catch(e){promise.stack=e.stack.substring(e.stack.indexOf("\n")+1)}return deferred.promise=promise,deferred.resolve=function(value){resolvedPromise||become(Q(value))},deferred.fulfill=function(value){resolvedPromise||become(fulfill(value))},deferred.reject=function(reason){resolvedPromise||become(reject(reason));
},deferred.notify=function(progress){resolvedPromise||array_reduce(progressListeners,function(undefined,progressListener){nextTick(function(){progressListener(progress)})},void 0)},deferred}function promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function.");var deferred=defer();try{resolver(deferred.resolve,deferred.reject,deferred.notify)}catch(reason){deferred.reject(reason)}return deferred.promise}function race(answerPs){return promise(function(resolve,reject){for(var i=0,len=answerPs.length;i<len;i++)Q(answerPs[i]).then(resolve,reject)})}function Promise(descriptor,fallback,inspect){void 0===fallback&&(fallback=function(op){return reject(new Error("Promise does not support operation: "+op))}),void 0===inspect&&(inspect=function(){return{state:"unknown"}});var promise=object_create(Promise.prototype);if(promise.promiseDispatch=function(resolve,op,args){var result;try{result=descriptor[op]?descriptor[op].apply(promise,args):fallback.call(promise,op,args)}catch(exception){result=reject(exception)}resolve&&resolve(result)},promise.inspect=inspect,inspect){var inspected=inspect();"rejected"===inspected.state&&(promise.exception=inspected.reason),promise.valueOf=deprecate(function(){var inspected=inspect();return"pending"===inspected.state||"rejected"===inspected.state?promise:inspected.value})}return promise}function when(value,fulfilled,rejected,progressed){return Q(value).then(fulfilled,rejected,progressed)}function nearer(value){if(isPromise(value)){var inspected=value.inspect();if("fulfilled"===inspected.state)return inspected.value}return value}function isPromise(object){return isObject(object)&&"function"==typeof object.promiseDispatch&&"function"==typeof object.inspect}function isPromiseAlike(object){return isObject(object)&&"function"==typeof object.then}function isPending(object){return isPromise(object)&&"pending"===object.inspect().state}function isFulfilled(object){return!isPromise(object)||"fulfilled"===object.inspect().state}function isRejected(object){return isPromise(object)&&"rejected"===object.inspect().state}function displayUnhandledReasons(){unhandledReasonsDisplayed||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",unhandledReasons),unhandledReasonsDisplayed=!0}function logUnhandledReasons(){for(var i=0;i<unhandledReasons.length;i++){var reason=unhandledReasons[i];console.warn("Unhandled rejection reason:",reason)}}function resetUnhandledRejections(){unhandledReasons.length=0,unhandledRejections.length=0,unhandledReasonsDisplayed=!1,trackUnhandledRejections||(trackUnhandledRejections=!0,"undefined"!=typeof process&&process.on&&process.on("exit",logUnhandledReasons))}function trackRejection(promise,reason){trackUnhandledRejections&&(unhandledRejections.push(promise),reason&&"undefined"!=typeof reason.stack?unhandledReasons.push(reason.stack):unhandledReasons.push("(no stack) "+reason),displayUnhandledReasons())}function untrackRejection(promise){if(trackUnhandledRejections){var at=array_indexOf(unhandledRejections,promise);at!==-1&&(unhandledRejections.splice(at,1),unhandledReasons.splice(at,1))}}function reject(reason){var rejection=Promise({when:function(rejected){return rejected&&untrackRejection(this),rejected?rejected(reason):this}},function(){return this},function(){return{state:"rejected",reason:reason}});return trackRejection(rejection,reason),rejection}function fulfill(value){return Promise({when:function(){return value},get:function(name){return value[name]},set:function(name,rhs){value[name]=rhs},"delete":function(name){delete value[name]},post:function(name,args){return null===name||void 0===name?value.apply(void 0,args):value[name].apply(value,args)},apply:function(thisp,args){return value.apply(thisp,args)},keys:function(){return object_keys(value)}},void 0,function(){return{state:"fulfilled",value:value}})}function coerce(promise){var deferred=defer();return nextTick(function(){try{promise.then(deferred.resolve,deferred.reject,deferred.notify)}catch(exception){deferred.reject(exception)}}),deferred.promise}function master(object){return Promise({isDef:function(){}},function(op,args){return dispatch(object,op,args)},function(){return Q(object).inspect()})}function spread(value,fulfilled,rejected){return Q(value).spread(fulfilled,rejected)}function async(makeGenerator){return function(){function continuer(verb,arg){var result;if(hasES6Generators){try{result=generator[verb](arg)}catch(exception){return reject(exception)}return result.done?result.value:when(result.value,callback,errback)}try{result=generator[verb](arg)}catch(exception){return isStopIteration(exception)?exception.value:reject(exception)}return when(result,callback,errback)}var generator=makeGenerator.apply(this,arguments),callback=continuer.bind(continuer,"next"),errback=continuer.bind(continuer,"throw");return callback()}}function spawn(makeGenerator){Q.done(Q.async(makeGenerator)())}function _return(value){throw new QReturnValue(value)}function promised(callback){return function(){return spread([this,all(arguments)],function(self,args){return callback.apply(self,args)})}}function dispatch(object,op,args){return Q(object).dispatch(op,args)}function all(promises){return when(promises,function(promises){var countDown=0,deferred=defer();return array_reduce(promises,function(undefined,promise,index){var snapshot;isPromise(promise)&&"fulfilled"===(snapshot=promise.inspect()).state?promises[index]=snapshot.value:(++countDown,when(promise,function(value){promises[index]=value,0===--countDown&&deferred.resolve(promises)},deferred.reject,function(progress){deferred.notify({index:index,value:progress})}))},void 0),0===countDown&&deferred.resolve(promises),deferred.promise})}function allResolved(promises){return when(promises,function(promises){return promises=array_map(promises,Q),when(all(array_map(promises,function(promise){return when(promise,noop,noop)})),function(){return promises})})}function allSettled(promises){return Q(promises).allSettled()}function progress(object,progressed){return Q(object).then(void 0,void 0,progressed)}function nodeify(object,nodeback){return Q(object).nodeify(nodeback)}var hasStacks=!1;try{throw new Error}catch(e){hasStacks=!!e.stack}var qFileName,QReturnValue,qStartingLine=captureLine(),noop=function(){},nextTick=function(){function flush(){for(;head.next;){head=head.next;var task=head.task;head.task=void 0;var domain=head.domain;domain&&(head.domain=void 0,domain.enter());try{task()}catch(e){if(isNodeJS)throw domain&&domain.exit(),setTimeout(flush,0),domain&&domain.enter(),e;setTimeout(function(){throw e},0)}domain&&domain.exit()}flushing=!1}var head={task:void 0,next:null},tail=head,flushing=!1,requestTick=void 0,isNodeJS=!1;if(nextTick=function(task){tail=tail.next={task:task,domain:isNodeJS&&process.domain,next:null},flushing||(flushing=!0,requestTick())},"undefined"!=typeof process&&process.nextTick)isNodeJS=!0,requestTick=function(){process.nextTick(flush)};else if("function"==typeof setImmediate)requestTick="undefined"!=typeof window?setImmediate.bind(window,flush):function(){setImmediate(flush)};else if("undefined"!=typeof MessageChannel){var channel=new MessageChannel;channel.port1.onmessage=function(){requestTick=requestPortTick,channel.port1.onmessage=flush,flush()};var requestPortTick=function(){channel.port2.postMessage(0)};requestTick=function(){setTimeout(flush,0),requestPortTick()}}else requestTick=function(){setTimeout(flush,0)};return nextTick}(),call=Function.call,array_slice=uncurryThis(Array.prototype.slice),array_reduce=uncurryThis(Array.prototype.reduce||function(callback,basis){var index=0,length=this.length;if(1===arguments.length)for(;;){if(index in this){basis=this[index++];break}if(++index>=length)throw new TypeError}for(;index<length;index++)index in this&&(basis=callback(basis,this[index],index));return basis}),array_indexOf=uncurryThis(Array.prototype.indexOf||function(value){for(var i=0;i<this.length;i++)if(this[i]===value)return i;return-1}),array_map=uncurryThis(Array.prototype.map||function(callback,thisp){var self=this,collect=[];return array_reduce(self,function(undefined,value,index){collect.push(callback.call(thisp,value,index,self))},void 0),collect}),object_create=Object.create||function(prototype){function Type(){}return Type.prototype=prototype,new Type},object_hasOwnProperty=uncurryThis(Object.prototype.hasOwnProperty),object_keys=Object.keys||function(object){var keys=[];for(var key in object)object_hasOwnProperty(object,key)&&keys.push(key);return keys},object_toString=uncurryThis(Object.prototype.toString);QReturnValue="undefined"!=typeof ReturnValue?ReturnValue:function(value){this.value=value};var hasES6Generators;try{new Function("(function* (){ yield 1; })"),hasES6Generators=!0}catch(e){hasES6Generators=!1}var STACK_JUMP_SEPARATOR="From previous event:";Q.resolve=Q,Q.nextTick=nextTick,Q.longStackSupport=!1,Q.defer=defer,defer.prototype.makeNodeResolver=function(){var self=this;return function(error,value){error?self.reject(error):arguments.length>2?self.resolve(array_slice(arguments,1)):self.resolve(value)}},Q.promise=promise,Q.passByCopy=function(object){return object},Promise.prototype.passByCopy=function(){return this},Q.join=function(x,y){return Q(x).join(y)},Promise.prototype.join=function(that){return Q([this,that]).spread(function(x,y){if(x===y)return x;throw new Error("Can't join: not the same: "+x+" "+y)})},Q.race=race,Promise.prototype.race=function(){return this.then(Q.race)},Q.makePromise=Promise,Promise.prototype.toString=function(){return"[object Promise]"},Promise.prototype.then=function(fulfilled,rejected,progressed){function _fulfilled(value){try{return"function"==typeof fulfilled?fulfilled(value):value}catch(exception){return reject(exception)}}function _rejected(exception){if("function"==typeof rejected){makeStackTraceLong(exception,self);try{return rejected(exception)}catch(newException){return reject(newException)}}return reject(exception)}function _progressed(value){return"function"==typeof progressed?progressed(value):value}var self=this,deferred=defer(),done=!1;return nextTick(function(){self.promiseDispatch(function(value){done||(done=!0,deferred.resolve(_fulfilled(value)))},"when",[function(exception){done||(done=!0,deferred.resolve(_rejected(exception)))}])}),self.promiseDispatch(void 0,"when",[void 0,function(value){var newValue,threw=!1;try{newValue=_progressed(value)}catch(e){if(threw=!0,!Q.onerror)throw e;Q.onerror(e)}threw||deferred.notify(newValue)}]),deferred.promise},Q.when=when,Promise.prototype.thenResolve=function(value){return this.then(function(){return value})},Q.thenResolve=function(promise,value){return Q(promise).thenResolve(value)},Promise.prototype.thenReject=function(reason){return this.then(function(){throw reason})},Q.thenReject=function(promise,reason){return Q(promise).thenReject(reason)},Q.nearer=nearer,Q.isPromise=isPromise,Q.isPromiseAlike=isPromiseAlike,Q.isPending=isPending,Promise.prototype.isPending=function(){return"pending"===this.inspect().state},Q.isFulfilled=isFulfilled,Promise.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},Q.isRejected=isRejected,Promise.prototype.isRejected=function(){return"rejected"===this.inspect().state};var unhandledReasons=[],unhandledRejections=[],unhandledReasonsDisplayed=!1,trackUnhandledRejections=!0;Q.resetUnhandledRejections=resetUnhandledRejections,Q.getUnhandledReasons=function(){return unhandledReasons.slice()},Q.stopUnhandledRejectionTracking=function(){resetUnhandledRejections(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",logUnhandledReasons),trackUnhandledRejections=!1},resetUnhandledRejections(),Q.reject=reject,Q.fulfill=fulfill,Q.master=master,Q.spread=spread,Promise.prototype.spread=function(fulfilled,rejected){return this.all().then(function(array){return fulfilled.apply(void 0,array)},rejected)},Q.async=async,Q.spawn=spawn,Q["return"]=_return,Q.promised=promised,Q.dispatch=dispatch,Promise.prototype.dispatch=function(op,args){var self=this,deferred=defer();return nextTick(function(){self.promiseDispatch(deferred.resolve,op,args)}),deferred.promise},Q.get=function(object,key){return Q(object).dispatch("get",[key])},Promise.prototype.get=function(key){return this.dispatch("get",[key])},Q.set=function(object,key,value){return Q(object).dispatch("set",[key,value])},Promise.prototype.set=function(key,value){return this.dispatch("set",[key,value])},Q.del=Q["delete"]=function(object,key){return Q(object).dispatch("delete",[key])},Promise.prototype.del=Promise.prototype["delete"]=function(key){return this.dispatch("delete",[key])},Q.mapply=Q.post=function(object,name,args){return Q(object).dispatch("post",[name,args])},Promise.prototype.mapply=Promise.prototype.post=function(name,args){return this.dispatch("post",[name,args])},Q.send=Q.mcall=Q.invoke=function(object,name){return Q(object).dispatch("post",[name,array_slice(arguments,2)])},Promise.prototype.send=Promise.prototype.mcall=Promise.prototype.invoke=function(name){return this.dispatch("post",[name,array_slice(arguments,1)])},Q.fapply=function(object,args){return Q(object).dispatch("apply",[void 0,args])},Promise.prototype.fapply=function(args){return this.dispatch("apply",[void 0,args])},Q["try"]=Q.fcall=function(object){return Q(object).dispatch("apply",[void 0,array_slice(arguments,1)])},Promise.prototype.fcall=function(){return this.dispatch("apply",[void 0,array_slice(arguments)])},Q.fbind=function(object){var promise=Q(object),args=array_slice(arguments,1);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Promise.prototype.fbind=function(){var promise=this,args=array_slice(arguments);return function(){return promise.dispatch("apply",[this,args.concat(array_slice(arguments))])}},Q.keys=function(object){return Q(object).dispatch("keys",[])},Promise.prototype.keys=function(){return this.dispatch("keys",[])},Q.all=all,Promise.prototype.all=function(){return all(this)},Q.allResolved=deprecate(allResolved,"allResolved","allSettled"),Promise.prototype.allResolved=function(){return allResolved(this)},Q.allSettled=allSettled,Promise.prototype.allSettled=function(){return this.then(function(promises){return all(array_map(promises,function(promise){function regardless(){return promise.inspect()}return promise=Q(promise),promise.then(regardless,regardless)}))})},Q.fail=Q["catch"]=function(object,rejected){return Q(object).then(void 0,rejected)},Promise.prototype.fail=Promise.prototype["catch"]=function(rejected){return this.then(void 0,rejected)},Q.progress=progress,Promise.prototype.progress=function(progressed){return this.then(void 0,void 0,progressed)},Q.fin=Q["finally"]=function(object,callback){return Q(object)["finally"](callback)},Promise.prototype.fin=Promise.prototype["finally"]=function(callback){return callback=Q(callback),this.then(function(value){return callback.fcall().then(function(){return value})},function(reason){return callback.fcall().then(function(){throw reason})})},Q.done=function(object,fulfilled,rejected,progress){return Q(object).done(fulfilled,rejected,progress)},Promise.prototype.done=function(fulfilled,rejected,progress){var onUnhandledError=function(error){nextTick(function(){if(makeStackTraceLong(error,promise),!Q.onerror)throw error;Q.onerror(error)})},promise=fulfilled||rejected||progress?this.then(fulfilled,rejected,progress):this;"object"==typeof process&&process&&process.domain&&(onUnhandledError=process.domain.bind(onUnhandledError)),promise.then(void 0,onUnhandledError)},Q.timeout=function(object,ms,message){return Q(object).timeout(ms,message)},Promise.prototype.timeout=function(ms,message){var deferred=defer(),timeoutId=setTimeout(function(){deferred.reject(new Error(message||"Timed out after "+ms+" ms"))},ms);return this.then(function(value){clearTimeout(timeoutId),deferred.resolve(value)},function(exception){clearTimeout(timeoutId),deferred.reject(exception)},deferred.notify),deferred.promise},Q.delay=function(object,timeout){return void 0===timeout&&(timeout=object,object=void 0),Q(object).delay(timeout)},Promise.prototype.delay=function(timeout){return this.then(function(value){var deferred=defer();return setTimeout(function(){deferred.resolve(value)},timeout),deferred.promise})},Q.nfapply=function(callback,args){return Q(callback).nfapply(args)},Promise.prototype.nfapply=function(args){var deferred=defer(),nodeArgs=array_slice(args);return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfcall=function(callback){var args=array_slice(arguments,1);return Q(callback).nfapply(args)},Promise.prototype.nfcall=function(){var nodeArgs=array_slice(arguments),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.fapply(nodeArgs).fail(deferred.reject),deferred.promise},Q.nfbind=Q.denodeify=function(callback){var baseArgs=array_slice(arguments,1);return function(){var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(callback).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nfbind=Promise.prototype.denodeify=function(){var args=array_slice(arguments);return args.unshift(this),Q.denodeify.apply(void 0,args)},Q.nbind=function(callback,thisp){var baseArgs=array_slice(arguments,2);return function(){function bound(){return callback.apply(thisp,arguments)}var nodeArgs=baseArgs.concat(array_slice(arguments)),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(bound).fapply(nodeArgs).fail(deferred.reject),deferred.promise}},Promise.prototype.nbind=function(){var args=array_slice(arguments,0);return args.unshift(this),Q.nbind.apply(void 0,args)},Q.nmapply=Q.npost=function(object,name,args){return Q(object).npost(name,args)},Promise.prototype.nmapply=Promise.prototype.npost=function(name,args){var nodeArgs=array_slice(args||[]),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nsend=Q.nmcall=Q.ninvoke=function(object,name){var nodeArgs=array_slice(arguments,2),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),Q(object).dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Promise.prototype.nsend=Promise.prototype.nmcall=Promise.prototype.ninvoke=function(name){var nodeArgs=array_slice(arguments,1),deferred=defer();return nodeArgs.push(deferred.makeNodeResolver()),this.dispatch("post",[name,nodeArgs]).fail(deferred.reject),deferred.promise},Q.nodeify=nodeify,Promise.prototype.nodeify=function(nodeback){return nodeback?void this.then(function(value){nextTick(function(){nodeback(null,value)})},function(error){nextTick(function(){nodeback(error)})}):this};var qEndingLine=captureLine();return Q})}).call(this,require("_process"))},{_process:27}],30:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;i<len;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],31:[function(require,module,exports){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],32:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":30,"./encode":31}],33:[function(require,module,exports){(function(){var MarkedYAMLError,events,nodes,raml,util,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};events=require("./events"),MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),raml=require("./raml"),util=require("./util"),this.ComposerError=function(_super){function ComposerError(){return _ref=ComposerError.__super__.constructor.apply(this,arguments)}return __extends(ComposerError,_super),ComposerError}(MarkedYAMLError),this.Composer=function(){function Composer(){this.composeRamlTree=__bind(this.composeRamlTree,this),this.anchors={},this.filesToRead=[]}return Composer.prototype.check_node=function(){return this.check_event(events.StreamStartEvent)&&this.get_event(),!this.check_event(events.StreamEndEvent)},Composer.prototype.get_node=function(){if(!this.check_event(events.StreamEndEvent))return this.compose_document()},Composer.prototype.getYamlRoot=function(){var document,event;if(this.get_event(),document=null,this.check_event(events.StreamEndEvent)||(document=this.compose_document()),!this.check_event(events.StreamEndEvent))throw event=this.get_event(),new exports.ComposerError("document scan",document.start_mark,"expected a single document in the stream but found another document",event.start_mark);return this.get_event(),document},Composer.prototype.composeRamlTree=function(node,settings){return(settings.validate||settings.transform)&&(this.load_schemas(node),this.load_traits(node),this.load_types(node),this.load_security_schemes(node)),settings.validate&&this.validate_document(node),settings.transform&&(this.apply_types(node),this.apply_traits(node),this.apply_schemas(node),this.apply_protocols(node),this.join_resources(node)),node},Composer.prototype.compose_document=function(){var node;return this.get_event(),node=this.compose_node(),this.get_event(),this.anchors={},node},Composer.prototype.getPendingFilesList=function(){return this.filesToRead},Composer.prototype.compose_node=function(parent,index){var anchor,event,node;if(this.check_event(events.AliasEvent)){if(event=this.get_event(),anchor=event.anchor,!(anchor in this.anchors))throw new exports.ComposerError(null,null,"found undefined alias "+anchor,event.start_mark);return this.anchors[anchor].clone()}if(event=this.peek_event(),anchor=event.anchor,null!==anchor&&anchor in this.anchors)throw new exports.ComposerError("found duplicate anchor "+anchor+"; first occurence",this.anchors[anchor].start_mark,"second occurrence",event.start_mark);return this.descend_resolver(parent,index),this.check_event(events.ScalarEvent)?node=this.compose_scalar_node(anchor,parent,index):this.check_event(events.SequenceStartEvent)?node=this.compose_sequence_node(anchor):this.check_event(events.MappingStartEvent)&&(node=this.compose_mapping_node(anchor)),this.ascend_resolver(),node},Composer.prototype.compose_fixed_scalar_node=function(anchor,value){var event,node;return event=this.get_event(),node=new nodes.ScalarNode("tag:yaml.org,2002:str",value,event.start_mark,event.end_mark,event.style),null!==anchor&&(this.anchors[anchor]=node),node},Composer.prototype.compose_scalar_node=function(anchor,parent,key){var event,extension,fileType,node,tag;if(event=this.get_event(),tag=event.tag,node={},null!==tag&&"!"!==tag||(tag=this.resolve(nodes.ScalarNode,event.value,event.implicit)),"!include"===event.tag){if(event.value.match(/^\s*$/))throw new exports.ComposerError("while composing scalar out of !include",null,"file name/URL cannot be null",event.start_mark);extension=event.value.split(".").pop(),fileType="yaml"===extension||"yml"===extension||"raml"===extension?"fragment":"scalar",this.filesToRead.push({targetUri:event.value,type:fileType,parentNode:parent,parentKey:key,event:event,includingContext:this.src,targetFileUri:event.value}),node=void 0}else node=new nodes.ScalarNode(tag,event.value,event.start_mark,event.end_mark,event.style);return anchor&&node&&(this.anchors[anchor]=node),node},Composer.prototype.compose_sequence_node=function(anchor){var end_event,index,node,start_event,tag,value;for(start_event=this.get_event(),tag=start_event.tag,null!==tag&&"!"!==tag||(tag=this.resolve(nodes.SequenceNode,null,start_event.implicit)),node=new nodes.SequenceNode(tag,[],start_event.start_mark,null,start_event.flow_style),index=0,anchor&&(this.anchors[anchor]=node);!this.check_event(events.SequenceEndEvent);)(value=this.compose_node(node,index))&&(node.value[index]=value),index++;return end_event=this.get_event(),node.end_mark=end_event.end_mark,node},Composer.prototype.compose_mapping_node=function(anchor){var end_event,item_key,item_value,node,start_event,tag;for(start_event=this.get_event(),tag=start_event.tag,null!==tag&&"!"!==tag||(tag=this.resolve(nodes.MappingNode,null,start_event.implicit)),node=new nodes.MappingNode(tag,[],start_event.start_mark,null,start_event.flow_style),null!==anchor&&(this.anchors[anchor]=node);!this.check_event(events.MappingEndEvent);){if(item_key=this.compose_node(node),!util.isScalar(item_key))throw new exports.ComposerError("while composing mapping key",null,"only scalar map keys are allowed in RAML",item_key.start_mark);(item_value=this.compose_node(node,item_key))&&node.value.push([item_key,item_value])}return end_event=this.get_event(),node.end_mark=end_event.end_mark,node},Composer}()}).call(this)},{"./errors":35,"./events":36,"./nodes":39,"./raml":42,"./util":52}],34:[function(require,module,exports){(function(Buffer){(function(){var MarkedYAMLError,nodes,util,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),util=require("./util"),this.ConstructorError=function(_super){function ConstructorError(){return _ref=ConstructorError.__super__.constructor.apply(this,arguments)}return __extends(ConstructorError,_super),ConstructorError}(MarkedYAMLError),this.BaseConstructor=function(){function BaseConstructor(){this.constructed_objects={},this.constructing_nodes=[],this.deferred_constructors=[]}return BaseConstructor.prototype.yaml_constructors={},BaseConstructor.prototype.yaml_multi_constructors={},BaseConstructor.add_constructor=function(tag,constructor){return this.prototype.hasOwnProperty("yaml_constructors")||(this.prototype.yaml_constructors=util.extend({},this.prototype.yaml_constructors)),this.prototype.yaml_constructors[tag]=constructor},BaseConstructor.add_multi_constructor=function(tag_prefix,multi_constructor){return this.prototype.hasOwnProperty("yaml_multi_constructors")||(this.prototype.yaml_multi_constructors=util.extend({},this.prototype.yaml_multi_constructors)),this.prototype.yaml_multi_constructors[tag_prefix]=multi_constructor},BaseConstructor.prototype.construct_document=function(node){var data;for(this.applyAstTransformations(node),data=this.construct_object(node);!util.is_empty(this.deferred_constructors);)this.deferred_constructors.pop()();return this.applyTransformations(data),data},BaseConstructor.prototype.defer=function(f){return this.deferred_constructors.push(f)},BaseConstructor.prototype.construct_object=function(node){var constructor,object,tag_prefix,tag_suffix,_ref1;if(node.unique_id in this.constructed_objects)return this.constructed_objects[node.unique_id];if(_ref1=node.unique_id,__indexOf.call(this.constructing_nodes,_ref1)>=0)throw new exports.ConstructorError(null,null,"found unconstructable recursive node",node.start_mark);if(this.constructing_nodes.push(node.unique_id),constructor=null,tag_suffix=null,node.tag in this.yaml_constructors)constructor=this.yaml_constructors[node.tag];else{for(tag_prefix in this.yaml_multi_constructors)if(node.tag.indexOf(0===tag_prefix)){tag_suffix=node.tag.slice(tag_prefix.length),constructor=this.yaml_multi_constructors[tag_prefix];break}null==constructor&&(null in this.yaml_multi_constructors?(tag_suffix=node.tag,constructor=this.yaml_multi_constructors[null]):null in this.yaml_constructors?constructor=this.yaml_constructors[null]:node instanceof nodes.ScalarNode?constructor=this.construct_scalar:node instanceof nodes.SequenceNode?constructor=this.construct_sequence:node instanceof nodes.MappingNode&&(constructor=this.construct_mapping))}return object=constructor.call(this,null!=tag_suffix?tag_suffix:node,node),this.constructed_objects[node.unique_id]=object,this.constructing_nodes.pop(),object},BaseConstructor.prototype.construct_scalar=function(node){if(!(node instanceof nodes.ScalarNode))throw new exports.ConstructorError(null,null,"expected a scalar node but found "+node.id,node.start_mark);return node.value},BaseConstructor.prototype.construct_sequence=function(node){var child,_i,_len,_ref1,_results;if(!(node instanceof nodes.SequenceNode))throw new exports.ConstructorError(null,null,"expected an array node but found "+node.id,node.start_mark);for(_ref1=node.value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)child=_ref1[_i],_results.push(this.construct_object(child));return _results},BaseConstructor.prototype.construct_mapping=function(node){var key,key_item,key_item_value,key_node,mapping,value,value_node,_i,_j,_len,_len1,_ref1,_ref2,_ref3;if(!(node instanceof nodes.MappingNode))throw new exports.ConstructorError(null,null,"expected a map node but found "+node.id,node.start_mark);for(mapping={},_ref1=node.value,_i=0,_len=_ref1.length;_i<_len;_i++)if(_ref2=_ref1[_i],key_node=_ref2[0],value_node=_ref2[1],key=this.construct_object(key_node),value=this.construct_object(value_node),"object"==typeof key&&"tag:yaml.org,2002:seq"===key_node.tag)for(_ref3=key_node.value,_j=0,_len1=_ref3.length;_j<_len1;_j++)key_item=_ref3[_j],key_item_value=this.construct_object(key_item),mapping[key_item_value]=value;else{if("object"==typeof key)throw new exports.ConstructorError("while constructing a map",node.start_mark,"found unhashable key",key_node.start_mark);mapping[key]=value}return mapping},BaseConstructor.prototype.construct_pairs=function(node){var key,key_node,pairs,value,value_node,_i,_len,_ref1,_ref2;if(!(node instanceof nodes.MappingNode))throw new exports.ConstructorError(null,null,"expected a map node but found "+node.id,node.start_mark);for(pairs=[],_ref1=node.value,_i=0,_len=_ref1.length;_i<_len;_i++)_ref2=_ref1[_i],key_node=_ref2[0],value_node=_ref2[1],key=this.construct_object(key_node),value=this.construct_object(value_node),
pairs.push([key,value]);return pairs},BaseConstructor}(),this.Constructor=function(_super){function Constructor(){return _ref1=Constructor.__super__.constructor.apply(this,arguments)}var BOOL_VALUES,TIMESTAMP_PARTS,TIMESTAMP_REGEX;return __extends(Constructor,_super),BOOL_VALUES={"true":!0,"false":!1},TIMESTAMP_REGEX=/^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:(?:[Tt]|[\x20\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\.([0-9]*))?(?:[\x20\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?)?$/,TIMESTAMP_PARTS={year:1,month:2,day:3,hour:4,minute:5,second:6,fraction:7,tz:8,tz_sign:9,tz_hour:10,tz_minute:11},Constructor.prototype.yaml_constructors={},Constructor.prototype.yaml_multi_constructors={},Constructor.prototype.construct_scalar=function(node){var key_node,value_node,_i,_len,_ref2,_ref3;if(node instanceof nodes.MappingNode)for(_ref2=node.value,_i=0,_len=_ref2.length;_i<_len;_i++)if(_ref3=_ref2[_i],key_node=_ref3[0],value_node=_ref3[1],"tag:yaml.org,2002:value"===key_node.tag)return this.construct_scalar(value_node);return Constructor.__super__.construct_scalar.call(this,node)},Constructor.prototype.flatten_mapping=function(node){var index,key_node,merge,submerge,subnode,value,value_node,_i,_j,_len,_len1,_ref2,_ref3;for(merge=[],index=0;index<node.value.length;)if(_ref2=node.value[index],key_node=_ref2[0],value_node=_ref2[1],"tag:yaml.org,2002:merge"===key_node.tag)if(node.value.splice(index,1),value_node instanceof nodes.MappingNode)this.flatten_mapping(value_node),merge=merge.concat(value_node.value);else{if(!(value_node instanceof nodes.SequenceNode))throw new exports.ConstructorError("while constructing a map",node.start_mark,"expected a map or an array of maps for            merging but found "+value_node.id,value_node.start_mark);for(submerge=[],_ref3=value_node.value,_i=0,_len=_ref3.length;_i<_len;_i++){if(subnode=_ref3[_i],!(subnode instanceof nodes.MappingNode))throw new exports.ConstructorError("while constructing a map",node.start_mark,"expected a map for merging, but found "+subnode.id,subnode.start_mark);this.flatten_mapping(subnode),submerge.push(subnode.value)}for(submerge.reverse(),_j=0,_len1=submerge.length;_j<_len1;_j++)value=submerge[_j],merge=merge.concat(value)}else"tag:yaml.org,2002:value"===key_node.tag?(key_node.tag="tag:yaml.org,2002:str",index++):index++;if(merge.length)return node.value=merge.concat(node.value)},Constructor.prototype.construct_mapping=function(node){return node instanceof nodes.MappingNode&&this.flatten_mapping(node),Constructor.__super__.construct_mapping.call(this,node)},Constructor.prototype.construct_yaml_null=function(node){return this.construct_scalar(node),null},Constructor.prototype.construct_yaml_bool=function(node){var value;return value=this.construct_scalar(node),BOOL_VALUES[value.toLowerCase()]},Constructor.prototype.construct_yaml_int=function(node){var base,digit,digits,part,sign,value,_i,_len,_ref2;if(value=this.construct_scalar(node),value=value.replace(/_/g,""),sign="-"===value[0]?-1:1,_ref2=value[0],__indexOf.call("+-",_ref2)>=0&&(value=value.slice(1)),"0"===value)return 0;if(0===value.indexOf("0b"))return sign*parseInt(value.slice(2),2);if(0===value.indexOf("0x"))return sign*parseInt(value.slice(2),16);if(0===value.indexOf("0o"))return sign*parseInt(value.slice(2),8);if("0"===value[0])return sign*parseInt(value,8);if(__indexOf.call(value,":")>=0){for(digits=function(){var _i,_len,_ref3,_results;for(_ref3=value.split(/:/g),_results=[],_i=0,_len=_ref3.length;_i<_len;_i++)part=_ref3[_i],_results.push(parseInt(part));return _results}(),digits.reverse(),base=1,value=0,_i=0,_len=digits.length;_i<_len;_i++)digit=digits[_i],value+=digit*base,base*=60;return sign*value}return sign*parseInt(value)},Constructor.prototype.construct_yaml_float=function(node){var base,digit,digits,part,sign,value,_i,_len,_ref2;if(value=this.construct_scalar(node),value=value.replace(/_/g,"").toLowerCase(),sign="-"===value[0]?-1:1,_ref2=value[0],__indexOf.call("+-",_ref2)>=0&&(value=value.slice(1)),".inf"===value)return sign*(1/0);if(".nan"===value)return NaN;if(__indexOf.call(value,":")>=0){for(digits=function(){var _i,_len,_ref3,_results;for(_ref3=value.split(/:/g),_results=[],_i=0,_len=_ref3.length;_i<_len;_i++)part=_ref3[_i],_results.push(parseFloat(part));return _results}(),digits.reverse(),base=1,value=0,_i=0,_len=digits.length;_i<_len;_i++)digit=digits[_i],value+=digit*base,base*=60;return sign*value}return sign*parseFloat(value)},Constructor.prototype.construct_yaml_binary=function(node){var error,value;value=this.construct_scalar(node);try{return"undefined"!=typeof window&&null!==window?atob(value):new Buffer(value,"base64").toString("ascii")}catch(_error){throw error=_error,new exports.ConstructorError(null,null,"failed to decode base64 data: "+error,node.start_mark)}},Constructor.prototype.construct_yaml_timestamp=function(node){var date,day,fraction,hour,index,key,match,millisecond,minute,month,second,tz_hour,tz_minute,tz_sign,value,values,year;value=this.construct_scalar(node),match=node.value.match(TIMESTAMP_REGEX),values={};for(key in TIMESTAMP_PARTS)index=TIMESTAMP_PARTS[key],values[key]=match[index];if(year=parseInt(values.year),month=parseInt(values.month)-1,day=parseInt(values.day),!values.hour)return new Date(Date.UTC(year,month,day));if(hour=parseInt(values.hour),minute=parseInt(values.minute),second=parseInt(values.second),millisecond=0,values.fraction){for(fraction=values.fraction.slice(0,6);fraction.length<6;)fraction+="0";fraction=parseInt(fraction),millisecond=Math.round(fraction/1e3)}return values.tz_sign&&(tz_sign="-"===values.tz_sign?1:-1,(tz_hour=parseInt(values.tz_hour))&&(hour+=tz_sign*tz_hour),(tz_minute=parseInt(values.tz_minute))&&(minute+=tz_sign*tz_minute)),date=new Date(Date.UTC(year,month,day,hour,minute,second,millisecond))},Constructor.prototype.construct_yaml_pair_list=function(type,node){var list,_this=this;if(list=[],!(node instanceof nodes.SequenceNode))throw new exports.ConstructorError("while constructing "+type,node.start_mark,"expected an array but found "+node.id,node.start_mark);return this.defer(function(){var key,key_node,subnode,value,value_node,_i,_len,_ref2,_ref3,_results;for(_ref2=node.value,_results=[],_i=0,_len=_ref2.length;_i<_len;_i++){if(subnode=_ref2[_i],!(subnode instanceof nodes.MappingNode))throw new exports.ConstructorError("while constructing "+type,node.start_mark,"expected a map of length 1 but found "+subnode.id,subnode.start_mark);if(1!==subnode.value.length)throw new exports.ConstructorError("while constructing "+type,node.start_mark,"expected a map of length 1 but found "+subnode.id,subnode.start_mark);_ref3=subnode.value[0],key_node=_ref3[0],value_node=_ref3[1],key=_this.construct_object(key_node),value=_this.construct_object(value_node),_results.push(list.push([key,value]))}return _results}),list},Constructor.prototype.construct_yaml_omap=function(node){return this.construct_yaml_pair_list("an ordered map",node)},Constructor.prototype.construct_yaml_pairs=function(node){return this.construct_yaml_pair_list("pairs",node)},Constructor.prototype.construct_yaml_set=function(node){var data,_this=this;return data=[],this.defer(function(){var item,_results;_results=[];for(item in _this.construct_mapping(node))_results.push(data.push(item));return _results}),data},Constructor.prototype.construct_yaml_str=function(node){return this.construct_scalar(node)},Constructor.prototype.construct_yaml_seq=function(node){var data,_this=this;return data=[],this.defer(function(){var item,_i,_len,_ref2,_results;for(_ref2=_this.construct_sequence(node),_results=[],_i=0,_len=_ref2.length;_i<_len;_i++)item=_ref2[_i],_results.push(data.push(item));return _results}),data},Constructor.prototype.construct_yaml_map=function(node){var data,_this=this;return data={},this.defer(function(){var key,value,_ref2,_results;_ref2=_this.construct_mapping(node),_results=[];for(key in _ref2)value=_ref2[key],_results.push(data[key]=value);return _results}),data},Constructor.prototype.construct_yaml_object=function(node,klass){var data,_this=this;return data=new klass,this.defer(function(){var key,value,_ref2,_results;_ref2=_this.construct_mapping(node,!0),_results=[];for(key in _ref2)value=_ref2[key],_results.push(data[key]=value);return _results}),data},Constructor.prototype.construct_undefined=function(node){throw new exports.ConstructorError(null,null,"could not determine a constructor for the tag "+node.tag,node.start_mark)},Constructor}(this.BaseConstructor),this.Constructor.add_constructor("tag:yaml.org,2002:null",this.Constructor.prototype.construct_yaml_null),this.Constructor.add_constructor("tag:yaml.org,2002:bool",this.Constructor.prototype.construct_yaml_bool),this.Constructor.add_constructor("tag:yaml.org,2002:int",this.Constructor.prototype.construct_yaml_int),this.Constructor.add_constructor("tag:yaml.org,2002:float",this.Constructor.prototype.construct_yaml_float),this.Constructor.add_constructor("tag:yaml.org,2002:binary",this.Constructor.prototype.construct_yaml_binary),this.Constructor.add_constructor("tag:yaml.org,2002:timestamp",this.Constructor.prototype.construct_yaml_timestamp),this.Constructor.add_constructor("tag:yaml.org,2002:omap",this.Constructor.prototype.construct_yaml_omap),this.Constructor.add_constructor("tag:yaml.org,2002:pairs",this.Constructor.prototype.construct_yaml_pairs),this.Constructor.add_constructor("tag:yaml.org,2002:set",this.Constructor.prototype.construct_yaml_set),this.Constructor.add_constructor("tag:yaml.org,2002:str",this.Constructor.prototype.construct_yaml_str),this.Constructor.add_constructor("tag:yaml.org,2002:seq",this.Constructor.prototype.construct_yaml_seq),this.Constructor.add_constructor("tag:yaml.org,2002:map",this.Constructor.prototype.construct_yaml_map),this.Constructor.add_constructor(null,this.Constructor.prototype.construct_undefined),module.exports.Constructor=this.Constructor,module.exports.ConstructorError=this.ConstructorError}).call(this)}).call(this,require("buffer").Buffer)},{"./errors":35,"./nodes":39,"./util":52,buffer:6}],35:[function(require,module,exports){(function(){var _ref,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};this.Mark=function(){function Mark(name,line,column,buffer,pointer){this.name=name,this.line=line,this.column=column,this.buffer=buffer,this.pointer=pointer}return Mark.prototype.get_snippet=function(indent,max_length){var break_chars,end,head,start,tail,_ref,_ref1;if(null==indent&&(indent=4),null==max_length&&(max_length=75),null==this.buffer)return null;for(break_chars="\0\r\n\u2028\u2029",head="",start=this.pointer;start>0&&(_ref=this.buffer[start-1],__indexOf.call(break_chars,_ref)<0);)if(start--,this.pointer-start>max_length/2-1){head=" ... ",start+=5;break}for(tail="",end=this.pointer;end<this.buffer.length&&(_ref1=this.buffer[end],__indexOf.call(break_chars,_ref1)<0);)if(end++,end-this.pointer>max_length/2-1){tail=" ... ",end-=5;break}return""+new Array(indent).join(" ")+head+this.buffer.slice(start,end)+tail+"\n"+new Array(indent+this.pointer-start+head.length).join(" ")+"^"},Mark.prototype.toString=function(){var snippet,where;return snippet=this.get_snippet(),where='  in "'+this.name+'", line '+(this.line+1)+", column "+(this.column+1),snippet?where:""+where+":\n"+snippet},Mark}(),this.YAMLError=function(_super){function YAMLError(){YAMLError.__super__.constructor.call(this)}return __extends(YAMLError,_super),YAMLError}(Error),this.MarkedYAMLError=function(_super){function MarkedYAMLError(context,context_mark,message,problem_mark,note){this.context=context,this.context_mark=context_mark,this.message=message,this.problem_mark=problem_mark,this.note=note,MarkedYAMLError.__super__.constructor.call(this),this.message||(this.message=this.context),this.problem_mark||(this.problem_mark=this.context_mark)}return __extends(MarkedYAMLError,_super),MarkedYAMLError.prototype.toString=function(){var lines;return lines=[],null!=this.context&&lines.push(this.context),null==this.context_mark||null!=this.message&&null!=this.problem_mark&&this.context_mark.name===this.problem_mark.name&&this.context_mark.line===this.problem_mark.line&&this.context_mark.column===this.problem_mark.column||lines.push(this.context_mark.toString()),null!=this.message&&lines.push(this.message),null!=this.problem_mark&&lines.push(this.problem_mark.toString()),null!=this.note&&lines.push(this.note),lines.join("\n")},MarkedYAMLError}(this.YAMLError),this.ValidationError=function(_super){function ValidationError(){return _ref=ValidationError.__super__.constructor.apply(this,arguments)}return __extends(ValidationError,_super),ValidationError}(this.MarkedYAMLError)}).call(this)},{}],36:[function(require,module,exports){(function(){var _ref,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};this.Event=function(){function Event(start_mark,end_mark){this.start_mark=start_mark,this.end_mark=end_mark}return Event}(),this.NodeEvent=function(_super){function NodeEvent(anchor,start_mark,end_mark){this.anchor=anchor,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(NodeEvent,_super),NodeEvent}(this.Event),this.CollectionStartEvent=function(_super){function CollectionStartEvent(anchor,tag,implicit,start_mark,end_mark){this.anchor=anchor,this.tag=tag,this.implicit=implicit,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(CollectionStartEvent,_super),CollectionStartEvent}(this.NodeEvent),this.CollectionEndEvent=function(_super){function CollectionEndEvent(){return _ref=CollectionEndEvent.__super__.constructor.apply(this,arguments)}return __extends(CollectionEndEvent,_super),CollectionEndEvent}(this.Event),this.StreamStartEvent=function(_super){function StreamStartEvent(start_mark,end_mark,explicit,version,tags){this.start_mark=start_mark,this.end_mark=end_mark,this.explicit=explicit,this.version=version,this.tags=tags}return __extends(StreamStartEvent,_super),StreamStartEvent}(this.Event),this.StreamEndEvent=function(_super){function StreamEndEvent(){return _ref1=StreamEndEvent.__super__.constructor.apply(this,arguments)}return __extends(StreamEndEvent,_super),StreamEndEvent}(this.Event),this.DocumentStartEvent=function(_super){function DocumentStartEvent(start_mark,end_mark,explicit,version,tags){this.start_mark=start_mark,this.end_mark=end_mark,this.explicit=explicit,this.version=version,this.tags=tags}return __extends(DocumentStartEvent,_super),DocumentStartEvent}(this.Event),this.DocumentEndEvent=function(_super){function DocumentEndEvent(start_mark,end_mark,explicit){this.start_mark=start_mark,this.end_mark=end_mark,this.explicit=explicit}return __extends(DocumentEndEvent,_super),DocumentEndEvent}(this.Event),this.AliasEvent=function(_super){function AliasEvent(){return _ref2=AliasEvent.__super__.constructor.apply(this,arguments)}return __extends(AliasEvent,_super),AliasEvent}(this.NodeEvent),this.ScalarEvent=function(_super){function ScalarEvent(anchor,tag,implicit,value,start_mark,end_mark,style){this.anchor=anchor,this.tag=tag,this.implicit=implicit,this.value=value,this.start_mark=start_mark,this.end_mark=end_mark,this.style=style}return __extends(ScalarEvent,_super),ScalarEvent}(this.NodeEvent),this.SequenceStartEvent=function(_super){function SequenceStartEvent(){return _ref3=SequenceStartEvent.__super__.constructor.apply(this,arguments)}return __extends(SequenceStartEvent,_super),SequenceStartEvent}(this.CollectionStartEvent),this.SequenceEndEvent=function(_super){function SequenceEndEvent(){return _ref4=SequenceEndEvent.__super__.constructor.apply(this,arguments)}return __extends(SequenceEndEvent,_super),SequenceEndEvent}(this.CollectionEndEvent),this.MappingStartEvent=function(_super){function MappingStartEvent(){return _ref5=MappingStartEvent.__super__.constructor.apply(this,arguments)}return __extends(MappingStartEvent,_super),MappingStartEvent}(this.CollectionStartEvent),this.MappingEndEvent=function(_super){function MappingEndEvent(){return _ref6=MappingEndEvent.__super__.constructor.apply(this,arguments)}return __extends(MappingEndEvent,_super),MappingEndEvent}(this.CollectionEndEvent)}).call(this)},{}],37:[function(require,module,exports){(function(){var MarkedYAMLError,nodes,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),this.JoinError=function(_super){function JoinError(){return _ref=JoinError.__super__.constructor.apply(this,arguments)}return __extends(JoinError,_super),JoinError}(MarkedYAMLError),this.Joiner=function(){function Joiner(){}return Joiner.prototype.join_resources=function(node,call){var resources,resourcesArray,resourcesName,resourcesValue,_this=this;if(null==call&&(call=0),resources=[],(null!=node?node.value:void 0)&&(resources=node.value.filter(function(childNode){var _ref1;return null!=(_ref1=childNode[0])?_ref1.value.match(/^\//):void 0})),resourcesArray=[],resources.length>0)return(null!=node?node.value:void 0)&&(node.value=node.value.filter(function(childNode){return!childNode[0].value.match(/^\//)})),resourcesName=new nodes.ScalarNode("tag:yaml.org,2002:str","resources",resources[0][0].start_mark,resources[resources.length-1][1].end_mark),resources.forEach(function(resource){var relativeUriName,relativeUriValue;return relativeUriName=new nodes.ScalarNode("tag:yaml.org,2002:str","relativeUri",resource[0].start_mark,resource[1].end_mark),relativeUriValue=new nodes.ScalarNode("tag:yaml.org,2002:str",resource[0].value,resource[0].start_mark,resource[1].end_mark),"tag:yaml.org,2002:null"===resource[1].tag&&(resource[1]=new nodes.MappingNode("tag:yaml.org,2002:map",[],resource[0].start_mark,resource[1].end_mark)),resource[1].value.push([relativeUriName,relativeUriValue]),resourcesArray.push(resource[1]),_this.join_methods(resource[1]),_this.join_resources(resource[1],++call)}),resourcesValue=new nodes.SequenceNode("tag:yaml.org,2002:seq",resourcesArray,resources[0][0].start_mark,resources[resources.length-1][1].end_mark),node.value.push([resourcesName,resourcesValue])},Joiner.prototype.join_methods=function(node){var methods,methodsArray,methodsName,methodsValue,_this=this;if(methods=[],node&&node.value&&(methods=node.value.filter(function(childNode){var _ref1;return _this.isHttpMethod(null!=(_ref1=childNode[0])?_ref1.value:void 0)})),methodsArray=[],methods.length>0)return node.value=node.value.filter(function(childNode){return!_this.isHttpMethod(childNode[0].value)}),methodsName=new nodes.ScalarNode("tag:yaml.org,2002:str","methods",methods[0][0].start_mark,methods[methods.length-1][1].end_mark),methods.forEach(function(method){var methodName,methodValue;return methodName=new nodes.ScalarNode("tag:yaml.org,2002:str","method",method[0].start_mark,method[1].end_mark),methodValue=new nodes.ScalarNode("tag:yaml.org,2002:str",method[0].value,method[0].start_mark,method[1].end_mark),"tag:yaml.org,2002:null"===method[1].tag&&(method[1]=new nodes.MappingNode("tag:yaml.org,2002:map",[],method[1].start_mark,method[1].end_mark)),method[1].value.push([methodName,methodValue]),methodsArray.push(method[1])}),methodsValue=new nodes.SequenceNode("tag:yaml.org,2002:seq",methodsArray,methods[0][0].start_mark,methods[methods.length-1][1].end_mark),node.value.push([methodsName,methodsValue])},Joiner}()}).call(this)},{"./errors":35,"./nodes":39}],38:[function(require,module,exports){(function(){var composer,construct,joiner,parser,protocols,reader,resolver,scanner,schemas,securitySchemes,traits,transformations,types,util,validator;util=require("./util"),reader=require("./reader"),scanner=require("./scanner"),parser=require("./parser"),composer=require("./composer"),resolver=require("./resolver"),construct=require("./construct"),validator=require("./validator"),joiner=require("./joiner"),traits=require("./traits"),types=require("./resourceTypes"),schemas=require("./schemas"),protocols=require("./protocols"),securitySchemes=require("./securitySchemes"),transformations=require("./transformations"),this.make_loader=function(Reader,Scanner,Parser,Composer,Resolver,Validator,ResourceTypes,Traits,Schemas,Protocols,Joiner,SecuritySchemes,Constructor,Transformations){return null==Reader&&(Reader=reader.Reader),null==Scanner&&(Scanner=scanner.Scanner),null==Parser&&(Parser=parser.Parser),null==Composer&&(Composer=composer.Composer),null==Resolver&&(Resolver=resolver.Resolver),null==Validator&&(Validator=validator.Validator),null==ResourceTypes&&(ResourceTypes=types.ResourceTypes),null==Traits&&(Traits=traits.Traits),null==Schemas&&(Schemas=schemas.Schemas),null==Protocols&&(Protocols=protocols.Protocols),null==Joiner&&(Joiner=joiner.Joiner),null==SecuritySchemes&&(SecuritySchemes=securitySchemes.SecuritySchemes),null==Constructor&&(Constructor=construct.Constructor),null==Transformations&&(Transformations=transformations.Transformations),function(){function _Class(stream,location,settings,parent){var _i,_len,_ref;for(this.parent=null!=parent?parent:null,components[0].call(this,stream,location),components[1].call(this,settings),components[2].call(this,settings),components[3].call(this,settings),_ref=components.slice(4),_i=0,_len=_ref.length;_i<_len;_i++)component=_ref[_i],component.call(this)}var component,components;return components=[Reader,Scanner,Composer,Transformations,Parser,Resolver,Validator,Traits,ResourceTypes,Schemas,Protocols,Joiner,Constructor,SecuritySchemes],util.extend.apply(util,[_Class.prototype].concat(function(){var _i,_len,_results;for(_results=[],_i=0,_len=components.length;_i<_len;_i++)component=components[_i],_results.push(component.prototype);return _results}())),_Class}()},this.Loader=this.make_loader()}).call(this)},{"./composer":33,"./construct":34,"./joiner":37,"./parser":40,"./protocols":41,"./reader":43,"./resolver":44,"./resourceTypes":45,"./scanner":46,"./schemas":47,"./securitySchemes":48,"./traits":50,"./transformations":51,"./util":52,"./validator":53}],39:[function(require,module,exports){(function(){var MarkedYAMLError,unique_id,_ref,_ref1,_ref2,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};MarkedYAMLError=require("./errors").MarkedYAMLError,unique_id=0,this.ApplicationError=function(_super){function ApplicationError(){return _ref=ApplicationError.__super__.constructor.apply(this,arguments)}return __extends(ApplicationError,_super),ApplicationError}(MarkedYAMLError),this.Node=function(){function Node(tag,value,start_mark,end_mark){this.tag=tag,this.value=value,this.start_mark=start_mark,this.end_mark=end_mark,this.unique_id="node_"+unique_id++}return Node.prototype.clone=function(){var temp;return temp=new this.constructor(this.tag,this.value,this.start_mark,this.end_mark)},Node}(),this.ScalarNode=function(_super){function ScalarNode(tag,value,start_mark,end_mark,style){this.tag=tag,this.value=value,this.start_mark=start_mark,this.end_mark=end_mark,this.style=style,ScalarNode.__super__.constructor.apply(this,arguments)}return __extends(ScalarNode,_super),ScalarNode.prototype.id="scalar",ScalarNode.prototype.clone=function(){var temp;return temp=new this.constructor(this.tag,this.value,this.start_mark,this.end_mark,this.style)},ScalarNode.prototype.cloneRemoveIs=function(){return this.clone()},ScalarNode.prototype.combine=function(node){if("tag:yaml.org,2002:null"===this.tag&&"tag:yaml.org,2002:map"===node.tag)return this.value=new exports.MappingNode("tag:yaml.org,2002:map",[],node.start_mark,node.end_mark),this.value.combine(node);if(!(node instanceof exports.ScalarNode))throw new exports.ApplicationError("while applying node",null,"different YAML structures",this.start_mark);return this.value=node.value},ScalarNode.prototype.remove_question_mark_properties=function(){},ScalarNode}(this.Node),this.CollectionNode=function(_super){function CollectionNode(tag,value,start_mark,end_mark,flow_style){this.tag=tag,this.value=value,this.start_mark=start_mark,this.end_mark=end_mark,this.flow_style=flow_style,CollectionNode.__super__.constructor.apply(this,arguments)}return __extends(CollectionNode,_super),CollectionNode}(this.Node),this.SequenceNode=function(_super){function SequenceNode(){return _ref1=SequenceNode.__super__.constructor.apply(this,arguments)}return __extends(SequenceNode,_super),SequenceNode.prototype.id="sequence",SequenceNode.prototype.clone=function(){var item,items,temp,value,_i,_len,_ref2;for(items=[],_ref2=this.value,_i=0,_len=_ref2.length;_i<_len;_i++)item=_ref2[_i],value=item.clone(),items.push(value);return temp=new this.constructor(this.tag,items,this.start_mark,this.end_mark,this.flow_style)},SequenceNode.prototype.cloneRemoveIs=function(){return this.clone()},SequenceNode.prototype.combine=function(node){var property,value,_i,_len,_ref2,_results;if(!(node instanceof exports.SequenceNode))throw new exports.ApplicationError("while applying node",null,"different YAML structures",this.start_mark);for(_ref2=node.value,_results=[],_i=0,_len=_ref2.length;_i<_len;_i++)property=_ref2[_i],value=property.clone(),_results.push(this.value.push(value));return _results},SequenceNode.prototype.remove_question_mark_properties=function(){var item,_i,_len,_ref2,_results;for(_ref2=this.value,_results=[],_i=0,_len=_ref2.length;_i<_len;_i++)item=_ref2[_i],_results.push(item.remove_question_mark_properties());return _results},SequenceNode}(this.CollectionNode),this.MappingNode=function(_super){function MappingNode(){return _ref2=MappingNode.__super__.constructor.apply(this,arguments)}return __extends(MappingNode,_super),MappingNode.prototype.id="mapping",MappingNode.prototype.clone=function(){var name,properties,property,temp,value,_i,_len,_ref3;for(properties=[],_ref3=this.value,_i=0,_len=_ref3.length;_i<_len;_i++)property=_ref3[_i],name=property[0].clone(),value=property[1].clone(),properties.push([name,value]);return temp=new this.constructor(this.tag,properties,this.start_mark,this.end_mark,this.flow_style)},MappingNode.prototype.cloneRemoveIs=function(){var name,properties,property,temp,value,_i,_len,_ref3,_ref4;for(properties=[],_ref3=this.value,_i=0,_len=_ref3.length;_i<_len;_i++)property=_ref3[_i],name=property[0].cloneRemoveIs(),value=property[1].cloneRemoveIs(),"is"!==(_ref4=name.value)&&properties.push([name,value]);return temp=new this.constructor(this.tag,properties,this.start_mark,this.end_mark,this.flow_style)},MappingNode.prototype.cloneForTrait=function(){var name,properties,property,temp,value,_i,_len,_ref3,_ref4;for(properties=[],_ref3=this.value,_i=0,_len=_ref3.length;_i<_len;_i++)property=_ref3[_i],name=property[0].clone(),value=property[1].clone(),"usage"!==(_ref4=name.value)&&"displayName"!==_ref4&&properties.push([name,value]);return temp=new this.constructor(this.tag,properties,this.start_mark,this.end_mark,this.flow_style)},MappingNode.prototype.cloneForResourceType=function(){var name,properties,property,temp,value,_i,_len,_ref3,_ref4;for(properties=[],_ref3=this.value,_i=0,_len=_ref3.length;_i<_len;_i++)property=_ref3[_i],name=property[0].cloneRemoveIs(),value=property[1].cloneRemoveIs(),"is"!==(_ref4=name.value)&&"type"!==_ref4&&"usage"!==_ref4&&"displayName"!==_ref4&&properties.push([name,value]);return temp=new this.constructor(this.tag,properties,this.start_mark,this.end_mark,this.flow_style)},MappingNode.prototype.combine=function(resourceNode){var name,node_has_property,nonNullNode,ownNodeProperty,ownNodePropertyName,resourceProperty,_i,_len,_ref3,_results;if("tag:yaml.org,2002:null"===resourceNode.tag&&(resourceNode=new exports.MappingNode("tag:yaml.org,2002:map",[],resourceNode.start_mark,resourceNode.end_mark)),!(resourceNode instanceof exports.MappingNode))throw new exports.ApplicationError("while applying node",null,"different YAML structures",this.start_mark);for(_ref3=resourceNode.value,_results=[],_i=0,_len=_ref3.length;_i<_len;_i++)resourceProperty=_ref3[_i],name=resourceProperty[0].value,node_has_property=this.value.some(function(someProperty){return someProperty[0].value===name||someProperty[0].value+"?"===name||someProperty[0].value===name+"?"}),node_has_property?_results.push(function(){var _j,_len1,_ref4,_results1;for(_ref4=this.value,_results1=[],_j=0,_len1=_ref4.length;_j<_len1;_j++)ownNodeProperty=_ref4[_j],ownNodePropertyName=ownNodeProperty[0].value,ownNodePropertyName===name||ownNodePropertyName+"?"===name||ownNodePropertyName===name+"?"?("tag:yaml.org,2002:null"===ownNodeProperty[1].tag&&"tag:yaml.org,2002:map"===resourceProperty[1].tag&&(nonNullNode=new exports.MappingNode("tag:yaml.org,2002:map",[],ownNodeProperty[1].start_mark,ownNodeProperty[1].end_mark),ownNodeProperty[1]=nonNullNode),ownNodeProperty[1].combine(resourceProperty[1]),("?"!==ownNodeProperty[0].value.slice(-1)||"?"!==resourceProperty[0].value.slice(-1))&&"?"===ownNodeProperty[0].value.slice(-1)?_results1.push(ownNodeProperty[0].value=ownNodeProperty[0].value.slice(0,-1)):_results1.push(void 0)):_results1.push(void 0);return _results1}.call(this)):_results.push(this.value.push([resourceProperty[0].clone(),resourceProperty[1].clone()]));return _results},MappingNode.prototype.remove_question_mark_properties=function(){var property,_i,_len,_ref3,_results;for(this.value=this.value.filter(function(property){return"?"!==property[0].value.slice(-1)}),_ref3=this.value,_results=[],_i=0,_len=_ref3.length;_i<_len;_i++)property=_ref3[_i],_results.push(property[1].remove_question_mark_properties());return _results},MappingNode}(this.CollectionNode)}).call(this)},{"./errors":35}],40:[function(require,module,exports){(function(){var MarkedYAMLError,events,tokens,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice;events=require("./events"),MarkedYAMLError=require("./errors").MarkedYAMLError,tokens=require("./tokens"),this.ParserError=function(_super){function ParserError(){return _ref=ParserError.__super__.constructor.apply(this,arguments)}return __extends(ParserError,_super),ParserError}(MarkedYAMLError),this.Parser=function(){function Parser(){this.current_event=null,this.yaml_version=null,this.tag_handles={},this.states=[],this.marks=[],this.state="parse_stream_start"}var DEFAULT_TAGS;return DEFAULT_TAGS={"!":"!","!!":"tag:yaml.org,2002:"},Parser.prototype.dispose=function(){return this.states=[],this.state=null},Parser.prototype.check_event=function(){var choice,choices,_i,_len;if(choices=1<=arguments.length?__slice.call(arguments,0):[],null===this.current_event&&null!=this.state&&(this.current_event=this[this.state]()),null!==this.current_event){if(0===choices.length)return!0;for(_i=0,_len=choices.length;_i<_len;_i++)if(choice=choices[_i],this.current_event instanceof choice)return!0}return!1},Parser.prototype.peek_event=function(){return null===this.current_event&&null!=this.state&&(this.current_event=this[this.state]()),this.current_event},Parser.prototype.get_event=function(){var event;
return null===this.current_event&&null!=this.state&&(this.current_event=this[this.state]()),event=this.current_event,this.current_event=null,event},Parser.prototype.parse_stream_start=function(){var event,token;return token=this.get_token(),event=new events.StreamStartEvent(token.start_mark,token.end_mark),this.state="parse_implicit_document_start",event},Parser.prototype.parse_implicit_document_start=function(){var end_mark,event,start_mark,token;return this.check_token(tokens.DirectiveToken,tokens.DocumentStartToken,tokens.StreamEndToken)?this.parse_document_start():(this.tag_handles=DEFAULT_TAGS,token=this.peek_token(),start_mark=end_mark=token.start_mark,event=new events.DocumentStartEvent(start_mark,end_mark,(!1)),this.states.push("parse_document_end"),this.state="parse_block_node",event)},Parser.prototype.parse_document_start=function(){for(var end_mark,event,start_mark,tags,token,version,_ref1;this.check_token(tokens.DocumentEndToken);)this.get_token();if(this.check_token(tokens.StreamEndToken)){if(token=this.get_token(),event=new events.StreamEndEvent(token.start_mark,token.end_mark),0!==this.states.length)throw new Error("assertion error, states should be empty");if(0!==this.marks.length)throw new Error("assertion error, marks should be empty");this.state=null}else{if(start_mark=this.peek_token().start_mark,_ref1=this.process_directives(),version=_ref1[0],tags=_ref1[1],!this.check_token(tokens.DocumentStartToken))throw new exports.ParserError("expected '<document start>', but found "+this.peek_token().id,this.peek_token().start_mark);token=this.get_token(),end_mark=token.end_mark,event=new events.DocumentStartEvent(start_mark,end_mark,(!0),version,tags),this.states.push("parse_document_end"),this.state="parse_document_content"}return event},Parser.prototype.parse_document_end=function(){var end_mark,event,explicit,start_mark,token;return token=this.peek_token(),start_mark=end_mark=token.start_mark,explicit=!1,this.check_token(tokens.DocumentEndToken)&&(token=this.get_token(),end_mark=token.end_mark,explicit=!0),event=new events.DocumentEndEvent(start_mark,end_mark,explicit),this.state="parse_document_start",event},Parser.prototype.parse_document_content=function(){var event;return this.check_token(tokens.DirectiveToken,tokens.DocumentStartToken,tokens.DocumentEndToken,tokens.StreamEndToken)?(event=this.process_empty_scalar(this.peek_token().start_mark),this.state=this.states.pop(),event):this.parse_block_node()},Parser.prototype.process_directives=function(){var handle,major,minor,prefix,tag_handles_copy,token,value,_ref1,_ref2,_ref3;for(this.yaml_version=null,this.tag_handles={};this.check_token(tokens.DirectiveToken);)if(token=this.get_token(),"YAML"===token.name){if(null!==this.yaml_version)throw new exports.ParserError(null,null,"found duplicate YAML directive",token.start_mark);if(_ref1=token.value,major=_ref1[0],minor=_ref1[1],1!==major||2!==minor)throw new exports.ParserError(null,null,"found incompatible YAML document (version 1.2 is required)",token.start_mark);this.yaml_version=token.value}else if("TAG"===token.name){if(_ref2=token.value,handle=_ref2[0],prefix=_ref2[1],handle in this.tag_handles)throw new exports.ParserError(null,null,"duplicate tag handle "+handle,token.start_mark);this.tag_handles[handle]=prefix}tag_handles_copy=null,_ref3=this.tag_handles;for(handle in _ref3)__hasProp.call(_ref3,handle)&&(prefix=_ref3[handle],null==tag_handles_copy&&(tag_handles_copy={}),tag_handles_copy[handle]=prefix);value=[this.yaml_version,tag_handles_copy];for(handle in DEFAULT_TAGS)__hasProp.call(DEFAULT_TAGS,handle)&&(prefix=DEFAULT_TAGS[handle],prefix in this.tag_handles||(this.tag_handles[handle]=prefix));return value},Parser.prototype.parse_block_node=function(){return this.parse_node(!0)},Parser.prototype.parse_flow_node=function(){return this.parse_node()},Parser.prototype.parse_block_node_or_indentless_sequence=function(){return this.parse_node(!0,!0)},Parser.prototype.parse_node=function(block,indentless_sequence){var anchor,end_mark,event,handle,implicit,node,start_mark,suffix,tag,tag_mark,token;if(null==block&&(block=!1),null==indentless_sequence&&(indentless_sequence=!1),this.check_token(tokens.AliasToken))token=this.get_token(),event=new events.AliasEvent(token.value,token.start_mark,token.end_mark),this.state=this.states.pop();else{if(anchor=null,tag=null,start_mark=end_mark=tag_mark=null,this.check_token(tokens.AnchorToken)?(token=this.get_token(),start_mark=token.start_mark,end_mark=token.end_mark,anchor=token.value,this.check_token(tokens.TagToken)&&(token=this.get_token(),tag_mark=token.start_mark,end_mark=token.end_mark,tag=token.value)):this.check_token(tokens.TagToken)&&(token=this.get_token(),start_mark=tag_mark=token.start_mark,end_mark=token.end_mark,tag=token.value,this.check_token(tokens.AnchorToken)&&(token=this.get_token(),end_mark=token.end_mark,anchor=token.value)),null!==tag)if(handle=tag[0],suffix=tag[1],null!==handle){if(!(handle in this.tag_handles))throw new exports.ParserError("while parsing a node",start_mark,"found undefined tag handle "+handle,tag_mark);tag=this.tag_handles[handle]+suffix}else tag=suffix;if(null===start_mark&&(start_mark=end_mark=this.peek_token().start_mark),event=null,implicit=null===tag||"!"===tag,indentless_sequence&&this.check_token(tokens.BlockEntryToken))end_mark=this.peek_token().end_mark,event=new events.SequenceStartEvent(anchor,tag,implicit,start_mark,end_mark),this.state="parse_indentless_sequence_entry";else if(this.check_token(tokens.ScalarToken))token=this.get_token(),end_mark=token.end_mark,implicit=token.plain&&null===tag||"!"===tag?[!0,!1]:null===tag?[!1,!0]:[!1,!1],event=new events.ScalarEvent(anchor,tag,implicit,token.value,start_mark,end_mark,token.style),this.state=this.states.pop();else if(this.check_token(tokens.FlowSequenceStartToken))end_mark=this.peek_token().end_mark,event=new events.SequenceStartEvent(anchor,tag,implicit,start_mark,end_mark,(!0)),this.state="parse_flow_sequence_first_entry";else if(this.check_token(tokens.FlowMappingStartToken))end_mark=this.peek_token().end_mark,event=new events.MappingStartEvent(anchor,tag,implicit,start_mark,end_mark,(!0)),this.state="parse_flow_mapping_first_key";else if(block&&this.check_token(tokens.BlockSequenceStartToken))end_mark=this.peek_token().end_mark,event=new events.SequenceStartEvent(anchor,tag,implicit,start_mark,end_mark,(!1)),this.state="parse_block_sequence_first_entry";else if(block&&this.check_token(tokens.BlockMappingStartToken))end_mark=this.peek_token().end_mark,event=new events.MappingStartEvent(anchor,tag,implicit,start_mark,end_mark,(!1)),this.state="parse_block_mapping_first_key";else{if(null===anchor&&null===tag)throw node=block?"block":"flow",token=this.peek_token(),new exports.ParserError("while parsing a "+node+" node",start_mark,"expected the node content, but found "+token.id,token.start_mark);event=new events.ScalarEvent(anchor,tag,[implicit,!1],"",start_mark,end_mark),this.state=this.states.pop()}}return event},Parser.prototype.parse_block_sequence_first_entry=function(){var token;return token=this.get_token(),this.marks.push(token.start_mark),this.parse_block_sequence_entry()},Parser.prototype.parse_block_sequence_entry=function(){var event,token;if(this.check_token(tokens.BlockEntryToken))return token=this.get_token(),this.check_token(tokens.BlockEntryToken,tokens.BlockEndToken)?(this.state="parse_block_sequence_entry",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_block_sequence_entry"),this.parse_block_node());if(!this.check_token(tokens.BlockEndToken))throw token=this.peek_token(),new exports.ParserError("while parsing a block collection",this.marks.slice(-1)[0],"expected <block end>, but found "+token.id,token.start_mark);return token=this.get_token(),event=new events.SequenceEndEvent(token.start_mark,token.end_mark),this.state=this.states.pop(),this.marks.pop(),event},Parser.prototype.parse_indentless_sequence_entry=function(){var event,token;return this.check_token(tokens.BlockEntryToken)?(token=this.get_token(),this.check_token(tokens.BlockEntryToken,tokens.KeyToken,tokens.ValueToken,tokens.BlockEndToken)?(this.state="parse_indentless_sequence_entry",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_indentless_sequence_entry"),this.parse_block_node())):(token=this.peek_token(),event=new events.SequenceEndEvent(token.start_mark,token.start_mark),this.state=this.states.pop(),event)},Parser.prototype.parse_block_mapping_first_key=function(){var token;return token=this.get_token(),this.marks.push(token.start_mark),this.parse_block_mapping_key()},Parser.prototype.parse_block_mapping_key=function(){var event,token;if(this.check_token(tokens.KeyToken))return token=this.get_token(),this.check_token(tokens.KeyToken,tokens.ValueToken,tokens.BlockEndToken)?(this.state="parse_block_mapping_value",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_block_mapping_value"),this.parse_block_node_or_indentless_sequence());if(!this.check_token(tokens.BlockEndToken))throw token=this.peek_token(),new exports.ParserError("while parsing a block mapping",this.marks.slice(-1)[0],"expected <block end>, but found "+token.id,token.start_mark);return token=this.get_token(),event=new events.MappingEndEvent(token.start_mark,token.end_mark),this.state=this.states.pop(),this.marks.pop(),event},Parser.prototype.parse_block_mapping_value=function(){var token;return this.check_token(tokens.ValueToken)?(token=this.get_token(),this.check_token(tokens.KeyToken,tokens.ValueToken,tokens.BlockEndToken)?(this.state="parse_block_mapping_key",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_block_mapping_key"),this.parse_block_node_or_indentless_sequence())):(this.state="parse_block_mapping_key",token=this.peek_token(),this.process_empty_scalar(token.start_mark))},Parser.prototype.parse_flow_sequence_first_entry=function(){var token;return token=this.get_token(),this.marks.push(token.start_mark),this.parse_flow_sequence_entry(!0)},Parser.prototype.parse_flow_sequence_entry=function(first){var event,token;if(null==first&&(first=!1),!this.check_token(tokens.FlowSequenceEndToken)){if(!first){if(!this.check_token(tokens.FlowEntryToken))throw token=this.peek_token(),new exports.ParserError("while parsing a flow sequence",this.marks.slice(-1)[0],"expected ',' or ']', but got "+token.id,token.start_mark);this.get_token()}if(this.check_token(tokens.KeyToken))return token=this.peek_token(),event=new events.MappingStartEvent(null,null,(!0),token.start_mark,token.end_mark,(!0)),this.state="parse_flow_sequence_entry_mapping_key",event;if(!this.check_token(tokens.FlowSequenceEndToken))return this.states.push("parse_flow_sequence_entry"),this.parse_flow_node()}return token=this.get_token(),event=new events.SequenceEndEvent(token.start_mark,token.end_mark),this.state=this.states.pop(),this.marks.pop(),event},Parser.prototype.parse_flow_sequence_entry_mapping_key=function(){var token;return token=this.get_token(),this.check_token(tokens.ValueToken,tokens.FlowEntryToken,tokens.FlowSequenceEndToken)?(this.state="parse_flow_sequence_entry_mapping_value",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_flow_sequence_entry_mapping_value"),this.parse_flow_node())},Parser.prototype.parse_flow_sequence_entry_mapping_value=function(){var token;return this.check_token(tokens.ValueToken)?(token=this.get_token(),this.check_token(tokens.FlowEntryToken,tokens.FlowSequenceEndToken)?(this.state="parse_flow_sequence_entry_mapping_end",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_flow_sequence_entry_mapping_end"),this.parse_flow_node())):(this.state="parse_flow_sequence_entry_mapping_end",token=this.peek_token(),this.process_empty_scalar(token.start_mark))},Parser.prototype.parse_flow_sequence_entry_mapping_end=function(){var token;return this.state="parse_flow_sequence_entry",token=this.peek_token(),new events.MappingEndEvent(token.start_mark,token.start_mark)},Parser.prototype.parse_flow_mapping_first_key=function(){var token;return token=this.get_token(),this.marks.push(token.start_mark),this.parse_flow_mapping_key(!0)},Parser.prototype.parse_flow_mapping_key=function(first){var event,token;if(null==first&&(first=!1),!this.check_token(tokens.FlowMappingEndToken)){if(!first){if(!this.check_token(tokens.FlowEntryToken))throw token=this.peek_token(),new exports.ParserError("while parsing a flow mapping",this.marks.slice(-1)[0],"expected ',' or '}', but got "+token.id,token.start_mark);this.get_token()}if(this.check_token(tokens.KeyToken))return token=this.get_token(),this.check_token(tokens.ValueToken,tokens.FlowEntryToken,tokens.FlowMappingEndToken)?(this.state="parse_flow_mapping_value",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_flow_mapping_value"),this.parse_flow_node());if(!this.check_token(tokens.FlowMappingEndToken))return this.states.push("parse_flow_mapping_empty_value"),this.parse_flow_node()}return token=this.get_token(),event=new events.MappingEndEvent(token.start_mark,token.end_mark),this.state=this.states.pop(),this.marks.pop(),event},Parser.prototype.parse_flow_mapping_value=function(){var token;return this.check_token(tokens.ValueToken)?(token=this.get_token(),this.check_token(tokens.FlowEntryToken,tokens.FlowMappingEndToken)?(this.state="parse_flow_mapping_key",this.process_empty_scalar(token.end_mark)):(this.states.push("parse_flow_mapping_key"),this.parse_flow_node())):(this.state="parse_flow_mapping_key",token=this.peek_token(),this.process_empty_scalar(token.start_mark))},Parser.prototype.parse_flow_mapping_empty_value=function(){return this.state="parse_flow_mapping_key",this.process_empty_scalar(this.peek_token().start_mark)},Parser.prototype.process_empty_scalar=function(mark){return new events.ScalarEvent(null,null,[!0,!1],"",mark,mark)},Parser}()}).call(this)},{"./errors":35,"./events":36,"./tokens":49}],41:[function(require,module,exports){(function(){var MarkedYAMLError,nodes,url,util,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};url=require("url"),MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),util=require("./util"),this.Protocols=function(){function Protocols(){this.apply_protocols=__bind(this.apply_protocols,this)}return Protocols.prototype.apply_protocols=function(node){var protocols;if(protocols=this.apply_protocols_to_root(node))return this.apply_protocols_to_resources(node,protocols)},Protocols.prototype.apply_protocols_to_root=function(node){var baseUri,parsedBaseUri,protocol,protocols;if(this.has_property(node,"protocols"))return this.get_property(node,"protocols");if(baseUri=this.property_value(node,"baseUri"))return parsedBaseUri=url.parse(baseUri),protocol=(parsedBaseUri.protocol||"http:").slice(0,-1).toUpperCase(),protocols=[new nodes.ScalarNode("tag:yaml.org,2002:str","protocols",node.start_mark,node.end_mark),new nodes.SequenceNode("tag:yaml.org,2002:seq",[new nodes.ScalarNode("tag:yaml.org,2002:str",protocol,node.start_mark,node.end_mark)],node.start_mark,node.end_mark)],node.value.push(protocols),protocols[1]},Protocols.prototype.apply_protocols_to_resources=function(node,protocols){var resource,_i,_len,_ref,_results;for(_ref=this.child_resources(node),_results=[],_i=0,_len=_ref.length;_i<_len;_i++)resource=_ref[_i],this.apply_protocols_to_resources(resource,protocols),_results.push(this.apply_protocols_to_methods(resource,protocols));return _results},Protocols.prototype.apply_protocols_to_methods=function(node,protocols){var method,_i,_len,_ref,_results;for(_ref=this.child_methods(node[1]),_results=[],_i=0,_len=_ref.length;_i<_len;_i++)method=_ref[_i],this.has_property(method[1],"protocols")?_results.push(void 0):(util.isMapping(method[1])||(method[1]=new nodes.MappingNode("tag:yaml.org,2002:map",[],method[1].start_mark,method[1].end_mark)),_results.push(method[1].value.push([new nodes.ScalarNode("tag:yaml.org,2002:str","protocols",method[0].start_mark,method[0].end_mark),protocols.clone()])));return _results},Protocols}()}).call(this)},{"./errors":35,"./nodes":39,"./util":52,url:15}],42:[function(require,module,exports){(function(){var defaultSettings,util,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};this.errors=require("./errors"),this.loader=require("./loader"),util=require("./util"),this.FileError=function(_super){function FileError(){return _ref=FileError.__super__.constructor.apply(this,arguments)}return __extends(FileError,_super),FileError}(this.errors.MarkedYAMLError),this.FileReader=function(){function FileReader(readFileAsyncOverride){this.q=require("q"),this.url=require("url"),readFileAsyncOverride&&(this.readFileAsyncOverride=readFileAsyncOverride)}return FileReader.prototype.readFileAsync=function(file){var targerUrl;if(this.readFileAsyncOverride)return this.readFileAsyncOverride(file);if(targerUrl=this.url.parse(file),null!=targerUrl.protocol){if(targerUrl.protocol.match(/^https?/i))return this.fetchFileAsync(file);throw new exports.FileError("while reading "+file,null,"unknown protocol "+targerUrl.protocol,this.start_mark)}return"undefined"!=typeof window&&null!==window?this.fetchFileAsync(file):this.fetchLocalFileAsync(file)},FileReader.prototype.fetchLocalFileAsync=function(file){var deferred,_this=this;return deferred=this.q.defer(),require("fs").readFile(file,function(err,data){return err?deferred.reject(new exports.FileError("while reading "+file,null,"cannot read "+file+" ("+err+")",_this.start_mark)):deferred.resolve(data.toString())}),deferred.promise},FileReader.prototype.fetchFileAsync=function(file){var deferred,error,xhr,_this=this;deferred=this.q.defer(),xhr="undefined"!=typeof window&&null!==window?new XMLHttpRequest:new(require("xmlhttprequest").XMLHttpRequest);try{return xhr.open("GET",file,!1),xhr.setRequestHeader("Accept","application/raml+yaml, */*"),xhr.onreadystatechange=function(){if(4===xhr.readyState)return"number"==typeof xhr.status&&200===xhr.status||"string"==typeof xhr.status&&xhr.status.match(/^200/i)?deferred.resolve(xhr.responseText):deferred.reject(new exports.FileError("while fetching "+file,null,"cannot fetch "+file+" ("+xhr.statusText+")",_this.start_mark))},xhr.send(null),deferred.promise}catch(_error){throw error=_error,new exports.FileError("while fetching "+file,null,"cannot fetch "+file+" ("+error+"), check that the server is up and that CORS is enabled",this.start_mark)}},FileReader}(),this.RamlParser=function(){function RamlParser(settings){this.settings=null!=settings?settings:defaultSettings,this.q=require("q"),this.url=require("url"),this.nodes=require("./nodes"),this.loadDefaultSettings(settings)}return RamlParser.prototype.loadDefaultSettings=function(settings){return Object.keys(defaultSettings).forEach(function(settingName){if(!(settingName in settings))return settings[settingName]=defaultSettings[settingName]})},RamlParser.prototype.loadFile=function(file,settings){var error,_this=this;null==settings&&(settings=this.settings);try{return settings.reader.readFileAsync(file).then(function(stream){return _this.load(stream,file,settings)})}catch(_error){return error=_error,this.q.fcall(function(){throw new exports.FileError("while fetching "+file,null,"cannot fetch "+file+" ("+error+")",null)})}},RamlParser.prototype.composeFile=function(file,settings,parent){var error,_this=this;null==settings&&(settings=this.settings);try{return settings.reader.readFileAsync(file).then(function(stream){return _this.compose(stream,file,settings,parent)})}catch(_error){return error=_error,this.q.fcall(function(){throw new exports.FileError("while fetching "+file,null,"cannot fetch "+file+" ("+error+")",null)})}},RamlParser.prototype.compose=function(stream,location,settings,parent){return null==settings&&(settings=this.settings),null==parent&&(parent={src:location}),settings.compose=!1,this.parseStream(stream,location,settings,parent)},RamlParser.prototype.load=function(stream,location,settings){return null==settings&&(settings=this.settings),settings.compose=!0,this.parseStream(stream,location,settings,{src:location})},RamlParser.prototype.parseStream=function(stream,location,settings,parent){var loader,_this=this;return null==settings&&(settings=this.settings),loader=new exports.loader.Loader(stream,location,settings,parent),this.q.fcall(function(){return loader.getYamlRoot()}).then(function(partialTree){var files;return files=loader.getPendingFilesList(),_this.getPendingFiles(loader,partialTree,files)}).then(function(fullyAssembledTree){return loader.composeRamlTree(fullyAssembledTree,settings),settings.compose?null!=fullyAssembledTree?loader.construct_document(fullyAssembledTree):null:fullyAssembledTree})},RamlParser.prototype.getPendingFiles=function(loader,node,files){var file,lastVisitedNode,loc,_i,_len;for(loc=[],lastVisitedNode=void 0,_i=0,_len=files.length;_i<_len;_i++)file=files[_i],loc.push(this.getPendingFile(loader,file).then(function(overwritingnode){if(overwritingnode&&!lastVisitedNode)return lastVisitedNode=overwritingnode}));return this.q.all(loc).then(function(){return lastVisitedNode?lastVisitedNode:node})},RamlParser.prototype.getPendingFile=function(loader,fileInfo){var error,event,fileUri,key,node,_this=this;if(node=fileInfo.parentNode,event=fileInfo.event,key=fileInfo.parentKey,fileUri=fileInfo.targetFileUri,fileInfo.includingContext&&(fileUri=this.url.resolve(fileInfo.includingContext,fileInfo.targetFileUri)),loader.parent&&this.isInIncludeTagsStack(fileUri,loader))throw new exports.FileError("while composing scalar out of !include",null,"detected circular !include of "+event.value,event.start_mark);try{return"fragment"===fileInfo.type?this.settings.reader.readFileAsync(fileUri).then(function(result){return _this.compose(result,fileUri,{validate:!1,transform:!1,compose:!0},loader)}).then(function(value){return _this.appendNewNodeToParent(node,key,value)})["catch"](function(error){return _this.addContextToError(error,event)}):this.settings.reader.readFileAsync(fileUri).then(function(result){var value;return value=new _this.nodes.ScalarNode("tag:yaml.org,2002:str",result,event.start_mark,event.end_mark,event.style),_this.appendNewNodeToParent(node,key,value)})["catch"](function(error){return _this.addContextToError(error,event)})}catch(_error){return error=_error,this.addContextToError(error,event)}},RamlParser.prototype.addContextToError=function(error,event){throw"FileError"===error.constructor.name?(error.problem_mark||(error.problem_mark=event.start_mark),error):new exports.FileError("while reading file",null,"error: "+error,event.start_mark)},RamlParser.prototype.isInIncludeTagsStack=function(include,parent){for(;parent=parent.parent;)if(parent.src===include)return!0;return!1},RamlParser.prototype.appendNewNodeToParent=function(node,key,value){return node?(util.isSequence(node)?node.value[key]=value:node.value.push([key,value]),null):value},RamlParser}(),defaultSettings={validate:!0,transform:!0,compose:!0,reader:new exports.FileReader(null)},this.loadFile=function(file,settings){var parser;return null==settings&&(settings=defaultSettings),parser=new exports.RamlParser(settings),parser.loadFile(file,settings)},this.composeFile=function(file,settings,parent){var parser;return null==settings&&(settings=defaultSettings),null==parent&&(parent=file),parser=new exports.RamlParser(settings),parser.composeFile(file,settings,parent)},this.compose=function(stream,location,settings,parent){var parser;return null==settings&&(settings=defaultSettings),null==parent&&(parent=location),parser=new exports.RamlParser(settings),parser.compose(stream,location,settings,parent)},this.load=function(stream,location,settings){var parser;return null==settings&&(settings=defaultSettings),parser=new exports.RamlParser(settings),parser.load(stream,location,settings,null)}}).call(this)},{"./errors":35,"./loader":38,"./nodes":39,"./util":52,fs:5,q:29,url:15,xmlhttprequest:69}],43:[function(require,module,exports){(function(){var Mark,MarkedYAMLError,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};_ref=require("./errors"),Mark=_ref.Mark,MarkedYAMLError=_ref.MarkedYAMLError,this.ReaderError=function(_super){function ReaderError(){return _ref1=ReaderError.__super__.constructor.apply(this,arguments)}return __extends(ReaderError,_super),ReaderError}(MarkedYAMLError),this.Reader=function(){function Reader(string,src){this.string=string,this.src=src,this.line=0,this.column=0,this.index=0,this.string+="\0"}var NON_PRINTABLE;return NON_PRINTABLE=/[^\x09\x0A\x0D\x20-\x7E\x85\xA0-\uD7FF\uE000-\uFFFD]/,Reader.prototype.peek=function(index){return null==index&&(index=0),this.string[this.index+index]},Reader.prototype.prefix=function(length){return null==length&&(length=1),this.string.slice(this.index,this.index+length)},Reader.prototype.forward=function(length){var char,_results;for(null==length&&(length=1),_results=[];length;)char=this.string[this.index],this.index++,__indexOf.call("\n\u2029",char)>=0||"\r"===char&&"\n"!==this.string[this.index]?(this.line++,this.column=0):(this.check_printable(char),this.column++),_results.push(length--);return _results},Reader.prototype.create_mark=function(line,column){return null==line&&(line=this.line),null==column&&(column=this.column),new Mark(this.src,line,column,this.string,this.index)},Reader.prototype.get_mark=function(){return this.create_mark()},Reader.prototype.check_printable=function(char){if(NON_PRINTABLE.exec(char))throw new exports.ReaderError("while reading file",null,"non printable characters are not allowed column: "+this.get_mark().column,this.get_mark())},Reader}()}).call(this)},{"./errors":35}],44:[function(require,module,exports){(function(){var YAMLError,nodes,util,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};nodes=require("./nodes"),util=require("./util"),YAMLError=require("./errors").YAMLError,this.ResolverError=function(_super){function ResolverError(){return _ref=ResolverError.__super__.constructor.apply(this,arguments)}return __extends(ResolverError,_super),ResolverError}(YAMLError),this.BaseResolver=function(){function BaseResolver(){this.resolver_exact_paths=[],this.resolver_prefix_paths=[]}var DEFAULT_MAPPING_TAG,DEFAULT_SCALAR_TAG,DEFAULT_SEQUENCE_TAG;return DEFAULT_SCALAR_TAG="tag:yaml.org,2002:str",DEFAULT_SEQUENCE_TAG="tag:yaml.org,2002:seq",DEFAULT_MAPPING_TAG="tag:yaml.org,2002:map",BaseResolver.prototype.yaml_implicit_resolvers={},BaseResolver.prototype.yaml_path_resolvers={},BaseResolver.add_implicit_resolver=function(tag,regexp,first){var char,_base,_i,_len,_results;for(null==first&&(first=[null]),this.prototype.hasOwnProperty("yaml_implicit_resolvers")||(this.prototype.yaml_implicit_resolvers=util.extend({},this.prototype.yaml_implicit_resolvers)),_results=[],_i=0,_len=first.length;_i<_len;_i++)char=first[_i],_results.push((null!=(_base=this.prototype.yaml_implicit_resolvers)[char]?(_base=this.prototype.yaml_implicit_resolvers)[char]:_base[char]=[]).push([tag,regexp]));return _results},BaseResolver.prototype.descend_resolver=function(current_node,current_index){var depth,exact_paths,kind,path,prefix_paths,_i,_j,_len,_len1,_ref1,_ref2,_ref3,_ref4;if(!util.is_empty(this.yaml_path_resolvers)){if(exact_paths={},prefix_paths=[],current_node)for(depth=this.resolver_prefix_paths.length,_ref1=this.resolver_prefix_paths.slice(-1)[0],_i=0,_len=_ref1.length;_i<_len;_i++)_ref2=_ref1[_i],path=_ref2[0],kind=_ref2[1],this.check_resolver_prefix(depth,path,kind,current_node,current_index)&&(path.length>depth?prefix_paths.push([path,kind]):exact_paths[kind]=this.yaml_path_resolvers[path][kind]);else for(_ref3=this.yaml_path_resolvers,_j=0,_len1=_ref3.length;_j<_len1;_j++)_ref4=_ref3[_j],path=_ref4[0],kind=_ref4[1],path?prefix_paths.push([path,kind]):exact_paths[kind]=this.yaml_path_resolvers[path][kind];return this.resolver_exact_paths.push(exact_paths),this.resolver_prefix_paths.push(prefix_paths)}},BaseResolver.prototype.ascend_resolver=function(){if(!util.is_empty(this.yaml_path_resolvers))return this.resolver_exact_paths.pop(),this.resolver_prefix_paths.pop()},BaseResolver.prototype.check_resolver_prefix=function(depth,path,kind,current_node,current_index){var index_check,node_check,_ref1;if(_ref1=path[depth-1],node_check=_ref1[0],index_check=_ref1[1],"string"==typeof node_check){if(current_node.tag!==node_check)return}else if(null!==node_check&&!(current_node instanceof node_check))return;if((index_check!==!0||null===current_index)&&(index_check!==!1&&null!==index_check||null!==current_index)){if("string"==typeof index_check){if(!(current_index instanceof nodes.ScalarNode)&&index_check===current_index.value)return}else if("number"==typeof index_check&&index_check!==current_index)return;return!0}},BaseResolver.prototype.resolve=function(kind,value,implicit){var empty,exact_paths,k,regexp,resolvers,tag,_i,_len,_ref1,_ref2,_ref3,_ref4;if(kind===nodes.ScalarNode&&implicit[0]){for(resolvers=""===value?null!=(_ref1=this.yaml_implicit_resolvers[""])?_ref1:[]:null!=(_ref2=this.yaml_implicit_resolvers[value[0]])?_ref2:[],resolvers=resolvers.concat(null!=(_ref3=this.yaml_implicit_resolvers[null])?_ref3:[]),_i=0,_len=resolvers.length;_i<_len;_i++)if(_ref4=resolvers[_i],tag=_ref4[0],regexp=_ref4[1],value.match(regexp))return tag;implicit=implicit[1]}empty=!0;for(k in this.yaml_path_resolvers)null=={}[k]&&(empty=!1);if(!empty){if(exact_paths=this.resolver_exact_paths.slice(-1)[0],__indexOf.call(exact_paths,kind)>=0)return exact_paths[kind];if(__indexOf.call(exact_paths,null)>=0)return exact_paths[null]}return kind===nodes.ScalarNode?DEFAULT_SCALAR_TAG:kind===nodes.SequenceNode?DEFAULT_SEQUENCE_TAG:kind===nodes.MappingNode?DEFAULT_MAPPING_TAG:void 0},BaseResolver}(),this.Resolver=function(_super){function Resolver(){return _ref1=Resolver.__super__.constructor.apply(this,arguments)}return __extends(Resolver,_super),Resolver}(this.BaseResolver),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:bool",/^(?:true|True|TRUE|false|False|FALSE)$/,"tTfF"),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:float",/^(?:[-+]?(?:[0-9][0-9_]*)\.[0-9_]*(?:[eE][-+][0-9]+)?|\.[0-9_]+(?:[eE][-+][0-9]+)?|[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*|[-+]?\.(?:inf|Inf|INF)|\.(?:nan|NaN|NAN))$/,"-+0123456789."),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:int",/^(?:[-+]?0b[01_]+|[-+]?0[0-7_]+|[-+]?(?:0|[1-9][0-9_]*)|[-+]?0x[0-9a-fA-F_]+|[-+]?0o[0-7_]+|[-+]?[1-9][0-9_]*(?::[0-5]?[0-9])+)$/,"-+0123456789"),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:merge",/^(?:<<)$/,"<"),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:null",/^(?:~|null|Null|NULL|)$/,["~","n","N",""]),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:timestamp",/^(?:[0-9][0-9][0-9][0-9]-[0-9][0-9]-[0-9][0-9]|[0-9][0-9][0-9][0-9]-[0-9][0-9]?-[0-9][0-9]?(?:[Tt]|[\x20\t]+)[0-9][0-9]?:[0-9][0-9]:[0-9][0-9](?:\.[0-9]*)?(?:[\x20\t]*(?:Z|[-+][0-9][0-9]?(?::[0-9][0-9])?))?)$/,"0123456789"),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:value",/^(?:=)$/,"="),this.Resolver.add_implicit_resolver("tag:yaml.org,2002:yaml",/^(?:!|&|\*)$/,"!&*");
}).call(this)},{"./errors":35,"./nodes":39,"./util":52}],45:[function(require,module,exports){(function(){var MarkedYAMLError,nodes,util,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),util=require("./util"),this.ResourceTypeError=function(_super){function ResourceTypeError(){return _ref=ResourceTypeError.__super__.constructor.apply(this,arguments)}return __extends(ResourceTypeError,_super),ResourceTypeError}(MarkedYAMLError),this.ResourceTypes=function(){function ResourceTypes(){this.apply_parameters_to_type=__bind(this.apply_parameters_to_type,this),this.apply_type=__bind(this.apply_type,this),this.apply_types=__bind(this.apply_types,this),this.get_type=__bind(this.get_type,this),this.has_types=__bind(this.has_types,this),this.load_types=__bind(this.load_types,this),this.declaredTypes={}}return ResourceTypes.prototype.load_types=function(node){var allTypes,_this=this;if(this.load_default_media_type(node),this.has_property(node,"resourceTypes")&&(allTypes=this.property_value(node,"resourceTypes"),allTypes&&"object"==typeof allTypes))return allTypes.forEach(function(type_item){if(type_item&&"object"==typeof type_item&&"object"==typeof type_item.value)return type_item.value.forEach(function(type){return _this.declaredTypes[type[0].value]=type})})},ResourceTypes.prototype.has_types=function(node){return 0===Object.keys(this.declaredTypes).length&&this.has_property(node,"resourceTypes")&&this.load_types(node),Object.keys(this.declaredTypes).length>0},ResourceTypes.prototype.get_type=function(typeName){return this.declaredTypes[typeName]},ResourceTypes.prototype.apply_types=function(node,resourceUri){var resources,_this=this;if(null==resourceUri&&(resourceUri=""),util.isMapping(node))return this.has_types(node)?(resources=this.child_resources(node),resources.forEach(function(resource){var type;return _this.apply_default_media_type_to_resource(resource[1]),_this.has_property(resource[1],"type")&&(type=_this.get_property(resource[1],"type"),_this.apply_type(resourceUri+resource[0].value,resource,type)),_this.apply_types(resource[1],resourceUri+resource[0].value)})):(resources=this.child_resources(node),resources.forEach(function(resource){return _this.apply_default_media_type_to_resource(resource[1])}))},ResourceTypes.prototype.apply_type=function(resourceUri,resource,typeKey){var tempType;return tempType=this.resolve_inheritance_chain(resourceUri,typeKey),tempType.combine(resource[1]),resource[1]=tempType,resource[1].remove_question_mark_properties()},ResourceTypes.prototype.resolve_inheritance_chain=function(resourceUri,typeKey){var baseType,childType,childTypeName,childTypeProperty,compiledTypes,inheritsFrom,parentType,parentTypeName,pathToCircularRef,result,rootType,typesToApply;for(childTypeName=this.key_or_value(typeKey),childType=this.apply_parameters_to_type(resourceUri,childTypeName,typeKey),typesToApply=[childTypeName],compiledTypes={},compiledTypes[childTypeName]=childType,this.apply_default_media_type_to_resource(childType),this.apply_traits_to_resource(resourceUri,childType,!1);this.has_property(childType,"type");){if(typeKey=this.get_property(childType,"type"),parentTypeName=this.key_or_value(typeKey),parentTypeName in compiledTypes)throw pathToCircularRef=typesToApply.concat(parentTypeName).join(" -> "),childTypeProperty=this.get_type(childTypeName)[0],new exports.ResourceTypeError("while applying resourceTypes",null,'circular reference of "'+parentTypeName+'" has been detected: '+pathToCircularRef,childTypeProperty.start_mark);parentType=this.apply_parameters_to_type(resourceUri,parentTypeName,typeKey),this.apply_default_media_type_to_resource(parentType),this.apply_traits_to_resource(resourceUri,parentType,!1),childTypeName=parentTypeName,childType=parentType,compiledTypes[childTypeName]=childType,typesToApply.push(childTypeName)}for(rootType=typesToApply.pop(),baseType=compiledTypes[rootType].cloneForResourceType(),result=baseType;inheritsFrom=typesToApply.pop();)baseType=compiledTypes[inheritsFrom].cloneForResourceType(),result.combine(baseType);return result},ResourceTypes.prototype.apply_parameters_to_type=function(resourceUri,typeName,typeKey){var parameters,type;if(!(null!=typeName?typeName.trim():void 0))throw new exports.ResourceTypeError("while applying resource type",null,"resource type name must be provided",typeKey.start_mark);if(!(type=this.get_type(typeName)))throw new exports.ResourceTypeError("while applying resource type",null,"there is no resource type named "+typeName,typeKey.start_mark);return type=type[1].clone(),parameters=this._get_parameters_from_type_key(resourceUri,typeKey),this.apply_parameters(type,parameters,typeKey),type},ResourceTypes.prototype._get_parameters_from_type_key=function(resourceUri,typeKey){var parameter,parameters,reserved,result,_i,_len,_ref1;if(result={},reserved={resourcePath:resourceUri.replace(/\/\/*/g,"/"),resourcePathName:this.extractResourcePathName(resourceUri)},util.isMapping(typeKey)&&(parameters=this.value_or_undefined(typeKey),util.isMapping(parameters[0][1])))for(_ref1=parameters[0][1].value,_i=0,_len=_ref1.length;_i<_len;_i++){if(parameter=_ref1[_i],parameter[0].value in reserved)throw new exports.ResourceTypeError("while applying parameters",null,"invalid parameter name: "+parameter[0].value+" is reserved",parameter[0].start_mark);result[parameter[0].value]=parameter[1].value}return util.extend(result,reserved)},ResourceTypes}()}).call(this)},{"./errors":35,"./nodes":39,"./util":52}],46:[function(require,module,exports){(function(){var MarkedYAMLError,SimpleKey,tokens,util,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};MarkedYAMLError=require("./errors").MarkedYAMLError,tokens=require("./tokens"),util=require("./util"),this.ScannerError=function(_super){function ScannerError(){return _ref=ScannerError.__super__.constructor.apply(this,arguments)}return __extends(ScannerError,_super),ScannerError}(MarkedYAMLError),SimpleKey=function(){function SimpleKey(token_number,required,index,line,column,mark){this.token_number=token_number,this.required=required,this.index=index,this.line=line,this.column=column,this.mark=mark}return SimpleKey}(),this.Scanner=function(){function Scanner(settings){this.settings=settings,this.done=!1,this.ramlHeaderFound=!this.settings.validate,this.flow_level=0,this.tokens=[],this.fetch_stream_start(),this.tokens_taken=0,this.indent=-1,this.indents=[],this.allow_simple_key=!0,this.possible_simple_keys={}}var C_LB,C_NUMBERS,C_WS,ESCAPE_CODES,ESCAPE_REPLACEMENTS,RAML_VERSION,RAML_VERSION_RE;return C_LB="\r\n\u2028\u2029",C_WS="\t ",C_NUMBERS="0123456789",ESCAPE_REPLACEMENTS={0:"\0",a:"",b:"\b",t:"\t","\t":"\t",n:"\n",v:"\x0B",f:"\f",r:"\r",e:""," ":" ",'"':'"',"\\":"\\",N:"",_:"",L:"\u2028",P:"\u2029"},ESCAPE_CODES={x:2,u:4,U:8},RAML_VERSION="#%RAML 0.8",RAML_VERSION_RE=/^#%RAML .+$/,Scanner.prototype.check_token=function(){var choice,choices,_i,_len;for(choices=1<=arguments.length?__slice.call(arguments,0):[];this.need_more_tokens();)this.fetch_more_tokens();if(0!==this.tokens.length){if(0===choices.length)return!0;for(_i=0,_len=choices.length;_i<_len;_i++)if(choice=choices[_i],this.tokens[0]instanceof choice)return!0}return!1},Scanner.prototype.peek_token=function(){for(;this.need_more_tokens();)this.fetch_more_tokens();if(0!==this.tokens.length)return this.tokens[0]},Scanner.prototype.get_token=function(){for(;this.need_more_tokens();)this.fetch_more_tokens();if(0!==this.tokens.length)return this.tokens_taken++,this.tokens.shift()},Scanner.prototype.need_more_tokens=function(){return!this.done&&(0===this.tokens.length||(this.stale_possible_simple_keys(),this.next_possible_simple_key()===this.tokens_taken))},Scanner.prototype.fetch_more_tokens=function(){var char;if(this.scan_to_next_token(),this.stale_possible_simple_keys(),this.unwind_indent(this.column),char=this.peek(),"\0"===char)return this.fetch_stream_end();if("%"===char&&this.check_directive())return this.fetch_directive();if("-"===char&&this.check_document_start())return this.fetch_document_start();if("."===char&&this.check_document_end())return this.fetch_document_end();if("["===char)return this.fetch_flow_sequence_start();if("{"===char)return this.fetch_flow_mapping_start();if("]"===char)return this.fetch_flow_sequence_end();if("}"===char)return this.fetch_flow_mapping_end();if(","===char)return this.fetch_flow_entry();if("-"===char&&this.check_block_entry())return this.fetch_block_entry();if("?"===char&&this.check_key())return this.fetch_key();if(":"===char&&this.check_value())return this.fetch_value();if("*"===char)return this.fetch_alias();if("&"===char)return this.fetch_anchor();if("!"===char)return this.fetch_tag();if("|"===char&&0===this.flow_level)return this.fetch_literal();if(">"===char&&0===this.flow_level)return this.fetch_folded();if("'"===char)return this.fetch_single();if('"'===char)return this.fetch_double();if(this.check_plain())return this.fetch_plain();throw new exports.ScannerError("while scanning for the next token",null,"found character "+char+" that cannot start any token",this.get_mark())},Scanner.prototype.next_possible_simple_key=function(){var key,level,min_token_number,_ref1;min_token_number=null,_ref1=this.possible_simple_keys;for(level in _ref1)__hasProp.call(_ref1,level)&&(key=_ref1[level],(null===min_token_number||key.token_number<min_token_number)&&(min_token_number=key.token_number));return min_token_number},Scanner.prototype.stale_possible_simple_keys=function(){var key,level,_ref1,_results;_ref1=this.possible_simple_keys,_results=[];for(level in _ref1)if(__hasProp.call(_ref1,level)&&(key=_ref1[level],!(key.line===this.line&&this.index-key.index<=1024))){if(key.required)throw new exports.ScannerError("while scanning a simple key",key.mark,"could not find expected ':'",this.get_mark());_results.push(delete this.possible_simple_keys[level])}return _results},Scanner.prototype.save_possible_simple_key=function(){var required,token_number;if(required=0===this.flow_level&&this.indent===this.column,required&&!this.allow_simple_key)throw new Error("logic failure");if(this.allow_simple_key)return this.remove_possible_simple_key(),token_number=this.tokens_taken+this.tokens.length,this.possible_simple_keys[this.flow_level]=new SimpleKey(token_number,required,this.index,this.line,this.column,this.get_mark())},Scanner.prototype.remove_possible_simple_key=function(){var key;if(key=this.possible_simple_keys[this.flow_level]){if(key.required)throw new exports.ScannerError("while scanning a simple key",key.mark,"could not find expected ':'",this.get_mark());return delete this.possible_simple_keys[this.flow_level]}},Scanner.prototype.unwind_indent=function(column){var mark,_results;if(0===this.flow_level){for(_results=[];this.indent>column;)mark=this.get_mark(),this.indent=this.indents.pop(),_results.push(this.tokens.push(new tokens.BlockEndToken(mark,mark)));return _results}},Scanner.prototype.add_indent=function(column){return column>this.indent&&(this.indents.push(this.indent),this.indent=column,!0)},Scanner.prototype.fetch_stream_start=function(){var mark;return mark=this.get_mark(),this.tokens.push(new tokens.StreamStartToken(mark,mark,this.encoding))},Scanner.prototype.fetch_stream_end=function(){var mark;return this.unwind_indent(-1),this.remove_possible_simple_key(),this.allow_possible_simple_key=!1,this.possible_simple_keys={},mark=this.get_mark(),this.tokens.push(new tokens.StreamEndToken(mark,mark)),this.done=!0},Scanner.prototype.fetch_directive=function(){return this.unwind_indent(-1),this.remove_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_directive())},Scanner.prototype.fetch_document_start=function(){return this.fetch_document_indicator(tokens.DocumentStartToken)},Scanner.prototype.fetch_document_end=function(){return this.fetch_document_indicator(tokens.DocumentEndToken)},Scanner.prototype.fetch_document_indicator=function(TokenClass){var start_mark;return this.unwind_indent(-1),this.remove_possible_simple_key(),this.allow_simple_key=!1,start_mark=this.get_mark(),this.forward(3),this.tokens.push(new TokenClass(start_mark,this.get_mark()))},Scanner.prototype.fetch_flow_sequence_start=function(){return this.fetch_flow_collection_start(tokens.FlowSequenceStartToken)},Scanner.prototype.fetch_flow_mapping_start=function(){return this.fetch_flow_collection_start(tokens.FlowMappingStartToken)},Scanner.prototype.fetch_flow_collection_start=function(TokenClass){var start_mark;return this.save_possible_simple_key(),this.flow_level++,this.allow_simple_key=!0,start_mark=this.get_mark(),this.forward(),this.tokens.push(new TokenClass(start_mark,this.get_mark()))},Scanner.prototype.fetch_flow_sequence_end=function(){return this.fetch_flow_collection_end(tokens.FlowSequenceEndToken)},Scanner.prototype.fetch_flow_mapping_end=function(){return this.fetch_flow_collection_end(tokens.FlowMappingEndToken)},Scanner.prototype.fetch_flow_collection_end=function(TokenClass){var start_mark;return this.remove_possible_simple_key(),this.flow_level--,this.allow_simple_key=!1,start_mark=this.get_mark(),this.forward(),this.tokens.push(new TokenClass(start_mark,this.get_mark()))},Scanner.prototype.fetch_flow_entry=function(){var start_mark;return this.allow_simple_key=!0,this.remove_possible_simple_key(),start_mark=this.get_mark(),this.forward(),this.tokens.push(new tokens.FlowEntryToken(start_mark,this.get_mark()))},Scanner.prototype.fetch_block_entry=function(){var mark,start_mark;if(0===this.flow_level){if(!this.allow_simple_key)throw new exports.ScannerError(null,null,"sequence entries are not allowed here",this.get_mark());this.add_indent(this.column)&&(mark=this.get_mark(),this.tokens.push(new tokens.BlockSequenceStartToken(mark,mark)))}return this.allow_simple_key=!0,this.remove_possible_simple_key(),start_mark=this.get_mark(),this.forward(),this.tokens.push(new tokens.BlockEntryToken(start_mark,this.get_mark()))},Scanner.prototype.fetch_key=function(){var mark,start_mark;if(0===this.flow_level){if(!this.allow_simple_key)throw new exports.ScannerError(null,null,"mapping keys are not allowed here",this.get_mark());this.add_indent(this.column)&&(mark=this.get_mark(),this.tokens.push(new tokens.BlockMappingStartToken(mark,mark)))}return this.allow_simple_key=!this.flow_level,this.remove_possible_simple_key(),start_mark=this.get_mark(),this.forward(),this.tokens.push(new tokens.KeyToken(start_mark,this.get_mark()))},Scanner.prototype.fetch_value=function(){var key,mark,start_mark;if(key=this.possible_simple_keys[this.flow_level])delete this.possible_simple_keys[this.flow_level],this.tokens.splice(key.token_number-this.tokens_taken,0,new tokens.KeyToken(key.mark,key.mark)),0===this.flow_level&&this.add_indent(key.column)&&this.tokens.splice(key.token_number-this.tokens_taken,0,new tokens.BlockMappingStartToken(key.mark,key.mark)),this.allow_simple_key=!1;else{if(0===this.flow_level){if(!this.allow_simple_key)throw new exports.ScannerError(null,null,"mapping values are not allowed here",this.get_mark());this.add_indent(this.column)&&(mark=this.get_mark(),this.tokens.push(new tokens.BlockMappingStartToken(mark,mark)))}this.allow_simple_key=!this.flow_level,this.remove_possible_simple_key()}return start_mark=this.get_mark(),this.forward(),this.tokens.push(new tokens.ValueToken(start_mark,this.get_mark()))},Scanner.prototype.fetch_alias=function(){return this.save_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_anchor(tokens.AliasToken))},Scanner.prototype.fetch_anchor=function(){return this.save_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_anchor(tokens.AnchorToken))},Scanner.prototype.fetch_tag=function(){return this.save_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_tag())},Scanner.prototype.fetch_literal=function(){return this.fetch_block_scalar("|")},Scanner.prototype.fetch_folded=function(){return this.fetch_block_scalar(">")},Scanner.prototype.fetch_block_scalar=function(style){return this.allow_simple_key=!0,this.remove_possible_simple_key(),this.tokens.push(this.scan_block_scalar(style))},Scanner.prototype.fetch_single=function(){return this.fetch_flow_scalar("'")},Scanner.prototype.fetch_double=function(){return this.fetch_flow_scalar('"')},Scanner.prototype.fetch_flow_scalar=function(style){return this.save_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_flow_scalar(style))},Scanner.prototype.fetch_plain=function(){return this.save_possible_simple_key(),this.allow_simple_key=!1,this.tokens.push(this.scan_plain())},Scanner.prototype.check_directive=function(){return 0===this.column},Scanner.prototype.check_document_start=function(){var _ref1;return 0===this.column&&"---"===this.prefix(3)&&(_ref1=this.peek(3),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0)},Scanner.prototype.check_document_end=function(){var _ref1;return 0===this.column&&"..."===this.prefix(3)&&(_ref1=this.peek(3),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0)},Scanner.prototype.check_block_entry=function(){var _ref1;return _ref1=this.peek(1),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0},Scanner.prototype.check_key=function(){var _ref1;return 0!==this.flow_level||(_ref1=this.peek(1),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0)},Scanner.prototype.check_value=function(){var _ref1;return 0!==this.flow_level||(_ref1=this.peek(1),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0)},Scanner.prototype.check_plain=function(){var char,_ref1;return char=this.peek(),__indexOf.call(C_LB+C_WS+"\0-?:,[]{}#&*!|>'\"%@`",char)<0||(_ref1=this.peek(1),__indexOf.call(C_LB+C_WS+"\0",_ref1)<0&&("-"===char||0===this.flow_level&&__indexOf.call("?:",char)>=0))},Scanner.prototype.scan_to_next_token=function(){var comment,found,trimmedComment,_ref1,_results;for(0===this.index&&"\ufeff"===this.peek()&&this.forward(),found=!1,_results=[];!found;){for(;" "===this.peek();)this.forward();if(comment="","#"===this.peek())for(;_ref1=this.peek(),__indexOf.call(C_LB+"\0",_ref1)<0;)this.ramlHeaderFound||(comment+=this.peek()),this.forward();if(!this.ramlHeaderFound){if(trimmedComment=comment.trim(),!trimmedComment||!RAML_VERSION_RE.test(trimmedComment))throw new exports.ScannerError("version validation",null,"The first line must be: '"+RAML_VERSION+"'",this.create_mark(0,0));if(trimmedComment!==RAML_VERSION)throw new exports.ScannerError("version validation",null,"Unsupported RAML version: '"+comment+"'",this.create_mark(0,0));this.ramlHeaderFound=!0}this.scan_line_break()?0===this.flow_level?_results.push(this.allow_simple_key=!0):_results.push(void 0):_results.push(found=!0)}return _results},Scanner.prototype.scan_directive=function(){var end_mark,name,start_mark,value,_ref1;if(start_mark=this.get_mark(),this.forward(),name=this.scan_directive_name(start_mark),value=null,"YAML"===name)value=this.scan_yaml_directive_value(start_mark),end_mark=this.get_mark();else if("TAG"===name)value=this.scan_tag_directive_value(start_mark),end_mark=this.get_mark();else for(end_mark=this.get_mark();_ref1=this.peek(),__indexOf.call(C_LB+"\0",_ref1)<0;)this.forward();return this.scan_directive_ignored_line(start_mark),new tokens.DirectiveToken(name,value,start_mark,end_mark)},Scanner.prototype.scan_directive_name=function(start_mark){var char,length,value;for(length=0,char=this.peek(length);"0"<=char&&char<="9"||"A"<=char&&char<="Z"||"a"<=char&&char<="z"||__indexOf.call("-_",char)>=0;)length++,char=this.peek(length);if(0===length)throw new exports.ScannerError("while scanning a directive",start_mark,"expected alphanumeric or numeric character but found "+char,this.get_mark());if(value=this.prefix(length),this.forward(length),char=this.peek(),__indexOf.call(C_LB+"\0 ",char)<0)throw new exports.ScannerError("while scanning a directive",start_mark,"expected alphanumeric or numeric character but found "+char,this.get_mark());return value},Scanner.prototype.scan_yaml_directive_value=function(start_mark){for(var major,minor,_ref1;" "===this.peek();)this.forward();if(major=this.scan_yaml_directive_number(start_mark),"."!==this.peek())throw new exports.ScannerError("while scanning a directive",start_mark,"expected a digit or '.' but found "+this.peek(),this.get_mark());if(this.forward(),minor=this.scan_yaml_directive_number(start_mark),_ref1=this.peek(),__indexOf.call(C_LB+"\0 ",_ref1)<0)throw new exports.ScannerError("while scanning a directive",start_mark,"expected a digit or ' ' but found "+this.peek(),this.get_mark());return[major,minor]},Scanner.prototype.scan_yaml_directive_number=function(start_mark){var char,length,value,_ref1;if(char=this.peek(),!("0"<=char&&char<="9"))throw new exports.ScannerError("while scanning a directive",start_mark,"expected a digit but found "+char,this.get_mark());for(length=0;"0"<=(_ref1=this.peek(length))&&_ref1<="9";)length++;return value=parseInt(this.prefix(length)),this.forward(length),value},Scanner.prototype.scan_tag_directive_value=function(start_mark){for(var handle,prefix;" "===this.peek();)this.forward();for(handle=this.scan_tag_directive_handle(start_mark);" "===this.peek();)this.forward();return prefix=this.scan_tag_directive_prefix(start_mark),[handle,prefix]},Scanner.prototype.scan_tag_directive_handle=function(start_mark){var char,value;if(value=this.scan_tag_handle("directive",start_mark),char=this.peek()," "!==char)throw new exports.ScannerError("while scanning a directive",start_mark,"expected ' ' but found "+char,this.get_mark());return value},Scanner.prototype.scan_tag_directive_prefix=function(start_mark){var char,value;if(value=this.scan_tag_uri("directive",start_mark),char=this.peek(),__indexOf.call(C_LB+"\0 ",char)<0)throw new exports.ScannerError("while scanning a directive",start_mark,"expected ' ' but found "+char,this.get_mark());return value},Scanner.prototype.scan_directive_ignored_line=function(start_mark){for(var char,_ref1;" "===this.peek();)this.forward();if("#"===this.peek())for(;_ref1=this.peek(),__indexOf.call(C_LB+"\0",_ref1)<0;)this.forward();if(char=this.peek(),__indexOf.call(C_LB+"\0",char)<0)throw new exports.ScannerError("while scanning a directive",start_mark,"expected a comment or a line break but found "+char,this.get_mark());return this.scan_line_break()},Scanner.prototype.scan_anchor=function(TokenClass){var char,indicator,length,name,start_mark,value;for(start_mark=this.get_mark(),indicator=this.peek(),name="*"===indicator?"alias":"anchor",this.forward(),length=0,char=this.peek(length);"0"<=char&&char<="9"||"A"<=char&&char<="Z"||"a"<=char&&char<="z"||__indexOf.call("-_",char)>=0;)length++,char=this.peek(length);if(0===length)throw new exports.ScannerError("while scanning an "+name,start_mark,"expected alphabetic or numeric character but found '"+char+"'",this.get_mark());if(value=this.prefix(length),this.forward(length),char=this.peek(),__indexOf.call(C_LB+C_WS+"\0?:,]}%@`",char)<0)throw new exports.ScannerError("while scanning an "+name,start_mark,"expected alphabetic or numeric character but found '"+char+"'",this.get_mark());return new TokenClass(value,start_mark,this.get_mark())},Scanner.prototype.scan_tag=function(){var char,handle,length,start_mark,suffix,use_handle;if(start_mark=this.get_mark(),char=this.peek(1),"<"===char){if(handle=null,this.forward(2),suffix=this.scan_tag_uri("tag",start_mark),">"!==this.peek())throw new exports.ScannerError("while parsing a tag",start_mark,"expected '>' but found "+this.peek(),this.get_mark());this.forward()}else if(__indexOf.call(C_LB+C_WS+"\0",char)>=0)handle=null,suffix="!",this.forward();else{for(length=1,use_handle=!1;__indexOf.call(C_LB+"\0 ",char)<0;){if("!"===char){use_handle=!0;break}length++,char=this.peek(length)}use_handle?handle=this.scan_tag_handle("tag",start_mark):(handle="!",this.forward()),suffix=this.scan_tag_uri("tag",start_mark)}if(char=this.peek(),__indexOf.call(C_LB+"\0 ",char)<0)throw new exports.ScannerError("while scanning a tag",start_mark,"expected ' ' but found "+char,this.get_mark());return new tokens.TagToken([handle,suffix],start_mark,this.get_mark())},Scanner.prototype.scan_block_scalar=function(style){var breaks,chomping,chunks,end_mark,folded,increment,indent,leading_non_space,length,line_break,max_indent,min_indent,start_mark,_ref1,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7;for(folded=">"===style,chunks=[],start_mark=this.get_mark(),this.forward(),_ref1=this.scan_block_scalar_indicators(start_mark),chomping=_ref1[0],increment=_ref1[1],this.scan_block_scalar_ignored_line(start_mark),min_indent=this.indent+1,min_indent<1&&(min_indent=1),null==increment?(_ref2=this.scan_block_scalar_indentation(),breaks=_ref2[0],max_indent=_ref2[1],end_mark=_ref2[2],indent=Math.max(min_indent,max_indent)):(indent=min_indent+increment-1,_ref3=this.scan_block_scalar_breaks(indent),breaks=_ref3[0],end_mark=_ref3[1]),line_break="";this.column===indent&&"\0"!==this.peek();){for(chunks=chunks.concat(breaks),_ref4=this.peek(),leading_non_space=__indexOf.call(" \t",_ref4)<0,length=0;_ref5=this.peek(length),__indexOf.call(C_LB+"\0",_ref5)<0;)length++;if(chunks.push(this.prefix(length)),this.forward(length),line_break=this.scan_line_break(),_ref6=this.scan_block_scalar_breaks(indent),breaks=_ref6[0],end_mark=_ref6[1],this.column!==indent||"\0"===this.peek())break;folded&&"\n"===line_break&&leading_non_space&&(_ref7=this.peek(),__indexOf.call(" \t",_ref7)<0)?util.is_empty(breaks)&&chunks.push(" "):chunks.push(line_break)}return chomping!==!1&&chunks.push(line_break),chomping===!0&&(chunks=chunks.concat(breaks)),new tokens.ScalarToken(chunks.join(""),(!1),start_mark,end_mark,style)},Scanner.prototype.scan_block_scalar_indicators=function(start_mark){var char,chomping,increment;if(chomping=null,increment=null,char=this.peek(),__indexOf.call("+-",char)>=0){if(chomping="+"===char,this.forward(),char=this.peek(),__indexOf.call(C_NUMBERS,char)>=0){if(increment=parseInt(char),0===increment)throw new exports.ScannerError("while scanning a block scalar",start_mark,"expected indentation indicator in the range 1-9 but found 0",this.get_mark());this.forward()}}else if(__indexOf.call(C_NUMBERS,char)>=0){if(increment=parseInt(char),0===increment)throw new exports.ScannerError("while scanning a block scalar",start_mark,"expected indentation indicator in the range 1-9 but found 0",this.get_mark());this.forward(),char=this.peek(),__indexOf.call("+-",char)>=0&&(chomping="+"===char,this.forward())}if(char=this.peek(),__indexOf.call(C_LB+"\0 ",char)<0)throw new exports.ScannerError("while scanning a block scalar",start_mark,"expected chomping or indentation indicators, but found "+char,this.get_mark());return[chomping,increment]},Scanner.prototype.scan_block_scalar_ignored_line=function(start_mark){for(var char,_ref1;" "===this.peek();)this.forward();if("#"===this.peek())for(;_ref1=this.peek(),__indexOf.call(C_LB+"\0",_ref1)<0;)this.forward();if(char=this.peek(),__indexOf.call(C_LB+"\0",char)<0)throw new exports.ScannerError("while scanning a block scalar",start_mark,"expected a comment or a line break but found "+char,this.get_mark());return this.scan_line_break()},Scanner.prototype.scan_block_scalar_indentation=function(){var chunks,end_mark,max_indent,_ref1;for(chunks=[],max_indent=0,end_mark=this.get_mark();_ref1=this.peek(),__indexOf.call(C_LB+" ",_ref1)>=0;)" "!==this.peek()?(chunks.push(this.scan_line_break()),end_mark=this.get_mark()):(this.forward(),this.column>max_indent&&(max_indent=this.column));return[chunks,max_indent,end_mark]},Scanner.prototype.scan_block_scalar_breaks=function(indent){var chunks,end_mark,_ref1;for(chunks=[],end_mark=this.get_mark();this.column<indent&&" "===this.peek();)this.forward();for(;_ref1=this.peek(),__indexOf.call(C_LB,_ref1)>=0;)for(chunks.push(this.scan_line_break()),end_mark=this.get_mark();this.column<indent&&" "===this.peek();)this.forward();return[chunks,end_mark]},Scanner.prototype.scan_flow_scalar=function(style){var chunks,double,quote,start_mark;for(double='"'===style,chunks=[],start_mark=this.get_mark(),quote=this.peek(),this.forward(),chunks=chunks.concat(this.scan_flow_scalar_non_spaces(double,start_mark));this.peek()!==quote;)chunks=chunks.concat(this.scan_flow_scalar_spaces(double,start_mark)),chunks=chunks.concat(this.scan_flow_scalar_non_spaces(double,start_mark));return this.forward(),new tokens.ScalarToken(chunks.join(""),(!1),start_mark,this.get_mark(),style)},Scanner.prototype.scan_flow_scalar_non_spaces=function(double,start_mark){var char,chunks,code,k,length,_i,_ref1,_ref2;for(chunks=[];;){for(length=0;_ref1=this.peek(length),__indexOf.call(C_LB+C_WS+"'\"\\\0",_ref1)<0;)length++;if(0!==length&&(chunks.push(this.prefix(length)),this.forward(length)),char=this.peek(),double||"'"!==char||"'"!==this.peek(1))if(double&&"'"===char||!double&&__indexOf.call('"\\',char)>=0)chunks.push(char),this.forward();else{if(!double||"\\"!==char)return chunks;if(this.forward(),char=this.peek(),char in ESCAPE_REPLACEMENTS)chunks.push(ESCAPE_REPLACEMENTS[char]),this.forward();else if(char in ESCAPE_CODES){for(length=ESCAPE_CODES[char],this.forward(),k=_i=0;0<=length?_i<length:_i>length;k=0<=length?++_i:--_i)if(_ref2=this.peek(k),__indexOf.call(C_NUMBERS+"ABCDEFabcdef",_ref2)<0)throw new exports.ScannerError("while scanning a double-quoted scalar",start_mark,"expected escape sequence of "+length+" hexadecimal numbers, but found "+this.peek(k),this.get_mark());code=parseInt(this.prefix(length),16),chunks.push(String.fromCharCode(code)),this.forward(length)}else{if(!(__indexOf.call(C_LB,char)>=0))throw new exports.ScannerError("while scanning a double-quoted scalar",start_mark,"found unknown escape character "+char,this.get_mark());this.scan_line_break(),chunks=chunks.concat(this.scan_flow_scalar_breaks(double,start_mark))}}else chunks.push("'"),this.forward(2)}},Scanner.prototype.scan_flow_scalar_spaces=function(double,start_mark){var breaks,char,chunks,length,line_break,whitespaces,_ref1;for(chunks=[],length=0;_ref1=this.peek(length),__indexOf.call(C_WS,_ref1)>=0;)length++;if(whitespaces=this.prefix(length),this.forward(length),char=this.peek(),"\0"===char)throw new exports.ScannerError("while scanning a quoted scalar",start_mark,"found unexpected end of stream",this.get_mark());return __indexOf.call(C_LB,char)>=0?(line_break=this.scan_line_break(),breaks=this.scan_flow_scalar_breaks(double,start_mark),"\n"!==line_break?chunks.push(line_break):breaks||chunks.push(" "),chunks=chunks.concat(breaks)):chunks.push(whitespaces),chunks},Scanner.prototype.scan_flow_scalar_breaks=function(double,start_mark){var chunks,prefix,_ref1,_ref2,_ref3;for(chunks=[];;){if(prefix=this.prefix(3),"---"===prefix||"..."===prefix&&(_ref1=this.peek(3),__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0))throw new exports.ScannerError("while scanning a quoted scalar",start_mark,"found unexpected document separator",this.get_mark());for(;_ref2=this.peek(),__indexOf.call(C_WS,_ref2)>=0;)this.forward();if(_ref3=this.peek(),!(__indexOf.call(C_LB,_ref3)>=0))return chunks;chunks.push(this.scan_line_break())}},Scanner.prototype.scan_plain=function(){var char,chunks,end_mark,indent,length,spaces,start_mark,_ref1,_ref2;for(chunks=[],start_mark=end_mark=this.get_mark(),indent=this.indent+1,spaces=[];;){if(length=0,"#"===this.peek())break;for(;;){if(char=this.peek(length),__indexOf.call(C_LB+C_WS+"\0",char)>=0||0===this.flow_level&&":"===char&&(_ref1=this.peek(length+1),
__indexOf.call(C_LB+C_WS+"\0",_ref1)>=0)||0!==this.flow_level&&__indexOf.call(",:?[]{}",char)>=0)break;length++}if(0!==this.flow_level&&":"===char&&(_ref2=this.peek(length+1),__indexOf.call(C_LB+C_WS+"\0,[]{}",_ref2)<0))throw this.forward(length),new exports.ScannerError("while scanning a plain scalar",start_mark,"found unexpected ':'",this.get_mark(),"Please check http://pyyaml.org/wiki/YAMLColonInFlowContext");if(0===length)break;if(this.allow_simple_key=!1,chunks=chunks.concat(spaces),chunks.push(this.prefix(length)),this.forward(length),end_mark=this.get_mark(),spaces=this.scan_plain_spaces(indent,start_mark),null==spaces||0===spaces.length||"#"===this.peek()||0===this.flow_level&&this.column<indent)break}return new tokens.ScalarToken(chunks.join(""),(!0),start_mark,end_mark)},Scanner.prototype.scan_plain_spaces=function(indent,start_mark){var breaks,char,chunks,length,line_break,prefix,whitespaces,_ref1,_ref2;for(chunks=[],length=0;_ref1=this.peek(length),__indexOf.call(" ",_ref1)>=0;)length++;if(whitespaces=this.prefix(length),this.forward(length),char=this.peek(),__indexOf.call(C_LB,char)>=0){if(line_break=this.scan_line_break(),this.allow_simple_key=!0,prefix=this.prefix(3),"---"===prefix||"..."===prefix&&this.peek(__indexOf.call(C_LB+C_WS+"\0",3)>=0))return;for(breaks=[];_ref2=this.peek(),__indexOf.call(C_LB+" ",_ref2)>=0;)if(" "===this.peek())this.forward();else if(breaks.push(this.scan_line_break()),prefix=this.prefix(3),"---"===prefix||"..."===prefix&&this.peek(__indexOf.call(C_LB+C_WS+"\0",3)>=0))return;"\n"!==line_break?chunks.push(line_break):0===breaks.length&&chunks.push(" "),chunks=chunks.concat(breaks)}else whitespaces&&chunks.push(whitespaces);return chunks},Scanner.prototype.scan_tag_handle=function(name,start_mark){var char,length,value;if(char=this.peek(),"!"!==char)throw new exports.ScannerError("while scanning a "+name,start_mark,"expected '!' but found "+char,this.get_mark());if(length=1,char=this.peek(length)," "!==char){for(;"0"<=char&&char<="9"||"A"<=char&&char<="Z"||"a"<=char&&char<="z"||__indexOf.call("-_",char)>=0;)length++,char=this.peek(length);if("!"!==char)throw this.forward(length),new exports.ScannerError("while scanning a "+name,start_mark,"expected '!' but found "+char,this.get_mark());length++}return value=this.prefix(length),this.forward(length),value},Scanner.prototype.scan_tag_uri=function(name,start_mark){var char,chunks,length;for(chunks=[],length=0,char=this.peek(length);"0"<=char&&char<="9"||"A"<=char&&char<="Z"||"a"<=char&&char<="z"||__indexOf.call("-;/?:@&=+$,_.!~*'()[]%",char)>=0;)"%"===char?(chunks.push(this.prefix(length)),this.forward(length),length=0,chunks.push(this.scan_uri_escapes(name,start_mark))):length++,char=this.peek(length);if(0!==length&&(chunks.push(this.prefix(length)),this.forward(length),length=0),0===chunks.length)throw new exports.ScannerError("while parsing a "+name,start_mark,"expected URI but found "+char,this.get_mark());return chunks.join("")},Scanner.prototype.scan_uri_escapes=function(name,start_mark){var bytes,k,mark,_i;for(bytes=[],mark=this.get_mark();"%"===this.peek();){for(this.forward(),k=_i=0;_i<=2;k=++_i)throw new exports.ScannerError("while scanning a "+name,start_mark,"expected URI escape sequence of 2 hexadecimal numbers but found          "+this.peek(k),this.get_mark());bytes.push(String.fromCharCode(parseInt(this.prefix(2),16))),this.forward(2)}return bytes.join("")},Scanner.prototype.scan_line_break=function(){var char;return char=this.peek(),__indexOf.call("\r\n",char)>=0?("\r\n"===this.prefix(2)?this.forward(2):this.forward(),"\n"):__indexOf.call("\u2028\u2029",char)>=0?(this.forward(),char):""},Scanner}()}).call(this)},{"./errors":35,"./tokens":49,"./util":52}],47:[function(require,module,exports){(function(){var MarkedYAMLError,nodes,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),this.SchemaError=function(_super){function SchemaError(){return _ref=SchemaError.__super__.constructor.apply(this,arguments)}return __extends(SchemaError,_super),SchemaError}(MarkedYAMLError),this.Schemas=function(){function Schemas(){this.get_schemas_used=__bind(this.get_schemas_used,this),this.apply_schemas=__bind(this.apply_schemas,this),this.get_all_schemas=__bind(this.get_all_schemas,this),this.has_schemas=__bind(this.has_schemas,this),this.load_schemas=__bind(this.load_schemas,this),this.declaredSchemas={}}return Schemas.prototype.load_schemas=function(node){var allSchemas,_this=this;if(this.has_property(node,"schemas")&&(allSchemas=this.property_value(node,"schemas"),allSchemas&&"object"==typeof allSchemas))return allSchemas.forEach(function(schema_entry){if(schema_entry&&"object"==typeof schema_entry&&"object"==typeof schema_entry.value)return schema_entry.value.forEach(function(schema){return _this.declaredSchemas[schema[0].value]=schema})})},Schemas.prototype.has_schemas=function(node){return 0===this.declaredSchemas.length&&this.has_property(node,"schemas")&&this.load_schemas(node),Object.keys(this.declaredSchemas).length>0},Schemas.prototype.get_all_schemas=function(){return this.declaredSchemas},Schemas.prototype.apply_schemas=function(node){var resources,schemas,_this=this;return resources=this.child_resources(node),schemas=this.get_schemas_used(resources),schemas.forEach(function(schema){if(schema[1].value in _this.declaredSchemas)return schema[1].value=_this.declaredSchemas[schema[1].value][1].value})},Schemas.prototype.get_schemas_used=function(resources){var schemas,_this=this;return schemas=[],resources.forEach(function(resource){var properties;return properties=_this.get_properties(resource[1],"schema"),schemas=schemas.concat(properties)}),schemas},Schemas}()}).call(this)},{"./errors":35,"./nodes":39}],48:[function(require,module,exports){(function(){var MarkedYAMLError,nodes,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),this.SecuritySchemeError=function(_super){function SecuritySchemeError(){return _ref=SecuritySchemeError.__super__.constructor.apply(this,arguments)}return __extends(SecuritySchemeError,_super),SecuritySchemeError}(MarkedYAMLError),this.SecuritySchemes=function(){function SecuritySchemes(){this.get_security_scheme=__bind(this.get_security_scheme,this),this.get_all_schemes=__bind(this.get_all_schemes,this),this.load_security_schemes=__bind(this.load_security_schemes,this),this.declaredSchemes={}}return SecuritySchemes.prototype.load_security_schemes=function(node){var allschemes,_this=this;if(this.has_property(node,"securitySchemes")&&(allschemes=this.property_value(node,"securitySchemes"),allschemes&&"object"==typeof allschemes))return allschemes.forEach(function(scheme_entry){if("tag:yaml.org,2002:map"===scheme_entry.tag)return scheme_entry.value.forEach(function(scheme){return _this.declaredSchemes[scheme[0].value]=scheme[1].value})})},SecuritySchemes.prototype.get_all_schemes=function(){return this.declaredSchemes},SecuritySchemes.prototype.get_security_scheme=function(schemaName){return this.declaredSchemes[schemaName]},SecuritySchemes}()}).call(this)},{"./errors":35,"./nodes":39}],49:[function(require,module,exports){(function(){var _ref,_ref1,_ref10,_ref11,_ref12,_ref13,_ref2,_ref3,_ref4,_ref5,_ref6,_ref7,_ref8,_ref9,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};this.Token=function(){function Token(start_mark,end_mark){this.start_mark=start_mark,this.end_mark=end_mark}return Token}(),this.DirectiveToken=function(_super){function DirectiveToken(name,value,start_mark,end_mark){this.name=name,this.value=value,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(DirectiveToken,_super),DirectiveToken.prototype.id="<directive>",DirectiveToken}(this.Token),this.DocumentStartToken=function(_super){function DocumentStartToken(){return _ref=DocumentStartToken.__super__.constructor.apply(this,arguments)}return __extends(DocumentStartToken,_super),DocumentStartToken.prototype.id="<document start>",DocumentStartToken}(this.Token),this.DocumentEndToken=function(_super){function DocumentEndToken(){return _ref1=DocumentEndToken.__super__.constructor.apply(this,arguments)}return __extends(DocumentEndToken,_super),DocumentEndToken.prototype.id="<document end>",DocumentEndToken}(this.Token),this.StreamStartToken=function(_super){function StreamStartToken(start_mark,end_mark,encoding){this.start_mark=start_mark,this.end_mark=end_mark,this.encoding=encoding}return __extends(StreamStartToken,_super),StreamStartToken.prototype.id="<stream start>",StreamStartToken}(this.Token),this.StreamEndToken=function(_super){function StreamEndToken(){return _ref2=StreamEndToken.__super__.constructor.apply(this,arguments)}return __extends(StreamEndToken,_super),StreamEndToken.prototype.id="<stream end>",StreamEndToken}(this.Token),this.BlockSequenceStartToken=function(_super){function BlockSequenceStartToken(){return _ref3=BlockSequenceStartToken.__super__.constructor.apply(this,arguments)}return __extends(BlockSequenceStartToken,_super),BlockSequenceStartToken.prototype.id="<block sequence start>",BlockSequenceStartToken}(this.Token),this.BlockMappingStartToken=function(_super){function BlockMappingStartToken(){return _ref4=BlockMappingStartToken.__super__.constructor.apply(this,arguments)}return __extends(BlockMappingStartToken,_super),BlockMappingStartToken.prototype.id="<block mapping end>",BlockMappingStartToken}(this.Token),this.BlockEndToken=function(_super){function BlockEndToken(){return _ref5=BlockEndToken.__super__.constructor.apply(this,arguments)}return __extends(BlockEndToken,_super),BlockEndToken.prototype.id="<block end>",BlockEndToken}(this.Token),this.FlowSequenceStartToken=function(_super){function FlowSequenceStartToken(){return _ref6=FlowSequenceStartToken.__super__.constructor.apply(this,arguments)}return __extends(FlowSequenceStartToken,_super),FlowSequenceStartToken.prototype.id="[",FlowSequenceStartToken}(this.Token),this.FlowMappingStartToken=function(_super){function FlowMappingStartToken(){return _ref7=FlowMappingStartToken.__super__.constructor.apply(this,arguments)}return __extends(FlowMappingStartToken,_super),FlowMappingStartToken.prototype.id="{",FlowMappingStartToken}(this.Token),this.FlowSequenceEndToken=function(_super){function FlowSequenceEndToken(){return _ref8=FlowSequenceEndToken.__super__.constructor.apply(this,arguments)}return __extends(FlowSequenceEndToken,_super),FlowSequenceEndToken.prototype.id="]",FlowSequenceEndToken}(this.Token),this.FlowMappingEndToken=function(_super){function FlowMappingEndToken(){return _ref9=FlowMappingEndToken.__super__.constructor.apply(this,arguments)}return __extends(FlowMappingEndToken,_super),FlowMappingEndToken.prototype.id="}",FlowMappingEndToken}(this.Token),this.KeyToken=function(_super){function KeyToken(){return _ref10=KeyToken.__super__.constructor.apply(this,arguments)}return __extends(KeyToken,_super),KeyToken.prototype.id="?",KeyToken}(this.Token),this.ValueToken=function(_super){function ValueToken(){return _ref11=ValueToken.__super__.constructor.apply(this,arguments)}return __extends(ValueToken,_super),ValueToken.prototype.id=":",ValueToken}(this.Token),this.BlockEntryToken=function(_super){function BlockEntryToken(){return _ref12=BlockEntryToken.__super__.constructor.apply(this,arguments)}return __extends(BlockEntryToken,_super),BlockEntryToken.prototype.id="-",BlockEntryToken}(this.Token),this.FlowEntryToken=function(_super){function FlowEntryToken(){return _ref13=FlowEntryToken.__super__.constructor.apply(this,arguments)}return __extends(FlowEntryToken,_super),FlowEntryToken.prototype.id=",",FlowEntryToken}(this.Token),this.AliasToken=function(_super){function AliasToken(value,start_mark,end_mark){this.value=value,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(AliasToken,_super),AliasToken.prototype.id="<alias>",AliasToken}(this.Token),this.AnchorToken=function(_super){function AnchorToken(value,start_mark,end_mark){this.value=value,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(AnchorToken,_super),AnchorToken.prototype.id="<anchor>",AnchorToken}(this.Token),this.TagToken=function(_super){function TagToken(value,start_mark,end_mark){this.value=value,this.start_mark=start_mark,this.end_mark=end_mark}return __extends(TagToken,_super),TagToken.prototype.id="<tag>",TagToken}(this.Token),this.ScalarToken=function(_super){function ScalarToken(value,plain,start_mark,end_mark,style){this.value=value,this.plain=plain,this.start_mark=start_mark,this.end_mark=end_mark,this.style=style}return __extends(ScalarToken,_super),ScalarToken.prototype.id="<scalar>",ScalarToken}(this.Token)}).call(this)},{}],50:[function(require,module,exports){(function(){var MarkedYAMLError,inflection,nodes,util,_ref,_ref1,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),inflection=require("inflection"),util=require("./util"),this.TraitError=function(_super){function TraitError(){return _ref=TraitError.__super__.constructor.apply(this,arguments)}return __extends(TraitError,_super),TraitError}(MarkedYAMLError),this.ParameterError=function(_super){function ParameterError(){return _ref1=ParameterError.__super__.constructor.apply(this,arguments)}return __extends(ParameterError,_super),ParameterError}(MarkedYAMLError),this.Traits=function(){function Traits(){this.declaredTraits={}}return Traits.prototype.load_traits=function(node){var allTraits,_this=this;if(this.has_property(node,"traits")&&(allTraits=this.property_value(node,"traits"),allTraits&&"object"==typeof allTraits))return allTraits.forEach(function(trait_item){if(trait_item&&"object"==typeof trait_item&&"object"==typeof trait_item.value)return trait_item.value.forEach(function(trait){return _this.declaredTraits[trait[0].value]=trait})})},Traits.prototype.has_traits=function(node){return 0===this.declaredTraits.length&&this.has_property(node,"traits")&&this.load_traits(node),Object.keys(this.declaredTraits).length>0},Traits.prototype.get_trait=function(traitName){return traitName in this.declaredTraits?this.declaredTraits[traitName][1]:null},Traits.prototype.apply_traits=function(node,resourceUri,removeQs){var resources,_this=this;if(null==resourceUri&&(resourceUri=""),null==removeQs&&(removeQs=!0),util.isMapping(node))return this.has_traits(node)?(resources=this.child_resources(node),resources.forEach(function(resource){return _this.apply_traits_to_resource(resourceUri+resource[0].value,resource[1],removeQs)})):void 0},Traits.prototype.apply_traits_to_resource=function(resourceUri,resource,removeQs){var methods,uses,_this=this;if(util.isMapping(resource))return methods=this.child_methods(resource),this.has_property(resource,"is")&&(uses=this.property_value(resource,"is"),uses.forEach(function(use){return methods.forEach(function(method){return _this.apply_trait(resourceUri,method,use)})})),methods.forEach(function(method){if(_this.has_property(method[1],"is"))return uses=_this.property_value(method[1],"is"),uses.forEach(function(use){return _this.apply_trait(resourceUri,method,use)})}),removeQs&&resource.remove_question_mark_properties(),this.apply_traits(resource,resourceUri,removeQs)},Traits.prototype.apply_trait=function(resourceUri,method,useKey){var plainParameters,temp,trait,traitName;if(traitName=this.key_or_value(useKey),!(null!=traitName?traitName.trim():void 0))throw new exports.TraitError("while applying trait",null,"trait name must be provided",useKey.start_mark);if(!(trait=this.get_trait(traitName)))throw new exports.TraitError("while applying trait",null,"there is no trait named "+traitName,useKey.start_mark);return plainParameters=this.get_parameters_from_is_key(resourceUri,method[0].value,useKey),temp=trait.cloneForTrait(),this.apply_parameters(temp,plainParameters,useKey),this.apply_default_media_type_to_method(temp),temp.combine(method[1]),method[1]=temp},Traits.prototype.apply_parameters=function(resource,parameters,useKey){var parameterName,usedParameters,_results;this._apply_parameters(resource,parameters,useKey,usedParameters={resourcePath:!0,resourcePathName:!0,methodName:!0}),_results=[];for(parameterName in parameters){if(!usedParameters[parameterName])throw new exports.ParameterError("while applying parameters",null,"unused parameter: "+parameterName,useKey.start_mark);_results.push(void 0)}return _results},Traits.prototype._apply_parameters=function(resource,parameters,useKey,usedParameters){var parameterUse,_this=this;if(resource)return util.isString(resource)?void((parameterUse=resource.value.match(/<<\s*([^\|\s>]+)\s*(\|.*)?\s*>>/g))&&parameterUse.forEach(function(parameter){var method,parameterName,value,_ref2,_ref3;if(parameterName=null!=parameter&&null!=(_ref2=parameter.trim())?_ref2.replace(/[<>]+/g,"").trim():void 0,_ref3=parameterName.split(/\s*\|\s*/),parameterName=_ref3[0],method=_ref3[1],!(parameterName in parameters))throw new exports.ParameterError("while applying parameters",null,"value was not provided for parameter: "+parameterName,useKey.start_mark);if(value=parameters[parameterName],usedParameters[parameterName]=!0,method)if(method.match(/!\s*singularize/))value=inflection.singularize(value);else{if(!method.match(/!\s*pluralize/))throw new exports.ParameterError("while validating parameter",null,"unknown function applied to parameter",resource.start_mark);value=inflection.pluralize(value)}return resource.value=resource.value.replace(parameter,value)})):util.isSequence(resource)?void resource.value.forEach(function(node){return _this._apply_parameters(node,parameters,useKey,usedParameters)}):void(util.isMapping(resource)&&resource.value.forEach(function(property){return _this._apply_parameters(property[0],parameters,useKey,usedParameters),_this._apply_parameters(property[1],parameters,useKey,usedParameters)}))},Traits.prototype.get_parameters_from_is_key=function(resourceUri,methodName,typeKey){var parameter,parameters,reserved,result,_i,_len,_ref2;if(result={},reserved={methodName:methodName,resourcePath:resourceUri.replace(/\/\/*/g,"/"),resourcePathName:this.extractResourcePathName(resourceUri)},util.isMapping(typeKey)&&(parameters=this.value_or_undefined(typeKey),util.isMapping(parameters[0][1])))for(_ref2=parameters[0][1].value,_i=0,_len=_ref2.length;_i<_len;_i++){if(parameter=_ref2[_i],parameter[0].value in reserved)throw new exports.TraitError("while applying parameters",null,"invalid parameter name: "+parameter[0].value+" is reserved",parameter[0].start_mark);result[parameter[0].value]=parameter[1].value}return util.extend(result,reserved)},Traits.prototype.extractResourcePathName=function(resourceUri){var pathSegments,segment;for(pathSegments=resourceUri.split(/\//);segment=pathSegments.pop();)if(!("undefined"!=typeof segment&&null!==segment?segment.match(/[{}]/):void 0))return segment;return""},Traits}()}).call(this)},{"./errors":35,"./nodes":39,"./util":52,inflection:19}],51:[function(require,module,exports){(function(){var nodes,uritemplate,util,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};uritemplate=require("uritemplate"),nodes=require("./nodes"),util=require("./util"),this.Transformations=function(){function Transformations(settings){this.settings=settings,this.isContentTypeString=__bind(this.isContentTypeString,this),this.add_key_value_to_node=__bind(this.add_key_value_to_node,this),this.apply_default_media_type_to_resource=__bind(this.apply_default_media_type_to_resource,this),this.get_media_type=__bind(this.get_media_type,this),this.load_default_media_type=__bind(this.load_default_media_type,this),this.applyAstTransformations=__bind(this.applyAstTransformations,this),this.applyTransformations=__bind(this.applyTransformations,this),this.declaredSchemas={}}return Transformations.prototype.applyTransformations=function(rootObject){var resources;if(this.settings.transform)return this.applyTransformationsToRoot(rootObject),resources=rootObject.resources,this.applyTransformationsToResources(rootObject,resources)},Transformations.prototype.applyAstTransformations=function(document){if(this.settings.transform)return this.transform_document(document)},Transformations.prototype.load_default_media_type=function(node){if(util.isMapping(node||(null!=node?node.value:void 0)))return this.mediaType=this.property_value(node,"mediaType")},Transformations.prototype.get_media_type=function(){return this.mediaType},Transformations.prototype.applyTransformationsToRoot=function(rootObject){var expressions,template;if(rootObject.baseUri)return template=uritemplate.parse(rootObject.baseUri),expressions=template.expressions.filter(function(expr){return"templateText"in expr}).map(function(expression){return expression.templateText}),expressions.length&&(rootObject.baseUriParameters||(rootObject.baseUriParameters={})),expressions.forEach(function(parameterName){if(!(parameterName in rootObject.baseUriParameters)&&(rootObject.baseUriParameters[parameterName]={type:"string",required:!0,displayName:parameterName},"version"===parameterName))return rootObject.baseUriParameters[parameterName]["enum"]=[rootObject.version]})},Transformations.prototype.applyTransformationsToResources=function(rootObject,resources){var expressions,inheritedSecScheme,method,parameterName,pathParts,resource,template,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_results;if(null!=resources?resources.length:void 0){for(_results=[],_i=0,_len=resources.length;_i<_len;_i++){if(resource=resources[_i],inheritedSecScheme=resource.securedBy?resource.securedBy:null!=rootObject?rootObject.securedBy:void 0,null!=(_ref=resource.methods)?_ref.length:void 0)for(_ref1=resource.methods,_j=0,_len1=_ref1.length;_j<_len1;_j++)method=_ref1[_j],"securedBy"in method||inheritedSecScheme&&(method.securedBy=inheritedSecScheme);for(pathParts=resource.relativeUri.split("/");!pathParts[0]&&pathParts.length;)pathParts.shift();resource.relativeUriPathSegments=pathParts,template=uritemplate.parse(resource.relativeUri),expressions=template.expressions.filter(function(expr){return"templateText"in expr}).map(function(expression){return expression.templateText}),expressions.length&&(resource.uriParameters||(resource.uriParameters={}));for(_k=0,_len2=expressions.length;_k<_len2;_k++)parameterName=expressions[_k],parameterName in resource.uriParameters||(resource.uriParameters[parameterName]={type:"string",required:!0,displayName:parameterName});_results.push(this.applyTransformationsToResources(rootObject,resource.resources))}return _results}},Transformations.prototype.apply_default_media_type_to_resource=function(resource){var childResource,method,_i,_j,_len,_len1,_ref,_ref1,_results;if(this.mediaType&&util.isMapping(resource)){for(_ref=this.child_resources(resource),_i=0,_len=_ref.length;_i<_len;_i++)childResource=_ref[_i],this.apply_default_media_type_to_resource(childResource[1]);for(_ref1=this.child_methods(resource),_results=[],_j=0,_len1=_ref1.length;_j<_len1;_j++)method=_ref1[_j],_results.push(this.apply_default_media_type_to_method(method[1]));return _results}},Transformations.prototype.apply_default_media_type_to_method=function(method){var responses,_this=this;if(this.mediaType&&util.isMapping(method)&&(this.has_property(method,"body")&&this.apply_default_media_type_to_body(this.get_property(method,"body")),this.has_property(method,"responses"))){if(responses=this.get_property(method,"responses"),!responses||!responses.value)return;return responses.value.forEach(function(response){if(_this.has_property(response[1],"body"))return _this.apply_default_media_type_to_body(_this.get_property(response[1],"body"))})}},Transformations.prototype.apply_default_media_type_to_body=function(body){var key,responseType,responseTypeKey,_ref,_ref1,_ref2;if(util.isMapping(body))return(null!=body&&null!=(_ref=body.value)&&null!=(_ref1=_ref[0])&&null!=(_ref2=_ref1[0])?_ref2.value:void 0)&&(key=body.value[0][0].value,!key.match(/\//))?(responseType=new nodes.MappingNode("tag:yaml.org,2002:map",[],body.start_mark,body.end_mark),responseTypeKey=new nodes.ScalarNode("tag:yaml.org,2002:str",this.mediaType,body.start_mark,body.end_mark),responseType.value.push([responseTypeKey,body.clone()]),body.value=responseType.value):void 0},Transformations.prototype.noop=function(){},Transformations.prototype.transform_types=function(typeProperty){var types,_this=this;return types=typeProperty.value,types.forEach(function(type_entry){return type_entry.value.forEach(function(type){return _this.transform_resource(type,!0)})})},Transformations.prototype.transform_traits=function(traitProperty){var traits,_this=this;return traits=traitProperty.value,traits.forEach(function(trait_entry){return trait_entry.value.forEach(function(trait){return _this.transform_method(trait[1],!0)})})},Transformations.prototype.transform_named_params=function(property,allowParameterKeys,requiredByDefault){var _this=this;if(null==requiredByDefault&&(requiredByDefault=!0),!util.isNull(property[1]))return property[1].value.forEach(function(param){return util.isNull(param[1])&&(param[1]=new nodes.MappingNode("tag:yaml.org,2002:map",[],param[1].start_mark,param[1].end_mark)),_this.transform_common_parameter_properties(param[0].value,param[1],allowParameterKeys,requiredByDefault)})},Transformations.prototype.transform_common_parameter_properties=function(parameterName,node,allowParameterKeys,requiredByDefault){var _this=this;return util.isSequence(node)?node.value.forEach(function(parameter){return _this.transform_named_parameter(parameterName,parameter,allowParameterKeys,requiredByDefault)}):this.transform_named_parameter(parameterName,node,allowParameterKeys,requiredByDefault)},Transformations.prototype.transform_named_parameter=function(parameterName,node,allowParameterKeys,requiredByDefault){var hasDisplayName,hasRequired,hasType,_this=this;if(hasDisplayName=!1,hasRequired=!1,hasType=!1,node.value.forEach(function(childNode){var canonicalPropertyName;if(!allowParameterKeys||!_this.isParameterKey(childNode))switch(canonicalPropertyName=_this.canonicalizePropertyName(childNode[0].value,allowParameterKeys)){case"pattern":return _this.noop();case"default":return _this.noop();case"enum":return _this.noop();case"description":return _this.noop();case"example":return _this.noop();case"minLength":return _this.noop();case"maxLength":return _this.noop();case"minimum":return _this.noop();case"maximum":return _this.noop();case"repeat":return _this.noop();case"displayName":return hasDisplayName=!0;case"type":return hasType=!0;case"required":return hasRequired=!0;default:return _this.noop()}}),hasDisplayName||this.add_key_value_to_node(node,"displayName","tag:yaml.org,2002:str",this.canonicalizePropertyName(parameterName,allowParameterKeys)),hasRequired||requiredByDefault&&this.add_key_value_to_node(node,"required","tag:yaml.org,2002:bool","true"),!hasType)return this.add_key_value_to_node(node,"type","tag:yaml.org,2002:str","string")},Transformations.prototype.add_key_value_to_node=function(node,keyName,valueTag,value){var propertyName,propertyValue;return propertyName=new nodes.ScalarNode("tag:yaml.org,2002:str",keyName,node.start_mark,node.end_mark),propertyValue=new nodes.ScalarNode(valueTag,value,node.start_mark,node.end_mark),node.value.push([propertyName,propertyValue])},Transformations.prototype.transform_document=function(node){var _this=this;if(null!=node?node.value:void 0)return node.value.forEach(function(property){var _ref;switch(property[0].value){case"title":return _this.noop();case"securitySchemes":return _this.noop();case"schemas":return _this.noop();case"version":return _this.noop();case"documentation":return _this.noop();case"mediaType":return _this.noop();case"securedBy":return _this.noop();case"baseUri":return _this.noop();case"traits":return _this.transform_traits(property[1]);case"baseUriParameters":return _this.transform_named_params(property,!1);case"resourceTypes":return _this.transform_types(property[1]);case"resources":return null!=(_ref=property[1])?_ref.value.forEach(function(resource){return _this.transform_resource(resource)}):void 0;default:return _this.noop()}})},Transformations.prototype.transform_resource=function(resource,allowParameterKeys){var _this=this;if(null==allowParameterKeys&&(allowParameterKeys=!1),resource.value)return resource.value.forEach(function(property){var canonicalKey,isKnownCommonProperty,_ref,_ref1;if(isKnownCommonProperty=_this.transform_common_properties(property,allowParameterKeys),!isKnownCommonProperty){if(_this.isHttpMethod(property[0].value,allowParameterKeys))return _this.transform_method(property[1],allowParameterKeys);switch(canonicalKey=_this.canonicalizePropertyName(property[0].value,allowParameterKeys)){case"type":return _this.noop();case"usage":return _this.noop();case"securedBy":return _this.noop();case"uriParameters":return _this.transform_named_params(property,allowParameterKeys);case"baseUriParameters":return _this.transform_named_params(property,allowParameterKeys);case"resources":return null!=(_ref=property[1])?_ref.value.forEach(function(resource){return _this.transform_resource(resource)}):void 0;case"methods":return null!=(_ref1=property[1])?_ref1.value.forEach(function(method){return _this.transform_method(method,allowParameterKeys)}):void 0;default:return _this.noop()}}})},Transformations.prototype.transform_method=function(method,allowParameterKeys){var _this=this;if(!util.isNull(method))return method.value.forEach(function(property){var canonicalKey;if(!_this.transform_common_properties(property,allowParameterKeys))switch(canonicalKey=_this.canonicalizePropertyName(property[0].value,allowParameterKeys)){case"securedBy":return _this.noop();case"usage":return _this.noop();case"headers":return _this.transform_named_params(property,allowParameterKeys,!1);case"queryParameters":return _this.transform_named_params(property,allowParameterKeys,!1);case"baseUriParameters":return _this.transform_named_params(property,allowParameterKeys);case"body":return _this.transform_body(property,allowParameterKeys);case"responses":return _this.transform_responses(property,allowParameterKeys);default:return _this.noop()}})},Transformations.prototype.transform_responses=function(responses,allowParameterKeys){var _this=this;if(!util.isNull(responses[1]))return responses[1].value.forEach(function(response){return _this.transform_response(response,allowParameterKeys)})},Transformations.prototype.transform_response=function(response,allowParameterKeys){var _this=this;if(util.isMapping(response[1]))return response[1].value.forEach(function(property){var canonicalKey;switch(canonicalKey=_this.canonicalizePropertyName(property[0].value,allowParameterKeys)){case"description":return _this.noop();case"body":return _this.transform_body(property,allowParameterKeys);case"headers":return _this.transform_named_params(property,allowParameterKeys,!1);default:return _this.noop()}})},Transformations.prototype.isContentTypeString=function(value){
return null!=value?value.match(/^[^\/]+\/[^\/]+$/):void 0},Transformations.prototype.transform_body=function(property,allowParameterKeys){var _ref,_this=this;if(!util.isNull(property[1]))return null!=(_ref=property[1].value)?_ref.forEach(function(bodyProperty){var canonicalProperty;if(_this.isParameterKey(bodyProperty))return _this.noop();if(_this.isContentTypeString(bodyProperty[0].value))return _this.transform_body(bodyProperty,allowParameterKeys);switch(canonicalProperty=_this.canonicalizePropertyName(bodyProperty[0].value,allowParameterKeys)){case"example":return _this.noop();case"schema":return _this.noop();case"formParameters":return _this.transform_named_params(bodyProperty,allowParameterKeys,!1);default:return _this.noop()}}):void 0},Transformations.prototype.transform_common_properties=function(property,allowParameterKeys){var canonicalProperty;if(this.isParameterKey(property))return!0;switch(canonicalProperty=this.canonicalizePropertyName(property[0].value,allowParameterKeys)){case"displayName":return!0;case"description":return!0;case"is":return!0;default:this.noop()}return!1},Transformations}()}).call(this)},{"./nodes":39,"./util":52,uritemplate:67}],52:[function(require,module,exports){(function(){var __slice=[].slice,__hasProp={}.hasOwnProperty;this.extend=function(){var destination,k,source,sources,v,_i,_len;for(destination=arguments[0],sources=2<=arguments.length?__slice.call(arguments,1):[],_i=0,_len=sources.length;_i<_len;_i++){source=sources[_i];for(k in source)v=source[k],destination[k]=v}return destination},this.is_empty=function(obj){var key;if(Array.isArray(obj)||"string"==typeof obj)return 0===obj.length;for(key in obj)if(__hasProp.call(obj,key))return!1;return!0},this.isNoop=function(node){return node},this.isMapping=function(node){return"tag:yaml.org,2002:map"===(null!=node?node.tag:void 0)},this.isNull=function(node){return"tag:yaml.org,2002:null"===(null!=node?node.tag:void 0)},this.isSequence=function(node){return"tag:yaml.org,2002:seq"===(null!=node?node.tag:void 0)},this.isString=function(node){return"tag:yaml.org,2002:str"===(null!=node?node.tag:void 0)},this.isInteger=function(node){return"tag:yaml.org,2002:int"===(null!=node?node.tag:void 0)},this.isNullableMapping=function(node){return this.isMapping(node)||this.isNull(node)},this.isNullableString=function(node){return this.isString(node)||this.isNull(node)},this.isNullableSequence=function(node){return this.isSequence(node)||this.isNull(node)},this.isNumber=function(node){return"tag:yaml.org,2002:int"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:float"===(null!=node?node.tag:void 0)},this.isScalar=function(node){return"tag:yaml.org,2002:null"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:bool"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:int"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:float"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:binary"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:timestamp"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:str"===(null!=node?node.tag:void 0)},this.isCollection=function(node){return"tag:yaml.org,2002:omap"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:pairs"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:set"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:seq"===(null!=node?node.tag:void 0)||"tag:yaml.org,2002:map"===(null!=node?node.tag:void 0)}}).call(this)},{}],53:[function(require,module,exports){(function(){var MarkedYAMLError,jsonlint,nodes,traits,uritemplate,url,util,_ref,__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1};url=require("url"),uritemplate=require("uritemplate"),MarkedYAMLError=require("./errors").MarkedYAMLError,nodes=require("./nodes"),traits=require("./traits"),util=require("./util"),jsonlint=require("json-lint"),this.ValidationError=function(_super){function ValidationError(){return _ref=ValidationError.__super__.constructor.apply(this,arguments)}return __extends(ValidationError,_super),ValidationError}(MarkedYAMLError),this.ValidationErrors=function(_super){function ValidationErrors(validation_errors){this.validation_errors=validation_errors}return __extends(ValidationErrors,_super),ValidationErrors.prototype.get_validation_errors=function(){return this.validation_errors},ValidationErrors}(MarkedYAMLError),this.Validator=function(){function Validator(){this.get_properties=__bind(this.get_properties,this),this.get_list_values=__bind(this.get_list_values,this),this.validations=[this.validate_root,this.validate_root_properties,this.validate_base_uri_parameters,this.valid_absolute_uris]}return Validator.prototype.validate_document=function(node){var validation,_i,_len,_ref1;for(_ref1=this.validations,_i=0,_len=_ref1.length;_i<_len;_i++)validation=_ref1[_i],validation.call(this,node);return!0},Validator.prototype.validate_security_schemes=function(schemesProperty){var scheme,scheme_entry,_i,_len,_ref1,_results;if(!util.isSequence(schemesProperty))throw new exports.ValidationError("while validating securitySchemes",null,"invalid security schemes property, it must be an array",schemesProperty.start_mark);for(_ref1=schemesProperty.value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(scheme_entry=_ref1[_i],!util.isMapping(scheme_entry))throw new exports.ValidationError("while validating securitySchemes",null,"invalid security scheme property, it must be a map",scheme_entry.start_mark);_results.push(function(){var _j,_len1,_ref2,_results1;for(_ref2=scheme_entry.value,_results1=[],_j=0,_len1=_ref2.length;_j<_len1;_j++){if(scheme=_ref2[_j],!util.isMapping(scheme[1]))throw new exports.ValidationError("while validating securitySchemes",null,"invalid security scheme property, it must be a map",scheme[0].start_mark);_results1.push(this.validate_security_scheme(scheme[1]))}return _results1}.call(this))}return _results},Validator.prototype.trackRepeatedProperties=function(properties,key,property,section,errorMessage){if(null==section&&(section="RAML"),null==errorMessage&&(errorMessage="a property with the same name already exists"),key in properties)throw new exports.ValidationError("while validating "+section,null,""+errorMessage+": '"+key+"'",property.start_mark);return properties[key]=property},Validator.prototype.validate_security_scheme=function(scheme){var property,schemeProperties,settings,type,_i,_len,_ref1;for(type=null,settings=null,schemeProperties={},_ref1=scheme.value,_i=0,_len=_ref1.length;_i<_len;_i++)switch(property=_ref1[_i],this.trackRepeatedProperties(schemeProperties,property[0].value,property[0],"while validating security scheme","property already used in security scheme"),property[0].value){case"description":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating security scheme",null,"schemes description must be a string",property[1].start_mark);break;case"type":if(type=property[1].value,!util.isString(property[1])||!type.match(/^(OAuth 1.0|OAuth 2.0|Basic Authentication|Digest Authentication|x-.+)$/))throw new exports.ValidationError("while validating security scheme",null,'schemes type must be any of: "OAuth 1.0", "OAuth 2.0", "Basic Authentication", "Digest Authentication", "x-{.+}"',property[1].start_mark);break;case"describedBy":this.validate_method(property,!0,"security scheme");break;case"settings":if(settings=property,!util.isNullableMapping(property[1]))throw new exports.ValidationError("while validating security scheme",null,"schemes settings must be a map",property[1].start_mark);break;default:throw new exports.ValidationError("while validating security scheme",null,"property: '"+property[0].value+"' is invalid in a security scheme",property[0].start_mark)}if(!type)throw new exports.ValidationError("while validating security scheme",null,'schemes type must be any of: "OAuth 1.0", "OAuth 2.0", "Basic Authentication", "Digest Authentication", "x-{.+}"',scheme.start_mark);if("OAuth 2.0"===type){if(!settings)throw new exports.ValidationError("while validating security scheme",null,"for OAuth 2.0 settings must be a map",scheme.start_mark);return this.validate_oauth2_settings(settings)}if("OAuth 1.0"===type){if(!settings)throw new exports.ValidationError("while validating security scheme",null,"for OAuth 1.0 settings must be a map",scheme.start_mark);return this.validate_oauth1_settings(settings)}},Validator.prototype.validate_oauth2_settings=function(settings){var property,propertyName,settingProperties,_i,_j,_len,_len1,_ref1,_ref2,_results;for(settingProperties={},_ref1=settings[1].value,_i=0,_len=_ref1.length;_i<_len;_i++)switch(property=_ref1[_i],this.trackRepeatedProperties(settingProperties,property[0].value,property[0],"while validating security scheme","setting with the same name already exists"),property[0].value){case"authorizationUri":if(!util.isString(property[1]))throw new exports.ValidationError("while validating security scheme",null,"authorizationUri must be a URL",property[0].start_mark);break;case"accessTokenUri":if(!util.isString(property[1]))throw new exports.ValidationError("while validating security scheme",null,"accessTokenUri must be a URL",property[0].start_mark)}for(_ref2=["accessTokenUri","authorizationUri"],_results=[],_j=0,_len1=_ref2.length;_j<_len1;_j++){if(propertyName=_ref2[_j],!(propertyName in settingProperties))throw new exports.ValidationError("while validating security scheme",null,"OAuth 2.0 settings must have "+propertyName+" property",settings[0].start_mark);_results.push(void 0)}return _results},Validator.prototype.validate_oauth1_settings=function(settings){var property,propertyName,settingProperties,_i,_j,_len,_len1,_ref1,_ref2,_results;for(settingProperties={},_ref1=settings[1].value,_i=0,_len=_ref1.length;_i<_len;_i++)switch(property=_ref1[_i],this.trackRepeatedProperties(settingProperties,property[0].value,property[0],"while validating security scheme","setting with the same name already exists"),property[0].value){case"requestTokenUri":if(!util.isString(property[1]))throw new exports.ValidationError("while validating security scheme",null,"requestTokenUri must be a URL",property[0].start_mark);break;case"authorizationUri":if(!util.isString(property[1]))throw new exports.ValidationError("while validating security scheme",null,"authorizationUri must be a URL",property[0].start_mark);break;case"tokenCredentialsUri":if(!util.isString(property[1]))throw new exports.ValidationError("while validating security scheme",null,"tokenCredentialsUri must be a URL",property[0].start_mark)}for(_ref2=["requestTokenUri","authorizationUri","tokenCredentialsUri"],_results=[],_j=0,_len1=_ref2.length;_j<_len1;_j++){if(propertyName=_ref2[_j],!(propertyName in settingProperties))throw new exports.ValidationError("while validating security scheme",null,"OAuth 1.0 settings must have "+propertyName+" property",settings[0].start_mark);_results.push(void 0)}return _results},Validator.prototype.validate_root_schemas=function(schemas){var schema,schemaList,schemaName,_results;if(!util.isSequence(schemas))throw new exports.ValidationError("while validating schemas",null,"schemas property must be an array",schemas.start_mark);schemaList=this.get_all_schemas(),_results=[];for(schemaName in schemaList){if(schema=schemaList[schemaName],!schema[1].tag||!util.isString(schema[1]))throw new exports.ValidationError("while validating schemas",null,"schema "+schemaName+" must be a string",schema[0].start_mark);_results.push(this.validateSchema(schema[1]))}return _results},Validator.prototype.validate_root=function(node){if(!node&&!util.isNull(node))throw new exports.ValidationError("while validating root",null,"empty document",null!=node?node.start_mark:void 0);if(!util.isMapping(node))throw new exports.ValidationError("while validating root",null,"document must be a map",node.start_mark)},Validator.prototype.validate_base_uri_parameters=function(){if(this.baseUriParameters){if(!this.baseUri)throw new exports.ValidationError("while validating uri parameters",null,"uri parameters defined when there is no baseUri",this.baseUriParameters.start_mark);if(!util.isNullableMapping(this.baseUriParameters))throw new exports.ValidationError("while validating uri parameters",null,"base uri parameters must be a map",this.baseUriParameters.start_mark);return this.validate_uri_parameters(this.baseUri,this.baseUriParameters,!1,!1,["version"])}},Validator.prototype.validate_uri_parameters=function(uri,uriProperty,allowParameterKeys,skipParameterUseCheck,reservedNames){var err,expressions,parameterName,template,uriParameter,uriParameters,_i,_len,_ref1,_ref2,_results;null==reservedNames&&(reservedNames=[]);try{template=uritemplate.parse(uri)}catch(_error){throw err=_error,new exports.ValidationError("while validating uri parameters",null,null!=err&&null!=(_ref1=err.options)?_ref1.message:void 0,uriProperty.start_mark)}if(expressions=template.expressions.filter(function(expr){return"templateText"in expr}).map(function(expression){return expression.templateText}),uriParameters={},"object"==typeof uriProperty.value){for(_ref2=uriProperty.value,_results=[],_i=0,_len=_ref2.length;_i<_len;_i++){if(uriParameter=_ref2[_i],parameterName=this.canonicalizePropertyName(uriParameter[0].value,allowParameterKeys),this.trackRepeatedProperties(uriParameters,parameterName,uriProperty,"while validating URI parameters","URI parameter with the same name already exists"),__indexOf.call(reservedNames,parameterName)>=0)throw new exports.ValidationError("while validating baseUri",null,uriParameter[0].value+" parameter not allowed here",uriParameter[0].start_mark);if(!util.isNullableMapping(uriParameter[1],allowParameterKeys)&&!util.isNullableSequence(uriParameter[1],allowParameterKeys))throw new exports.ValidationError("while validating baseUri",null,"URI parameter must be a map",uriParameter[0].start_mark);if(util.isNull(uriParameter[1])||this.valid_common_parameter_properties(uriParameter[1],allowParameterKeys),!(skipParameterUseCheck||this.isParameterKey(uriParameter)||__indexOf.call(expressions,parameterName)>=0))throw new exports.ValidationError("while validating baseUri",null,uriParameter[0].value+" uri parameter unused",uriParameter[0].start_mark);_results.push(void 0)}return _results}},Validator.prototype.validate_types=function(typeProperty){var type,type_entry,types,_i,_len,_results;if(types=typeProperty.value,!util.isSequence(typeProperty))throw new exports.ValidationError("while validating resource types",null,"invalid resourceTypes definition, it must be an array",typeProperty.start_mark);for(_results=[],_i=0,_len=types.length;_i<_len;_i++){if(type_entry=types[_i],!util.isMapping(type_entry))throw new exports.ValidationError("while validating resource types",null,"invalid resourceType definition, it must be a map",type_entry.start_mark);_results.push(function(){var _j,_len1,_ref1,_results1;for(_ref1=type_entry.value,_results1=[],_j=0,_len1=_ref1.length;_j<_len1;_j++){if(type=_ref1[_j],this.isParameterKey(type))throw new exports.ValidationError("while validating resource types",null,"parameter key cannot be used as a resource type name",type[0].start_mark);if(!util.isMapping(type[1]))throw new exports.ValidationError("while validating resource types",null,"invalid resourceType definition, it must be a map",type[1].start_mark);_results1.push(this.validate_resource(type,!0,"resource type"))}return _results1}.call(this))}return _results},Validator.prototype.validate_traits=function(traitProperty){var trait,trait_entry,_i,_len,_results;if(traits=traitProperty.value,!Array.isArray(traits))throw new exports.ValidationError("while validating traits",null,"invalid traits definition, it must be an array",traitProperty.start_mark);for(_results=[],_i=0,_len=traits.length;_i<_len;_i++){if(trait_entry=traits[_i],!Array.isArray(trait_entry.value))throw new exports.ValidationError("while validating traits",null,"invalid traits definition, it must be an array",traitProperty.start_mark);_results.push(function(){var _j,_len1,_ref1,_results1;for(_ref1=trait_entry.value,_results1=[],_j=0,_len1=_ref1.length;_j<_len1;_j++){if(trait=_ref1[_j],this.isParameterKey(trait))throw new exports.ValidationError("while validating traits",null,"parameter key cannot be used as a trait name",trait[0].start_mark);if(!util.isMapping(trait[1]))throw new exports.ValidationError("while validating traits",null,"invalid trait definition, it must be a map",trait[1].start_mark);_results1.push(this.valid_traits_properties(trait))}return _results1}.call(this))}return _results},Validator.prototype.valid_traits_properties=function(node){var invalid;if(node[1].value&&util.isMapping(node[1])){if(invalid=node[1].value.filter(function(childNode){return"is"===childNode[0].value||"type"===childNode[0].value}),invalid.length>0)throw new exports.ValidationError("while validating trait properties",null,"property: '"+invalid[0][0].value+"' is invalid in a trait",invalid[0][0].start_mark);return this.validate_method(node,!0,"trait")}},Validator.prototype.canonicalizePropertyName=function(propertyName,mustRemoveQuestionMark){return mustRemoveQuestionMark&&"?"===propertyName.slice(-1)?propertyName.slice(0,-1):propertyName},Validator.prototype.valid_common_parameter_properties=function(node,allowParameterKeys){var parameter,_i,_len,_ref1,_results;if(node.value){if(util.isSequence(node)){if(0===node.value.length)throw new exports.ValidationError("while validating parameter properties",null,"named parameter needs at least one type",node.start_mark);if(!(node.value.length>1))throw new exports.ValidationError("while validating parameter properties",null,"single type for variably typed parameter",node.start_mark);for(_ref1=node.value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)parameter=_ref1[_i],_results.push(this.validate_named_parameter(parameter,allowParameterKeys));return _results}return this.validate_named_parameter(node,allowParameterKeys)}},Validator.prototype.validate_named_parameter=function(node,allowParameterKeys){var booleanValues,canonicalPropertyName,childNode,enumValues,parameterProperties,parameterType,propertyName,propertyValue,unusableProperty,valid,validTypes,_i,_j,_k,_len,_len1,_len2,_ref1,_ref2,_ref3,_results;for(parameterProperties={},parameterType="string",_ref1=node.value,_i=0,_len=_ref1.length;_i<_len;_i++)if(childNode=_ref1[_i],propertyName=childNode[0].value,propertyValue=childNode[1].value,this.trackRepeatedProperties(parameterProperties,this.canonicalizePropertyName(childNode[0].value,!0),childNode[0],"while validating parameter properties","parameter property already used"),booleanValues=["true","false"],!allowParameterKeys||!this.isParameterKey(childNode)&&!this.isParameterValue(childNode)){switch(canonicalPropertyName=this.canonicalizePropertyName(propertyName,allowParameterKeys),valid=!0,propertyName){case"displayName":if(!util.isScalar(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of displayName must be a scalar",childNode[1].start_mark);break;case"pattern":if(!util.isScalar(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of pattern must be a scalar",childNode[1].start_mark);break;case"default":if(!util.isScalar(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of default must be a scalar",childNode[1].start_mark);break;case"description":if(!util.isScalar(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of description must be a scalar",childNode[1].start_mark);break;case"example":if(!util.isScalar(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of example must be a scalar",childNode[1].start_mark);break;case"minLength":if(isNaN(propertyValue))throw new exports.ValidationError("while validating parameter properties",null,"the value of minLength must be a number",childNode[1].start_mark);break;case"maxLength":if(isNaN(propertyValue))throw new exports.ValidationError("while validating parameter properties",null,"the value of maxLength must be a number",childNode[1].start_mark);break;case"minimum":if(isNaN(propertyValue))throw new exports.ValidationError("while validating parameter properties",null,"the value of minimum must be a number",childNode[1].start_mark);break;case"maximum":if(isNaN(propertyValue))throw new exports.ValidationError("while validating parameter properties",null,"the value of maximum must be a number",childNode[1].start_mark);break;case"type":if(parameterType=propertyValue,validTypes=["string","number","integer","date","boolean","file"],__indexOf.call(validTypes,propertyValue)<0)throw new exports.ValidationError("while validating parameter properties",null,"type can be either of: string, number, integer, file, date or boolean ",childNode[1].start_mark);break;case"required":if(__indexOf.call(booleanValues,propertyValue)<0)throw new exports.ValidationError("while validating parameter properties",null,"required can be any either true or false",childNode[1].start_mark);break;case"repeat":if(__indexOf.call(booleanValues,propertyValue)<0)throw new exports.ValidationError("while validating parameter properties",null,"repeat can be any either true or false",childNode[1].start_mark);break;default:valid=!1}switch(canonicalPropertyName){case"enum":if(!util.isNullableSequence(childNode[1]))throw new exports.ValidationError("while validating parameter properties",null,"the value of enum must be an array",childNode[1].start_mark);if(!childNode[1].value.length)throw new exports.ValidationError("while validating parameter properties",null,"enum is empty",childNode[1].start_mark);if(enumValues=this.get_list_values(childNode[1].value),this.hasDuplicates(enumValues))throw new exports.ValidationError("while validating parameter properties",null,"enum contains duplicated values",childNode[1].start_mark);break;default:if(!valid)throw new exports.ValidationError("while validating parameter properties",null,"unknown property "+propertyName,childNode[0].start_mark)}}if("string"!==parameterType)for(_ref2=["enum","pattern","minLength","maxLength"],_j=0,_len1=_ref2.length;_j<_len1;_j++)if(unusableProperty=_ref2[_j],unusableProperty in parameterProperties)throw new exports.ValidationError("while validating parameter properties",null,"property "+unusableProperty+" can only be used if type is 'string'",parameterProperties[unusableProperty].start_mark);if("number"!==parameterType&&"integer"!==parameterType){for(_ref3=["minimum","maximum"],_results=[],_k=0,_len2=_ref3.length;_k<_len2;_k++){if(unusableProperty=_ref3[_k],unusableProperty in parameterProperties)throw new exports.ValidationError("while validating parameter properties",null,"property "+unusableProperty+" can only be used if type is 'number' or 'integer'",parameterProperties[unusableProperty].start_mark);_results.push(void 0)}return _results}},Validator.prototype.get_list_values=function(node){return node.map(function(item){return item.value})},Validator.prototype.validate_root_properties=function(node){var checkVersion,property,rootProperties,_i,_len,_ref1;if(checkVersion=!1,rootProperties={},null!=node?node.value:void 0)for(_ref1=node.value,_i=0,_len=_ref1.length;_i<_len;_i++)switch(property=_ref1[_i],property[0].value.match(/^\//)?this.trackRepeatedProperties(rootProperties,this.canonicalizePropertyName(property[0].value,!0),property[0],"while validating root properties","resource already declared"):this.trackRepeatedProperties(rootProperties,property[0].value,property[0],"while validating root properties","root property already used"),property[0].value){case"title":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating root properties",null,"title must be a string",property[0].start_mark);break;case"baseUri":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating root properties",null,"baseUri must be a string",property[0].start_mark);this.baseUri=property[1].value,checkVersion=this.validate_base_uri(property[1]);break;case"securitySchemes":this.validate_security_schemes(property[1]);break;case"schemas":this.validate_root_schemas(property[1]);break;case"version":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating root properties",null,"version must be a string",property[0].start_mark);util.isNull(property[1])||(property[1].tag="tag:yaml.org,2002:str");break;case"traits":this.validate_traits(property[1]);break;case"documentation":if(!util.isSequence(property[1]))throw new exports.ValidationError("while validating root properties",null,"documentation must be an array",property[0].start_mark);this.validate_documentation(property[1]);break;case"mediaType":if(!util.isString(property[1]))throw new exports.ValidationError("while validating root properties",null,"mediaType must be a scalar",property[0].start_mark);break;case"baseUriParameters":this.baseUriParameters=property[1],util.isNoop(property[1]);break;case"resourceTypes":this.validate_types(property[1]);break;case"securedBy":this.validate_secured_by(property);break;case"protocols":this.validate_protocols_property(property);break;default:if(!property[0].value.match(/^\//))throw new exports.ValidationError("while validating root properties",null,"unknown property "+property[0].value,property[0].start_mark);this.validate_resource(property)}if(!("title"in rootProperties))throw new exports.ValidationError("while validating root properties",null,"missing title",node.start_mark);if(checkVersion&&!("version"in rootProperties))throw new exports.ValidationError("while validating version",null,"missing version",node.start_mark)},Validator.prototype.validate_documentation=function(documentation_property){var docSection,_i,_len,_ref1,_results;if(!documentation_property.value.length)throw new exports.ValidationError("while validating documentation section",null,"there must be at least one document in the documentation section",documentation_property.start_mark);for(_ref1=documentation_property.value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)docSection=_ref1[_i],_results.push(this.validate_doc_section(docSection));return _results},Validator.prototype.validate_doc_section=function(docSection){var docProperties,property,_i,_len,_ref1;if(!util.isMapping(docSection))throw new exports.ValidationError("while validating documentation section",null,"each documentation section must be a map",docSection.start_mark);for(docProperties={},_ref1=docSection.value,_i=0,_len=_ref1.length;_i<_len;_i++)switch(property=_ref1[_i],this.trackRepeatedProperties(docProperties,property[0].value,property[0],"while validating documentation section","property already used"),property[0].value){case"title":if(!util.isScalar(property[1])||util.isNull(property[1]))throw new exports.ValidationError("while validating documentation section",null,"title must be a string",property[0].start_mark);break;case"content":if(!util.isScalar(property[1])||util.isNull(property[1]))throw new exports.ValidationError("while validating documentation section",null,"content must be a string",property[0].start_mark);break;default:throw new exports.ValidationError("while validating root properties",null,"unknown property "+property[0].value,property[0].start_mark)}if(!("content"in docProperties))throw new exports.ValidationError("while validating documentation section",null,"a documentation entry must have content property",docSection.start_mark);if(!("title"in docProperties))throw new exports.ValidationError("while validating documentation section",null,"a documentation entry must have title property",docSection.start_mark)},Validator.prototype.child_resources=function(node){return node&&util.isMapping(node)?node.value.filter(function(childNode){return childNode[0].value.match(/^\//)}):[]},Validator.prototype.validate_resource=function(resource,allowParameterKeys,context){var canonicalKey,err,key,property,resourceProperties,template,valid,_i,_len,_ref1,_ref2,_results;if(null==allowParameterKeys&&(allowParameterKeys=!1),null==context&&(context="resource"),!resource[1]||!util.isNullableMapping(resource[1]))throw new exports.ValidationError("while validating resources",null,"resource is not a map",resource[1].start_mark);if(resource[0].value)try{template=uritemplate.parse(resource[0].value)}catch(_error){throw err=_error,new exports.ValidationError("while validating resource",null,"Resource name is invalid: "+(null!=err&&null!=(_ref1=err.options)?_ref1.message:void 0),resource[0].start_mark)}if(!util.isNull(resource[1])&&resource[1].value){for(resourceProperties={},_ref2=resource[1].value,_results=[],_i=0,_len=_ref2.length;_i<_len;_i++)if(property=_ref2[_i],property[0].value.match(/^\//)?this.trackRepeatedProperties(resourceProperties,this.canonicalizePropertyName(property[0].value,!0),property[0],"while validating resource","resource already declared"):this.isHttpMethod(property[0].value,allowParameterKeys)?this.trackRepeatedProperties(resourceProperties,this.canonicalizePropertyName(property[0].value,!0),property[0],"while validating resource","method already declared"):this.trackRepeatedProperties(resourceProperties,this.canonicalizePropertyName(property[0].value,!0),property[0],"while validating resource","property already used"),this.validate_common_properties(property,allowParameterKeys))_results.push(void 0);else if(property[0].value.match(/^\//)){if(allowParameterKeys)throw new exports.ValidationError("while validating trait properties",null,"resource type cannot define child resources",property[0].start_mark);_results.push(this.validate_resource(property,allowParameterKeys))}else if(this.isHttpMethod(property[0].value,allowParameterKeys))_results.push(this.validate_method(property,allowParameterKeys,"method"));else{switch(key=property[0].value,canonicalKey=this.canonicalizePropertyName(key,allowParameterKeys),valid=!0,canonicalKey){case"uriParameters":if(!util.isNullableMapping(property[1]))throw new exports.ValidationError("while validating uri parameters",null,"uri parameters must be a map",property[0].start_mark);this.validate_uri_parameters(resource[0].value,property[1],allowParameterKeys,allowParameterKeys);break;case"baseUriParameters":if(!this.baseUri)throw new exports.ValidationError("while validating uri parameters",null,"base uri parameters defined when there is no baseUri",property[0].start_mark);if(!util.isNullableMapping(property[1]))throw new exports.ValidationError("while validating uri parameters",null,"base uri parameters must be a map",property[0].start_mark);this.validate_uri_parameters(this.baseUri,property[1],allowParameterKeys);break;default:valid=!1}switch(key){case"type":_results.push(this.validate_type_property(property,allowParameterKeys));break;case"usage":if(!allowParameterKeys)throw new exports.ValidationError("while validating resources",null,"property: '"+property[0].value+"' is invalid in a resource",property[0].start_mark);_results.push(void 0);break;case"securedBy":_results.push(this.validate_secured_by(property));break;default:if(!valid)throw new exports.ValidationError("while validating resources",null,"property: '"+property[0].value+("' is invalid in a "+context),property[0].start_mark);_results.push(void 0)}}return _results}},Validator.prototype.validate_secured_by=function(property){var secScheme,secSchemes,securitySchemeName,_i,_len,_ref1,_results;if(!util.isSequence(property[1]))throw new exports.ValidationError("while validating securityScheme",null,"property 'securedBy' must be an array",property[0].start_mark);if(secSchemes=this.get_list_values(property[1].value),
this.hasDuplicates(secSchemes))throw new exports.ValidationError("while validating securityScheme consumption",null,"securitySchemes can only be referenced once in a securedBy property",property[0].start_mark);for(_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(secScheme=_ref1[_i],util.isSequence(secScheme))throw new exports.ValidationError("while validating securityScheme consumption",null,"securityScheme reference cannot be an array",secScheme.start_mark);if(util.isNull(secScheme))_results.push(void 0);else{if(securitySchemeName=this.key_or_value(secScheme),!this.get_security_scheme(securitySchemeName))throw new exports.ValidationError("while validating securityScheme consumption",null,"there is no securityScheme named "+securitySchemeName,secScheme.start_mark);_results.push(void 0)}}return _results},Validator.prototype.validate_protocols_property=function(property){var protocol,_i,_len,_ref1,_ref2,_results;if(!util.isSequence(property[1]))throw new exports.ValidationError("while validating protocols",null,"property must be an array",property[0].start_mark);for(_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(protocol=_ref1[_i],!util.isString(protocol))throw new exports.ValidationError("while validating protocols",null,"value must be a string",protocol.start_mark);if("HTTP"!==(_ref2=protocol.value)&&"HTTPS"!==_ref2)throw new exports.ValidationError("while validating protocols",null,"only HTTP and HTTPS values are allowed",protocol.start_mark);_results.push(void 0)}return _results},Validator.prototype.validate_type_property=function(property){var parameter,typeName,_i,_len,_ref1,_results;if(!util.isMapping(property[1])&&!util.isString(property[1]))throw new exports.ValidationError("while validating resource types",null,"property 'type' must be a string or a map",property[0].start_mark);if(util.isMapping(property[1])&&property[1].value.length>1)throw new exports.ValidationError("while validating resource types",null,"a resource or resourceType can inherit from a single resourceType",property[0].start_mark);if(typeName=this.key_or_value(property[1]),!(null!=typeName?typeName.trim():void 0))throw new exports.ValidationError("while validating resource type consumption",null,"resource type name must be provided",property[1].start_mark);if(!this.isParameterKeyValue(typeName)&&!this.get_type(typeName))throw new exports.ValidationError("while validating resource type consumption",null,"there is no resource type named "+typeName,property[1].start_mark);if(util.isMapping(property[1])){for(_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(parameter=_ref1[_i],!util.isNull(parameter[1])&&!util.isMapping(parameter[1]))throw new exports.ValidationError("while validating resource consumption",null,"resource type parameters must be in a map",parameter[1].start_mark);_results.push(void 0)}return _results}},Validator.prototype.validate_method=function(method,allowParameterKeys,context){var canonicalKey,key,methodProperties,property,valid,_i,_len,_ref1,_results;if(null==context&&(context="method"),!util.isNull(method[1])){if(!util.isMapping(method[1]))throw new exports.ValidationError("while validating methods",null,"method must be a map",method[0].start_mark);for(methodProperties={},_ref1=method[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)if(property=_ref1[_i],this.trackRepeatedProperties(methodProperties,this.canonicalizePropertyName(property[0].value,!0),property[0],"while validating method","property already used"),!this.validate_common_properties(property,allowParameterKeys,context)){switch(key=property[0].value,canonicalKey=this.canonicalizePropertyName(key,allowParameterKeys),valid=!0,canonicalKey){case"headers":this.validate_headers(property,allowParameterKeys);break;case"queryParameters":this.validate_query_params(property,allowParameterKeys);break;case"body":this.validate_body(property,allowParameterKeys,null,!1);break;case"responses":this.validate_responses(property,allowParameterKeys);break;case"baseUriParameters":if(!this.baseUri)throw new exports.ValidationError("while validating uri parameters",null,"base uri parameters defined when there is no baseUri",property[0].start_mark);if(!util.isNullableMapping(property[1]))throw new exports.ValidationError("while validating uri parameters",null,"base uri parameters must be a map",property[0].start_mark);this.validate_uri_parameters(this.baseUri,property[1],allowParameterKeys);break;case"protocols":this.validate_protocols_property(property);break;default:valid=!1}switch(key){case"securedBy":_results.push(this.validate_secured_by(property));break;case"usage":if(!allowParameterKeys||"trait"!==context)throw new exports.ValidationError("while validating resources",null,"property: 'usage' is invalid in a "+context,property[0].start_mark);_results.push(void 0);break;default:if(!valid)throw new exports.ValidationError("while validating resources",null,"property: '"+property[0].value+"' is invalid in a "+context,property[0].start_mark);_results.push(void 0)}}return _results}},Validator.prototype.validate_responses=function(responses,allowParameterKeys){var response,responseValues,_i,_len,_ref1,_results;if(!util.isNull(responses[1])){if(!util.isMapping(responses[1]))throw new exports.ValidationError("while validating responses",null,"property: 'responses' must be a map",responses[0].start_mark);for(responseValues={},_ref1=responses[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(response=_ref1[_i],!util.isNullableMapping(response[1]))throw new exports.ValidationError("while validating responses",null,"each response must be a map",response[1].start_mark);this.trackRepeatedProperties(responseValues,this.canonicalizePropertyName(response[0].value,!0),response[0],"while validating responses","response code already used"),_results.push(this.validate_response(response,allowParameterKeys))}return _results}},Validator.prototype.validate_query_params=function(property,allowParameterKeys){var param,queryParameters,_i,_len,_ref1,_results;if(!util.isNull(property[1])){if(!util.isMapping(property[1]))throw new exports.ValidationError("while validating query parameters",null,"property: 'queryParameters' must be a map",property[0].start_mark);for(queryParameters={},_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(param=_ref1[_i],!util.isNullableMapping(param[1])&&!util.isNullableSequence(param[1]))throw new exports.ValidationError("while validating query parameters",null,"each query parameter must be a map",param[1].start_mark);this.trackRepeatedProperties(queryParameters,this.canonicalizePropertyName(param[0].value,!0),param[0],"while validating query parameter","parameter name already used"),_results.push(this.valid_common_parameter_properties(param[1],allowParameterKeys))}return _results}},Validator.prototype.validate_form_params=function(property,allowParameterKeys){var formParameters,param,_i,_len,_ref1,_results;if(!util.isNull(property[1])){if(!util.isMapping(property[1]))throw new exports.ValidationError("while validating query parameters",null,"property: 'formParameters' must be a map",property[0].start_mark);for(formParameters={},_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(param=_ref1[_i],!util.isNullableMapping(param[1])&&!util.isNullableSequence(param[1]))throw new exports.ValidationError("while validating query parameters",null,"each form parameter must be a map",param[1].start_mark);this.trackRepeatedProperties(formParameters,this.canonicalizePropertyName(param[0].value,!0),param[0],"while validating form parameter","parameter name already used"),_results.push(this.valid_common_parameter_properties(param[1],allowParameterKeys))}return _results}},Validator.prototype.validate_headers=function(property,allowParameterKeys){var headerNames,param,_i,_len,_ref1,_results;if(!util.isNull(property[1])){if(!util.isMapping(property[1]))throw new exports.ValidationError("while validating headers",null,"property: 'headers' must be a map",property[0].start_mark);for(headerNames={},_ref1=property[1].value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(param=_ref1[_i],!util.isNullableMapping(param[1])&&!util.isNullableSequence(param[1]))throw new exports.ValidationError("while validating query parameters",null,"each header must be a map",param[1].start_mark);this.trackRepeatedProperties(headerNames,this.canonicalizePropertyName(param[0].value,!0),param[0],"while validating headers","header name already used"),_results.push(this.valid_common_parameter_properties(param[1],allowParameterKeys))}return _results}},Validator.prototype.validate_response=function(response,allowParameterKeys){var canonicalKey,property,responseCode,responseProperties,valid,_i,_j,_len,_len1,_ref1,_ref2,_results;if(util.isSequence(response[0])){if(!response[0].value.length)throw new exports.ValidationError("while validating responses",null,"there must be at least one response code",response[0].start_mark);for(_ref1=response[0].value,_i=0,_len=_ref1.length;_i<_len;_i++)if(responseCode=_ref1[_i],!this.isParameterKey(responseCode)&&!util.isInteger(responseCode)&&isNaN(this.canonicalizePropertyName(responseCode,allowParameterKeys)))throw new exports.ValidationError("while validating responses",null,"each response key must be an integer",responseCode.start_mark)}else if(!this.isParameterKey(response)&&!util.isInteger(response[0])&&isNaN(this.canonicalizePropertyName(response[0].value,allowParameterKeys)))throw new exports.ValidationError("while validating responses",null,"each response key must be an integer",response[0].start_mark);if(!util.isNullableMapping(response[1]))throw new exports.ValidationError("while validating responses",null,"each response property must be a map",response[0].start_mark);if(util.isMapping(response[1])){for(responseProperties={},_ref2=response[1].value,_results=[],_j=0,_len1=_ref2.length;_j<_len1;_j++)if(property=_ref2[_j],canonicalKey=this.canonicalizePropertyName(property[0].value,allowParameterKeys),this.trackRepeatedProperties(responseProperties,canonicalKey,property[0],"while validating responses","property already used"),valid=!0,this.isParameterKey(property))_results.push(void 0);else{switch(property[0].value){case"description":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating responses",null,"property description must be a string",response[0].start_mark);break;default:valid=!1}switch(canonicalKey){case"body":_results.push(this.validate_body(property,allowParameterKeys,null,!0));break;case"headers":if(!util.isNullableMapping(property[1]))throw new exports.ValidationError("while validating resources",null,"property 'headers' must be a map",property[0].start_mark);_results.push(this.validate_headers(property));break;default:if(!valid)throw new exports.ValidationError("while validating response",null,"property: '"+property[0].value+"' is invalid in a response",property[0].start_mark);_results.push(void 0)}}return _results}},Validator.prototype.isHttpMethod=function(value,allowParameterKeys){var _ref1;return null==allowParameterKeys&&(allowParameterKeys=!1),!!value&&(value=this.canonicalizePropertyName(value,allowParameterKeys),"options"===(_ref1=value.toLowerCase())||"get"===_ref1||"head"===_ref1||"post"===_ref1||"put"===_ref1||"delete"===_ref1||"trace"===_ref1||"connect"===_ref1||"patch"===_ref1)},Validator.prototype.isParameterValue=function(property){return this.isParameterKey(property,!1)},Validator.prototype.isParameterKey=function(property,checkKey){var offset;if(null==checkKey&&(checkKey=!0),offset=checkKey?0:1,!checkKey&&!util.isScalar(property[1]))return!1;if(this.isParameterKeyValue(property[offset].value))return!0;if(property[offset].value.match(/<<\s*([^\|\s>]+)\s*\|.*\s*>>/g))throw new exports.ValidationError("while validating parameter",null,"unknown function applied to property name",property[0].start_mark);return!1},Validator.prototype.isParameterKeyValue=function(value){return!(!value.match(/<<\s*([^\|\s>]+)\s*>>/g)&&!value.match(/<<\s*([^\|\s>]+)\s*(\|\s*\!\s*(singularize|pluralize))?\s*>>/g))},Validator.prototype.validate_body=function(property,allowParameterKeys,bodyMode,isResponseBody){var bodyProperties,bodyProperty,canonicalProperty,implicitMode,key,start_mark,valid,_i,_len,_ref1;if(null==bodyMode&&(bodyMode=null),!util.isNull(property[1])){if(!util.isMapping(property[1]))throw new exports.ValidationError("while validating body",null,"property: body specification must be a map",property[0].start_mark);for(implicitMode=["implicit","forcedImplicit"],bodyProperties={},_ref1=property[1].value,_i=0,_len=_ref1.length;_i<_len;_i++)if(bodyProperty=_ref1[_i],this.trackRepeatedProperties(bodyProperties,this.canonicalizePropertyName(bodyProperty[0].value,!0),bodyProperty[0],"while validating body","property already used"),this.isParameterKey(bodyProperty)){if(!allowParameterKeys)throw new exports.ValidationError("while validating body",null,"property '"+bodyProperty[0].value+"' is invalid in a resource",bodyProperty[0].start_mark)}else if(bodyProperty[0].value.match(/^[^\/]+\/[^\/]+$/)){if(bodyMode&&"explicit"!==bodyMode)throw new exports.ValidationError("while validating body",null,"not compatible with implicit default Media Type",bodyProperty[0].start_mark);bodyMode="explicit",this.validate_body(bodyProperty,allowParameterKeys,"forcedImplicit",isResponseBody)}else{switch(key=bodyProperty[0].value,canonicalProperty=this.canonicalizePropertyName(key,allowParameterKeys),valid=!0,canonicalProperty){case"formParameters":if(bodyMode&&__indexOf.call(implicitMode,bodyMode)<0)throw new exports.ValidationError("while validating body",null,"not compatible with explicit Media Type",bodyProperty[0].start_mark);null==bodyMode&&(bodyMode="implicit"),this.validate_form_params(bodyProperty,allowParameterKeys);break;default:valid=!1}switch(key){case"example":if(bodyMode&&__indexOf.call(implicitMode,bodyMode)<0)throw new exports.ValidationError("while validating body",null,"not compatible with explicit Media Type",bodyProperty[0].start_mark);if(null==bodyMode&&(bodyMode="implicit"),!util.isScalar(bodyProperty[1]))throw new exports.ValidationError("while validating body",null,"example must be a string",bodyProperty[0].start_mark);break;case"schema":if(bodyMode&&__indexOf.call(implicitMode,bodyMode)<0)throw new exports.ValidationError("while validating body",null,"not compatible with explicit Media Type",bodyProperty[0].start_mark);if(null==bodyMode&&(bodyMode="implicit"),!util.isScalar(bodyProperty[1]))throw new exports.ValidationError("while validating body",null,"schema must be a string",bodyProperty[0].start_mark);this.validateSchema(bodyProperty[1]);break;default:if(!valid)throw new exports.ValidationError("while validating body",null,"property: '"+bodyProperty[0].value+"' is invalid in a body",bodyProperty[0].start_mark)}}if("formParameters"in bodyProperties){if(start_mark=bodyProperties.formParameters.start_mark,isResponseBody)throw new exports.ValidationError("while validating body",null,"formParameters cannot be used to describe response bodies",start_mark);if("schema"in bodyProperties||"example"in bodyProperties)throw new exports.ValidationError("while validating body",null,"formParameters cannot be used together with the example or schema properties",start_mark)}if("implicit"===bodyMode&&!this.get_media_type())throw new exports.ValidationError("while validating body",null,"body tries to use default Media Type, but mediaType is null",property[0].start_mark)}},Validator.prototype.validateSchema=function(property){var error,lint,mark,schema;if(!this.isXmlSchema(property.value)&&this.isJsonSchema(property.value)){if(lint=jsonlint(property.value),lint.error)throw mark=this.create_mark(property.start_mark.line+lint.line,0),property.end_mark.line===mark.line&&0===property.end_mark.column&&mark.line--,new exports.ValidationError("while validating body",null,"schema is not valid JSON error: '"+lint.error+"'",mark);try{return schema=JSON.parse(property.value)}catch(_error){throw error=_error,new exports.ValidationError("while validating body",null,"schema is not valid JSON error: '"+error+"'",property.start_mark)}}},Validator.prototype.isJsonSchema=function(string){return null!=string?string.match(/^\s*\{/):void 0},Validator.prototype.isXmlSchema=function(string){return null!=string?string.match(/^\s*(<\?xml[^>]+>)?[\s\n]*<xs:schema/):void 0},Validator.prototype.validate_common_properties=function(property,allowParameterKeys,context){var use,_i,_len,_ref1;if(this.isParameterKey(property)){if(!allowParameterKeys)throw new exports.ValidationError("while validating resources",null,"property '"+property[0].value+"' is invalid in a resource",property[0].start_mark);return!0}switch(property[0].value){case"displayName":if("method"===context)return!1;if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating resources",null,"property 'displayName' must be a string",property[0].start_mark);return!0;case"description":if(!util.isScalar(property[1]))throw new exports.ValidationError("while validating resources",null,"property 'description' must be a string",property[0].start_mark);return!0;case"is":if(!util.isSequence(property[1]))throw new exports.ValidationError("while validating resources",null,"property 'is' must be an array",property[0].start_mark);for(_ref1=property[1].value,_i=0,_len=_ref1.length;_i<_len;_i++)use=_ref1[_i],this.validate_trait_use(use);return!0}return!1},Validator.prototype.validate_trait_use=function(node){var parameter,traitName,traitValue,_i,_len,_ref1,_results;if(!util.isScalar(node)&&!util.isMapping(node))throw new exports.ValidationError("while validating trait consumption",null,"trait must be a string or a map",node.start_mark);if(traitName=this.key_or_value(node),!(null!=traitName?traitName.trim():void 0))throw new exports.ValidationError("while validating trait consumption",null,"trait name must be provided",node.start_mark);if(!this.isParameterKeyValue(traitName)&&!this.get_trait(traitName))throw new exports.ValidationError("while validating trait consumption",null,"there is no trait named "+traitName,node.start_mark);if(!util.isScalar(node)){if(traitValue=node.value[0][1],!util.isNull(traitValue)&&!util.isMapping(traitValue))throw new exports.ValidationError("while validating trait consumption",null,"trait must be a map",traitValue.start_mark);if(!util.isNull(traitValue)){for(_ref1=traitValue.value,_results=[],_i=0,_len=_ref1.length;_i<_len;_i++){if(parameter=_ref1[_i],!util.isScalar(parameter[1]))throw new exports.ValidationError("while validating trait consumption",null,"parameter value must be a scalar",parameter[1].start_mark);_results.push(void 0)}return _results}}},Validator.prototype.child_methods=function(node){var _this=this;return node&&util.isMapping(node)?node.value.filter(function(childNode){return _this.isHttpMethod(childNode[0].value)}):[]},Validator.prototype.has_property=function(node,property){return!(!node||!util.isMapping(node))&&node.value.some(function(childNode){return childNode[0].value&&"object"!=typeof childNode[0].value&&childNode[0].value===property})},Validator.prototype.property_value=function(node,property){var filteredNodes;if(filteredNodes=node.value.filter(function(childNode){return"object"!=typeof childNode[0].value&&childNode[0].value===property}),filteredNodes.length)return filteredNodes[0][1].value},Validator.prototype.get_property=function(node,property){var filteredNodes;return node&&util.isMapping(node)&&(filteredNodes=node.value.filter(function(childNode){return util.isString(childNode[0])&&childNode[0].value===property}),filteredNodes.length>0&&filteredNodes[0].length>0)?filteredNodes[0][1]:[]},Validator.prototype.get_properties=function(node,property){var prop,properties,_i,_len,_ref1;if(properties=[],node&&util.isMapping(node))for(_ref1=node.value,_i=0,_len=_ref1.length;_i<_len;_i++)prop=_ref1[_i],util.isString(prop[0])&&prop[0].value===property?properties.push(prop):properties=properties.concat(this.get_properties(prop[1],property));return properties},Validator.prototype.valid_absolute_uris=function(node){var repeatedUri,uris;if(uris=this.get_absolute_uris(node),repeatedUri=this.hasDuplicatesUris(uris))throw new exports.ValidationError("while validating trait consumption",null,"two resources share same URI "+repeatedUri.uri,repeatedUri.mark)},Validator.prototype.get_absolute_uris=function(node,parentPath){var childResource,child_resources,response,uri,_i,_len;if(response=[],!util.isNullableMapping(node))throw new exports.ValidationError("while validating resources",null,"resource is not a map",node.start_mark);for(child_resources=this.child_resources(node),_i=0,_len=child_resources.length;_i<_len;_i++)childResource=child_resources[_i],uri=null!=parentPath?parentPath+childResource[0].value:childResource[0].value,response.push({uri:uri,mark:childResource[0].start_mark}),response=response.concat(this.get_absolute_uris(childResource[1],uri));return response},Validator.prototype.key_or_value=function(node){var possibleKeyName,_ref1,_ref2,_ref3;return node instanceof nodes.ScalarNode?node.value:node instanceof nodes.MappingNode&&(possibleKeyName=null!=node&&null!=(_ref1=node.value)&&null!=(_ref2=_ref1[0])&&null!=(_ref3=_ref2[0])?_ref3.value:void 0)?possibleKeyName:null},Validator.prototype.value_or_undefined=function(node){if(node instanceof nodes.MappingNode)return node.value},Validator.prototype.validate_base_uri=function(baseUriNode){var baseUri,err,expressions,protocol,template,_ref1,_ref2;if(baseUri=null!=(_ref1=baseUriNode.value)?_ref1.trim():void 0,!baseUri)throw new exports.ValidationError("while validating baseUri",null,"baseUri must have a value",baseUriNode.start_mark);if(protocol=(url.parse(baseUri).protocol||"http:").slice(0,-1).toUpperCase(),"HTTP"!==protocol&&"HTTPS"!==protocol)throw new exports.ValidationError("while validating baseUri",null,"baseUri protocol must be either HTTP or HTTPS",baseUriNode.start_mark);try{template=uritemplate.parse(baseUri)}catch(_error){throw err=_error,new exports.ValidationError("while validating baseUri",null,null!=err&&null!=(_ref2=err.options)?_ref2.message:void 0,baseUriNode.start_mark)}if(expressions=template.expressions.filter(function(expr){return"templateText"in expr}).map(function(expression){return expression.templateText}),__indexOf.call(expressions,"version")>=0)return!0},Validator.prototype.get_validation_errors=function(){return this.validation_errors},Validator.prototype.is_valid=function(){return 0===this.validation_errors.length},Validator.prototype.hasDuplicatesUris=function(array){var item,output,_i,_len;for(output={},_i=0,_len=array.length;_i<_len;_i++){if(item=array[_i],item.uri in output)return item;output[item.uri]=item}return!1},Validator.prototype.hasDuplicates=function(array){var item,output,_i,_len;for(output={},_i=0,_len=array.length;_i<_len;_i++){if(item=array[_i],item in output)return!0;output[item]=!0}return!1},Validator}()}).call(this)},{"./errors":35,"./nodes":39,"./traits":50,"./util":52,"json-lint":23,uritemplate:67,url:15}],54:[function(require,module,exports){module.exports=require("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":55}],55:[function(require,module,exports){"use strict";function Duplex(options){return this instanceof Duplex?(Readable.call(this,options),Writable.call(this,options),options&&options.readable===!1&&(this.readable=!1),options&&options.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,options&&options.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",onend)):new Duplex(options)}function onend(){this.allowHalfOpen||this._writableState.ended||processNextTick(onEndNT,this)}function onEndNT(self){self.end()}var objectKeys=Object.keys||function(obj){var keys=[];for(var key in obj)keys.push(key);return keys};module.exports=Duplex;var processNextTick=require("process-nextick-args"),util=require("core-util-is");util.inherits=require("inherits");var Readable=require("./_stream_readable"),Writable=require("./_stream_writable");util.inherits(Duplex,Readable);for(var keys=objectKeys(Writable.prototype),v=0;v<keys.length;v++){var method=keys[v];Duplex.prototype[method]||(Duplex.prototype[method]=Writable.prototype[method])}},{"./_stream_readable":57,"./_stream_writable":59,"core-util-is":3,inherits:20,"process-nextick-args":26}],56:[function(require,module,exports){"use strict";function PassThrough(options){return this instanceof PassThrough?void Transform.call(this,options):new PassThrough(options)}module.exports=PassThrough;var Transform=require("./_stream_transform"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(PassThrough,Transform),PassThrough.prototype._transform=function(chunk,encoding,cb){cb(null,chunk)}},{"./_stream_transform":58,"core-util-is":3,inherits:20}],57:[function(require,module,exports){(function(process){"use strict";function prependListener(emitter,event,fn){return"function"==typeof emitter.prependListener?emitter.prependListener(event,fn):void(emitter._events&&emitter._events[event]?isArray(emitter._events[event])?emitter._events[event].unshift(fn):emitter._events[event]=[fn,emitter._events[event]]:emitter.on(event,fn))}function ReadableState(options,stream){Duplex=Duplex||require("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.readableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.buffer=new BufferList,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=options.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,options.encoding&&(StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this.decoder=new StringDecoder(options.encoding),this.encoding=options.encoding)}function Readable(options){return Duplex=Duplex||require("./_stream_duplex"),this instanceof Readable?(this._readableState=new ReadableState(options,this),this.readable=!0,options&&"function"==typeof options.read&&(this._read=options.read),void Stream.call(this)):new Readable(options)}function readableAddChunk(stream,state,chunk,encoding,addToFront){var er=chunkInvalid(state,chunk);if(er)stream.emit("error",er);else if(null===chunk)state.reading=!1,onEofChunk(stream,state);else if(state.objectMode||chunk&&chunk.length>0)if(state.ended&&!addToFront){var e=new Error("stream.push() after EOF");stream.emit("error",e)}else if(state.endEmitted&&addToFront){var _e=new Error("stream.unshift() after end event");stream.emit("error",_e)}else{var skipAdd;!state.decoder||addToFront||encoding||(chunk=state.decoder.write(chunk),skipAdd=!state.objectMode&&0===chunk.length),addToFront||(state.reading=!1),skipAdd||(state.flowing&&0===state.length&&!state.sync?(stream.emit("data",chunk),stream.read(0)):(state.length+=state.objectMode?1:chunk.length,addToFront?state.buffer.unshift(chunk):state.buffer.push(chunk),state.needReadable&&emitReadable(stream))),maybeReadMore(stream,state)}else addToFront||(state.reading=!1);return needMoreData(state)}function needMoreData(state){return!state.ended&&(state.needReadable||state.length<state.highWaterMark||0===state.length)}function computeNewHighWaterMark(n){return n>=MAX_HWM?n=MAX_HWM:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n}function howMuchToRead(n,state){return n<=0||0===state.length&&state.ended?0:state.objectMode?1:n!==n?state.flowing&&state.length?state.buffer.head.data.length:state.length:(n>state.highWaterMark&&(state.highWaterMark=computeNewHighWaterMark(n)),n<=state.length?n:state.ended?state.length:(state.needReadable=!0,0))}function chunkInvalid(state,chunk){var er=null;return Buffer.isBuffer(chunk)||"string"==typeof chunk||null===chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er}function onEofChunk(stream,state){if(!state.ended){if(state.decoder){var chunk=state.decoder.end();chunk&&chunk.length&&(state.buffer.push(chunk),state.length+=state.objectMode?1:chunk.length)}state.ended=!0,emitReadable(stream)}}function emitReadable(stream){var state=stream._readableState;state.needReadable=!1,state.emittedReadable||(debug("emitReadable",state.flowing),state.emittedReadable=!0,state.sync?processNextTick(emitReadable_,stream):emitReadable_(stream))}function emitReadable_(stream){debug("emit readable"),stream.emit("readable"),flow(stream)}function maybeReadMore(stream,state){state.readingMore||(state.readingMore=!0,processNextTick(maybeReadMore_,stream,state))}function maybeReadMore_(stream,state){for(var len=state.length;!state.reading&&!state.flowing&&!state.ended&&state.length<state.highWaterMark&&(debug("maybeReadMore read 0"),stream.read(0),len!==state.length);)len=state.length;state.readingMore=!1}function pipeOnDrain(src){return function(){var state=src._readableState;debug("pipeOnDrain",state.awaitDrain),state.awaitDrain&&state.awaitDrain--,0===state.awaitDrain&&EElistenerCount(src,"data")&&(state.flowing=!0,flow(src))}}function nReadingNextTick(self){debug("readable nexttick read 0"),self.read(0)}function resume(stream,state){state.resumeScheduled||(state.resumeScheduled=!0,processNextTick(resume_,stream,state))}function resume_(stream,state){state.reading||(debug("resume read 0"),stream.read(0)),state.resumeScheduled=!1,state.awaitDrain=0,stream.emit("resume"),flow(stream),state.flowing&&!state.reading&&stream.read(0)}function flow(stream){var state=stream._readableState;for(debug("flow",state.flowing);state.flowing&&null!==stream.read(););}function fromList(n,state){if(0===state.length)return null;var ret;return state.objectMode?ret=state.buffer.shift():!n||n>=state.length?(ret=state.decoder?state.buffer.join(""):1===state.buffer.length?state.buffer.head.data:state.buffer.concat(state.length),state.buffer.clear()):ret=fromListPartial(n,state.buffer,state.decoder),ret}function fromListPartial(n,list,hasStrings){var ret;return n<list.head.data.length?(ret=list.head.data.slice(0,n),list.head.data=list.head.data.slice(n)):ret=n===list.head.data.length?list.shift():hasStrings?copyFromBufferString(n,list):copyFromBuffer(n,list),ret}function copyFromBufferString(n,list){var p=list.head,c=1,ret=p.data;for(n-=ret.length;p=p.next;){var str=p.data,nb=n>str.length?str.length:n;if(ret+=nb===str.length?str:str.slice(0,n),n-=nb,0===n){nb===str.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=str.slice(nb));break}++c}return list.length-=c,ret}function copyFromBuffer(n,list){var ret=bufferShim.allocUnsafe(n),p=list.head,c=1;for(p.data.copy(ret),n-=p.data.length;p=p.next;){var buf=p.data,nb=n>buf.length?buf.length:n;if(buf.copy(ret,ret.length-n,0,nb),n-=nb,0===n){nb===buf.length?(++c,p.next?list.head=p.next:list.head=list.tail=null):(list.head=p,p.data=buf.slice(nb));break}++c}return list.length-=c,ret}function endReadable(stream){var state=stream._readableState;if(state.length>0)throw new Error('"endReadable()" called on non-empty stream');state.endEmitted||(state.ended=!0,processNextTick(endReadableNT,state,stream))}function endReadableNT(state,stream){state.endEmitted||0!==state.length||(state.endEmitted=!0,stream.readable=!1,stream.emit("end"))}function forEach(xs,f){for(var i=0,l=xs.length;i<l;i++)f(xs[i],i)}function indexOf(xs,x){for(var i=0,l=xs.length;i<l;i++)if(xs[i]===x)return i;return-1}module.exports=Readable;var Duplex,processNextTick=require("process-nextick-args"),isArray=require("isarray");Readable.ReadableState=ReadableState;var Stream,EElistenerCount=(require("events").EventEmitter,function(emitter,type){return emitter.listeners(type).length});
!function(){try{Stream=require("stream")}catch(_){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,bufferShim=require("buffer-shims"),util=require("core-util-is");util.inherits=require("inherits");var debugUtil=require("util"),debug=void 0;debug=debugUtil&&debugUtil.debuglog?debugUtil.debuglog("stream"):function(){};var StringDecoder,BufferList=require("./internal/streams/BufferList");util.inherits(Readable,Stream),Readable.prototype.push=function(chunk,encoding){var state=this._readableState;return state.objectMode||"string"!=typeof chunk||(encoding=encoding||state.defaultEncoding,encoding!==state.encoding&&(chunk=bufferShim.from(chunk,encoding),encoding="")),readableAddChunk(this,state,chunk,encoding,!1)},Readable.prototype.unshift=function(chunk){var state=this._readableState;return readableAddChunk(this,state,chunk,"",!0)},Readable.prototype.isPaused=function(){return this._readableState.flowing===!1},Readable.prototype.setEncoding=function(enc){return StringDecoder||(StringDecoder=require("string_decoder/").StringDecoder),this._readableState.decoder=new StringDecoder(enc),this._readableState.encoding=enc,this};var MAX_HWM=8388608;Readable.prototype.read=function(n){debug("read",n),n=parseInt(n,10);var state=this._readableState,nOrig=n;if(0!==n&&(state.emittedReadable=!1),0===n&&state.needReadable&&(state.length>=state.highWaterMark||state.ended))return debug("read: emitReadable",state.length,state.ended),0===state.length&&state.ended?endReadable(this):emitReadable(this),null;if(n=howMuchToRead(n,state),0===n&&state.ended)return 0===state.length&&endReadable(this),null;var doRead=state.needReadable;debug("need readable",doRead),(0===state.length||state.length-n<state.highWaterMark)&&(doRead=!0,debug("length less than watermark",doRead)),state.ended||state.reading?(doRead=!1,debug("reading or ended",doRead)):doRead&&(debug("do read"),state.reading=!0,state.sync=!0,0===state.length&&(state.needReadable=!0),this._read(state.highWaterMark),state.sync=!1,state.reading||(n=howMuchToRead(nOrig,state)));var ret;return ret=n>0?fromList(n,state):null,null===ret?(state.needReadable=!0,n=0):state.length-=n,0===state.length&&(state.ended||(state.needReadable=!0),nOrig!==n&&state.ended&&endReadable(this)),null!==ret&&this.emit("data",ret),ret},Readable.prototype._read=function(n){this.emit("error",new Error("_read() is not implemented"))},Readable.prototype.pipe=function(dest,pipeOpts){function onunpipe(readable){debug("onunpipe"),readable===src&&cleanup()}function onend(){debug("onend"),dest.end()}function cleanup(){debug("cleanup"),dest.removeListener("close",onclose),dest.removeListener("finish",onfinish),dest.removeListener("drain",ondrain),dest.removeListener("error",onerror),dest.removeListener("unpipe",onunpipe),src.removeListener("end",onend),src.removeListener("end",cleanup),src.removeListener("data",ondata),cleanedUp=!0,!state.awaitDrain||dest._writableState&&!dest._writableState.needDrain||ondrain()}function ondata(chunk){debug("ondata"),increasedAwaitDrain=!1;var ret=dest.write(chunk);!1!==ret||increasedAwaitDrain||((1===state.pipesCount&&state.pipes===dest||state.pipesCount>1&&indexOf(state.pipes,dest)!==-1)&&!cleanedUp&&(debug("false write response, pause",src._readableState.awaitDrain),src._readableState.awaitDrain++,increasedAwaitDrain=!0),src.pause())}function onerror(er){debug("onerror",er),unpipe(),dest.removeListener("error",onerror),0===EElistenerCount(dest,"error")&&dest.emit("error",er)}function onclose(){dest.removeListener("finish",onfinish),unpipe()}function onfinish(){debug("onfinish"),dest.removeListener("close",onclose),unpipe()}function unpipe(){debug("unpipe"),src.unpipe(dest)}var src=this,state=this._readableState;switch(state.pipesCount){case 0:state.pipes=dest;break;case 1:state.pipes=[state.pipes,dest];break;default:state.pipes.push(dest)}state.pipesCount+=1,debug("pipe count=%d opts=%j",state.pipesCount,pipeOpts);var doEnd=(!pipeOpts||pipeOpts.end!==!1)&&dest!==process.stdout&&dest!==process.stderr,endFn=doEnd?onend:cleanup;state.endEmitted?processNextTick(endFn):src.once("end",endFn),dest.on("unpipe",onunpipe);var ondrain=pipeOnDrain(src);dest.on("drain",ondrain);var cleanedUp=!1,increasedAwaitDrain=!1;return src.on("data",ondata),prependListener(dest,"error",onerror),dest.once("close",onclose),dest.once("finish",onfinish),dest.emit("pipe",src),state.flowing||(debug("pipe resume"),src.resume()),dest},Readable.prototype.unpipe=function(dest){var state=this._readableState;if(0===state.pipesCount)return this;if(1===state.pipesCount)return dest&&dest!==state.pipes?this:(dest||(dest=state.pipes),state.pipes=null,state.pipesCount=0,state.flowing=!1,dest&&dest.emit("unpipe",this),this);if(!dest){var dests=state.pipes,len=state.pipesCount;state.pipes=null,state.pipesCount=0,state.flowing=!1;for(var i=0;i<len;i++)dests[i].emit("unpipe",this);return this}var index=indexOf(state.pipes,dest);return index===-1?this:(state.pipes.splice(index,1),state.pipesCount-=1,1===state.pipesCount&&(state.pipes=state.pipes[0]),dest.emit("unpipe",this),this)},Readable.prototype.on=function(ev,fn){var res=Stream.prototype.on.call(this,ev,fn);if("data"===ev)this._readableState.flowing!==!1&&this.resume();else if("readable"===ev){var state=this._readableState;state.endEmitted||state.readableListening||(state.readableListening=state.needReadable=!0,state.emittedReadable=!1,state.reading?state.length&&emitReadable(this,state):processNextTick(nReadingNextTick,this))}return res},Readable.prototype.addListener=Readable.prototype.on,Readable.prototype.resume=function(){var state=this._readableState;return state.flowing||(debug("resume"),state.flowing=!0,resume(this,state)),this},Readable.prototype.pause=function(){return debug("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(debug("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Readable.prototype.wrap=function(stream){var state=this._readableState,paused=!1,self=this;stream.on("end",function(){if(debug("wrapped end"),state.decoder&&!state.ended){var chunk=state.decoder.end();chunk&&chunk.length&&self.push(chunk)}self.push(null)}),stream.on("data",function(chunk){if(debug("wrapped data"),state.decoder&&(chunk=state.decoder.write(chunk)),(!state.objectMode||null!==chunk&&void 0!==chunk)&&(state.objectMode||chunk&&chunk.length)){var ret=self.push(chunk);ret||(paused=!0,stream.pause())}});for(var i in stream)void 0===this[i]&&"function"==typeof stream[i]&&(this[i]=function(method){return function(){return stream[method].apply(stream,arguments)}}(i));var events=["error","close","destroy","pause","resume"];return forEach(events,function(ev){stream.on(ev,self.emit.bind(self,ev))}),self._read=function(n){debug("wrapped _read",n),paused&&(paused=!1,stream.resume())},self},Readable._fromList=fromList}).call(this,require("_process"))},{"./_stream_duplex":55,"./internal/streams/BufferList":60,_process:27,buffer:6,"buffer-shims":2,"core-util-is":3,events:9,inherits:20,isarray:22,"process-nextick-args":26,"string_decoder/":66,util:1}],58:[function(require,module,exports){"use strict";function TransformState(stream){this.afterTransform=function(er,data){return afterTransform(stream,er,data)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function afterTransform(stream,er,data){var ts=stream._transformState;ts.transforming=!1;var cb=ts.writecb;if(!cb)return stream.emit("error",new Error("no writecb in Transform class"));ts.writechunk=null,ts.writecb=null,null!==data&&void 0!==data&&stream.push(data),cb(er);var rs=stream._readableState;rs.reading=!1,(rs.needReadable||rs.length<rs.highWaterMark)&&stream._read(rs.highWaterMark)}function Transform(options){if(!(this instanceof Transform))return new Transform(options);Duplex.call(this,options),this._transformState=new TransformState(this);var stream=this;this._readableState.needReadable=!0,this._readableState.sync=!1,options&&("function"==typeof options.transform&&(this._transform=options.transform),"function"==typeof options.flush&&(this._flush=options.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(er,data){done(stream,er,data)}):done(stream)})}function done(stream,er,data){if(er)return stream.emit("error",er);null!==data&&void 0!==data&&stream.push(data);var ws=stream._writableState,ts=stream._transformState;if(ws.length)throw new Error("Calling transform done when ws.length != 0");if(ts.transforming)throw new Error("Calling transform done when still transforming");return stream.push(null)}module.exports=Transform;var Duplex=require("./_stream_duplex"),util=require("core-util-is");util.inherits=require("inherits"),util.inherits(Transform,Duplex),Transform.prototype.push=function(chunk,encoding){return this._transformState.needTransform=!1,Duplex.prototype.push.call(this,chunk,encoding)},Transform.prototype._transform=function(chunk,encoding,cb){throw new Error("_transform() is not implemented")},Transform.prototype._write=function(chunk,encoding,cb){var ts=this._transformState;if(ts.writecb=cb,ts.writechunk=chunk,ts.writeencoding=encoding,!ts.transforming){var rs=this._readableState;(ts.needTransform||rs.needReadable||rs.length<rs.highWaterMark)&&this._read(rs.highWaterMark)}},Transform.prototype._read=function(n){var ts=this._transformState;null!==ts.writechunk&&ts.writecb&&!ts.transforming?(ts.transforming=!0,this._transform(ts.writechunk,ts.writeencoding,ts.afterTransform)):ts.needTransform=!0}},{"./_stream_duplex":55,"core-util-is":3,inherits:20}],59:[function(require,module,exports){(function(process){"use strict";function nop(){}function WriteReq(chunk,encoding,cb){this.chunk=chunk,this.encoding=encoding,this.callback=cb,this.next=null}function WritableState(options,stream){Duplex=Duplex||require("./_stream_duplex"),options=options||{},this.objectMode=!!options.objectMode,stream instanceof Duplex&&(this.objectMode=this.objectMode||!!options.writableObjectMode);var hwm=options.highWaterMark,defaultHwm=this.objectMode?16:16384;this.highWaterMark=hwm||0===hwm?hwm:defaultHwm,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var noDecode=options.decodeStrings===!1;this.decodeStrings=!noDecode,this.defaultEncoding=options.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(er){onwrite(stream,er)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new CorkedRequest(this)}function Writable(options){return Duplex=Duplex||require("./_stream_duplex"),realHasInstance.call(Writable,this)||this instanceof Duplex?(this._writableState=new WritableState(options,this),this.writable=!0,options&&("function"==typeof options.write&&(this._write=options.write),"function"==typeof options.writev&&(this._writev=options.writev)),void Stream.call(this)):new Writable(options)}function writeAfterEnd(stream,cb){var er=new Error("write after end");stream.emit("error",er),processNextTick(cb,er)}function validChunk(stream,state,chunk,cb){var valid=!0,er=!1;return null===chunk?er=new TypeError("May not write null values to stream"):Buffer.isBuffer(chunk)||"string"==typeof chunk||void 0===chunk||state.objectMode||(er=new TypeError("Invalid non-string/buffer chunk")),er&&(stream.emit("error",er),processNextTick(cb,er),valid=!1),valid}function decodeChunk(state,chunk,encoding){return state.objectMode||state.decodeStrings===!1||"string"!=typeof chunk||(chunk=bufferShim.from(chunk,encoding)),chunk}function writeOrBuffer(stream,state,chunk,encoding,cb){chunk=decodeChunk(state,chunk,encoding),Buffer.isBuffer(chunk)&&(encoding="buffer");var len=state.objectMode?1:chunk.length;state.length+=len;var ret=state.length<state.highWaterMark;if(ret||(state.needDrain=!0),state.writing||state.corked){var last=state.lastBufferedRequest;state.lastBufferedRequest=new WriteReq(chunk,encoding,cb),last?last.next=state.lastBufferedRequest:state.bufferedRequest=state.lastBufferedRequest,state.bufferedRequestCount+=1}else doWrite(stream,state,!1,len,chunk,encoding,cb);return ret}function doWrite(stream,state,writev,len,chunk,encoding,cb){state.writelen=len,state.writecb=cb,state.writing=!0,state.sync=!0,writev?stream._writev(chunk,state.onwrite):stream._write(chunk,encoding,state.onwrite),state.sync=!1}function onwriteError(stream,state,sync,er,cb){--state.pendingcb,sync?processNextTick(cb,er):cb(er),stream._writableState.errorEmitted=!0,stream.emit("error",er)}function onwriteStateUpdate(state){state.writing=!1,state.writecb=null,state.length-=state.writelen,state.writelen=0}function onwrite(stream,er){var state=stream._writableState,sync=state.sync,cb=state.writecb;if(onwriteStateUpdate(state),er)onwriteError(stream,state,sync,er,cb);else{var finished=needFinish(state);finished||state.corked||state.bufferProcessing||!state.bufferedRequest||clearBuffer(stream,state),sync?asyncWrite(afterWrite,stream,state,finished,cb):afterWrite(stream,state,finished,cb)}}function afterWrite(stream,state,finished,cb){finished||onwriteDrain(stream,state),state.pendingcb--,cb(),finishMaybe(stream,state)}function onwriteDrain(stream,state){0===state.length&&state.needDrain&&(state.needDrain=!1,stream.emit("drain"))}function clearBuffer(stream,state){state.bufferProcessing=!0;var entry=state.bufferedRequest;if(stream._writev&&entry&&entry.next){var l=state.bufferedRequestCount,buffer=new Array(l),holder=state.corkedRequestsFree;holder.entry=entry;for(var count=0;entry;)buffer[count]=entry,entry=entry.next,count+=1;doWrite(stream,state,!0,state.length,buffer,"",holder.finish),state.pendingcb++,state.lastBufferedRequest=null,holder.next?(state.corkedRequestsFree=holder.next,holder.next=null):state.corkedRequestsFree=new CorkedRequest(state)}else{for(;entry;){var chunk=entry.chunk,encoding=entry.encoding,cb=entry.callback,len=state.objectMode?1:chunk.length;if(doWrite(stream,state,!1,len,chunk,encoding,cb),entry=entry.next,state.writing)break}null===entry&&(state.lastBufferedRequest=null)}state.bufferedRequestCount=0,state.bufferedRequest=entry,state.bufferProcessing=!1}function needFinish(state){return state.ending&&0===state.length&&null===state.bufferedRequest&&!state.finished&&!state.writing}function prefinish(stream,state){state.prefinished||(state.prefinished=!0,stream.emit("prefinish"))}function finishMaybe(stream,state){var need=needFinish(state);return need&&(0===state.pendingcb?(prefinish(stream,state),state.finished=!0,stream.emit("finish")):prefinish(stream,state)),need}function endWritable(stream,state,cb){state.ending=!0,finishMaybe(stream,state),cb&&(state.finished?processNextTick(cb):stream.once("finish",cb)),state.ended=!0,stream.writable=!1}function CorkedRequest(state){var _this=this;this.next=null,this.entry=null,this.finish=function(err){var entry=_this.entry;for(_this.entry=null;entry;){var cb=entry.callback;state.pendingcb--,cb(err),entry=entry.next}state.corkedRequestsFree?state.corkedRequestsFree.next=_this:state.corkedRequestsFree=_this}}module.exports=Writable;var Duplex,processNextTick=require("process-nextick-args"),asyncWrite=!process.browser&&["v0.10","v0.9."].indexOf(process.version.slice(0,5))>-1?setImmediate:processNextTick;Writable.WritableState=WritableState;var util=require("core-util-is");util.inherits=require("inherits");var Stream,internalUtil={deprecate:require("util-deprecate")};!function(){try{Stream=require("stream")}catch(_){}finally{Stream||(Stream=require("events").EventEmitter)}}();var Buffer=require("buffer").Buffer,bufferShim=require("buffer-shims");util.inherits(Writable,Stream),WritableState.prototype.getBuffer=function(){for(var current=this.bufferedRequest,out=[];current;)out.push(current),current=current.next;return out},function(){try{Object.defineProperty(WritableState.prototype,"buffer",{get:internalUtil.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")})}catch(_){}}();var realHasInstance;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(realHasInstance=Function.prototype[Symbol.hasInstance],Object.defineProperty(Writable,Symbol.hasInstance,{value:function(object){return!!realHasInstance.call(this,object)||object&&object._writableState instanceof WritableState}})):realHasInstance=function(object){return object instanceof this},Writable.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Writable.prototype.write=function(chunk,encoding,cb){var state=this._writableState,ret=!1;return"function"==typeof encoding&&(cb=encoding,encoding=null),Buffer.isBuffer(chunk)?encoding="buffer":encoding||(encoding=state.defaultEncoding),"function"!=typeof cb&&(cb=nop),state.ended?writeAfterEnd(this,cb):validChunk(this,state,chunk,cb)&&(state.pendingcb++,ret=writeOrBuffer(this,state,chunk,encoding,cb)),ret},Writable.prototype.cork=function(){var state=this._writableState;state.corked++},Writable.prototype.uncork=function(){var state=this._writableState;state.corked&&(state.corked--,state.writing||state.corked||state.finished||state.bufferProcessing||!state.bufferedRequest||clearBuffer(this,state))},Writable.prototype.setDefaultEncoding=function(encoding){if("string"==typeof encoding&&(encoding=encoding.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((encoding+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+encoding);return this._writableState.defaultEncoding=encoding,this},Writable.prototype._write=function(chunk,encoding,cb){cb(new Error("_write() is not implemented"))},Writable.prototype._writev=null,Writable.prototype.end=function(chunk,encoding,cb){var state=this._writableState;"function"==typeof chunk?(cb=chunk,chunk=null,encoding=null):"function"==typeof encoding&&(cb=encoding,encoding=null),null!==chunk&&void 0!==chunk&&this.write(chunk,encoding),state.corked&&(state.corked=1,this.uncork()),state.ending||state.finished||endWritable(this,state,cb)}}).call(this,require("_process"))},{"./_stream_duplex":55,_process:27,buffer:6,"buffer-shims":2,"core-util-is":3,events:9,inherits:20,"process-nextick-args":26,"util-deprecate":68}],60:[function(require,module,exports){"use strict";function BufferList(){this.head=null,this.tail=null,this.length=0}var bufferShim=(require("buffer").Buffer,require("buffer-shims"));module.exports=BufferList,BufferList.prototype.push=function(v){var entry={data:v,next:null};this.length>0?this.tail.next=entry:this.head=entry,this.tail=entry,++this.length},BufferList.prototype.unshift=function(v){var entry={data:v,next:this.head};0===this.length&&(this.tail=entry),this.head=entry,++this.length},BufferList.prototype.shift=function(){if(0!==this.length){var ret=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,ret}},BufferList.prototype.clear=function(){this.head=this.tail=null,this.length=0},BufferList.prototype.join=function(s){if(0===this.length)return"";for(var p=this.head,ret=""+p.data;p=p.next;)ret+=s+p.data;return ret},BufferList.prototype.concat=function(n){if(0===this.length)return bufferShim.alloc(0);if(1===this.length)return this.head.data;for(var ret=bufferShim.allocUnsafe(n>>>0),p=this.head,i=0;p;)p.data.copy(ret,i),i+=p.data.length,p=p.next;return ret}},{buffer:6,"buffer-shims":2}],61:[function(require,module,exports){module.exports=require("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":56}],62:[function(require,module,exports){(function(process){var Stream=function(){try{return require("stream")}catch(_){}}();exports=module.exports=require("./lib/_stream_readable.js"),exports.Stream=Stream||exports,exports.Readable=exports,exports.Writable=require("./lib/_stream_writable.js"),exports.Duplex=require("./lib/_stream_duplex.js"),exports.Transform=require("./lib/_stream_transform.js"),exports.PassThrough=require("./lib/_stream_passthrough.js"),!process.browser&&"disable"===process.env.READABLE_STREAM&&Stream&&(module.exports=Stream)}).call(this,require("_process"))},{"./lib/_stream_duplex.js":55,"./lib/_stream_passthrough.js":56,"./lib/_stream_readable.js":57,"./lib/_stream_transform.js":58,"./lib/_stream_writable.js":59,_process:27}],63:[function(require,module,exports){module.exports=require("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":58}],64:[function(require,module,exports){module.exports=require("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":59}],65:[function(require,module,exports){function Stream(){EE.call(this)}module.exports=Stream;var EE=require("events").EventEmitter,inherits=require("inherits");inherits(Stream,EE),Stream.Readable=require("readable-stream/readable.js"),Stream.Writable=require("readable-stream/writable.js"),Stream.Duplex=require("readable-stream/duplex.js"),Stream.Transform=require("readable-stream/transform.js"),Stream.PassThrough=require("readable-stream/passthrough.js"),Stream.Stream=Stream,Stream.prototype.pipe=function(dest,options){function ondata(chunk){dest.writable&&!1===dest.write(chunk)&&source.pause&&source.pause()}function ondrain(){source.readable&&source.resume&&source.resume()}function onend(){didOnEnd||(didOnEnd=!0,dest.end())}function onclose(){didOnEnd||(didOnEnd=!0,"function"==typeof dest.destroy&&dest.destroy())}function onerror(er){if(cleanup(),0===EE.listenerCount(this,"error"))throw er}function cleanup(){source.removeListener("data",ondata),dest.removeListener("drain",ondrain),source.removeListener("end",onend),source.removeListener("close",onclose),source.removeListener("error",onerror),dest.removeListener("error",onerror),source.removeListener("end",cleanup),source.removeListener("close",cleanup),dest.removeListener("close",cleanup)}var source=this;source.on("data",ondata),dest.on("drain",ondrain),dest._isStdio||options&&options.end===!1||(source.on("end",onend),source.on("close",onclose));var didOnEnd=!1;return source.on("error",onerror),dest.on("error",onerror),source.on("end",cleanup),source.on("close",cleanup),dest.on("close",cleanup),dest.emit("pipe",source),dest}},{events:9,inherits:20,"readable-stream/duplex.js":54,"readable-stream/passthrough.js":61,"readable-stream/readable.js":62,"readable-stream/transform.js":63,"readable-stream/writable.js":64}],66:[function(require,module,exports){function assertEncoding(encoding){if(encoding&&!isBufferEncoding(encoding))throw new Error("Unknown encoding: "+encoding)}function passThroughWrite(buffer){return buffer.toString(this.encoding)}function utf16DetectIncompleteChar(buffer){this.charReceived=buffer.length%2,this.charLength=this.charReceived?2:0}function base64DetectIncompleteChar(buffer){this.charReceived=buffer.length%3,this.charLength=this.charReceived?3:0}var Buffer=require("buffer").Buffer,isBufferEncoding=Buffer.isEncoding||function(encoding){switch(encoding&&encoding.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},StringDecoder=exports.StringDecoder=function(encoding){switch(this.encoding=(encoding||"utf8").toLowerCase().replace(/[-_]/,""),assertEncoding(encoding),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=utf16DetectIncompleteChar;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=base64DetectIncompleteChar;break;default:return void(this.write=passThroughWrite)}this.charBuffer=new Buffer(6),this.charReceived=0,this.charLength=0};StringDecoder.prototype.write=function(buffer){for(var charStr="";this.charLength;){var available=buffer.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:buffer.length;if(buffer.copy(this.charBuffer,this.charReceived,0,available),this.charReceived+=available,this.charReceived<this.charLength)return"";buffer=buffer.slice(available,buffer.length),charStr=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var charCode=charStr.charCodeAt(charStr.length-1);if(!(charCode>=55296&&charCode<=56319)){if(this.charReceived=this.charLength=0,0===buffer.length)return charStr;break}this.charLength+=this.surrogateSize,charStr=""}this.detectIncompleteChar(buffer);var end=buffer.length;this.charLength&&(buffer.copy(this.charBuffer,0,buffer.length-this.charReceived,end),end-=this.charReceived),charStr+=buffer.toString(this.encoding,0,end);var end=charStr.length-1,charCode=charStr.charCodeAt(end);if(charCode>=55296&&charCode<=56319){var size=this.surrogateSize;return this.charLength+=size,this.charReceived+=size,this.charBuffer.copy(this.charBuffer,size,0,size),buffer.copy(this.charBuffer,0,0,size),charStr.substring(0,end)}return charStr},StringDecoder.prototype.detectIncompleteChar=function(buffer){for(var i=buffer.length>=3?3:buffer.length;i>0;i--){var c=buffer[buffer.length-i];if(1==i&&c>>5==6){this.charLength=2;break}if(i<=2&&c>>4==14){this.charLength=3;break}if(i<=3&&c>>3==30){this.charLength=4;break}}this.charReceived=i},StringDecoder.prototype.end=function(buffer){var res="";if(buffer&&buffer.length&&(res=this.write(buffer)),this.charReceived){var cr=this.charReceived,buf=this.charBuffer,enc=this.encoding;res+=buf.slice(0,cr).toString(enc)}return res}},{buffer:6}],67:[function(require,module,exports){(function(global){!function(exportCallback){"use strict";function isDefined(object){var propertyName;if(null===object||void 0===object)return!1;if(objectHelper.isArray(object))return object.length>0;if("string"==typeof object||"number"==typeof object||"boolean"==typeof object)return!0;for(propertyName in object)if(object.hasOwnProperty(propertyName)&&isDefined(object[propertyName]))return!0;return!1}var UriTemplateError=function(){function UriTemplateError(options){this.options=options}return UriTemplateError.prototype.toString=function(){return JSON&&JSON.stringify?JSON.stringify(this.options):this.options},UriTemplateError}(),objectHelper=function(){function isArray(value){return"[object Array]"===Object.prototype.toString.apply(value)}function isString(value){return"[object String]"===Object.prototype.toString.apply(value)}function isNumber(value){return"[object Number]"===Object.prototype.toString.apply(value)}function isBoolean(value){return"[object Boolean]"===Object.prototype.toString.apply(value)}function join(arr,separator){var index,result="",first=!0;for(index=0;index<arr.length;index+=1)first?first=!1:result+=separator,result+=arr[index];return result}function map(arr,mapper){for(var result=[],index=0;index<arr.length;index+=1)result.push(mapper(arr[index]));return result}function filter(arr,predicate){for(var result=[],index=0;index<arr.length;index+=1)predicate(arr[index])&&result.push(arr[index]);return result}function deepFreezeUsingObjectFreeze(object){if("object"!=typeof object||null===object)return object;Object.freeze(object);var property,propertyName;for(propertyName in object)object.hasOwnProperty(propertyName)&&(property=object[propertyName],"object"==typeof property&&deepFreeze(property));return object}function deepFreeze(object){return"function"==typeof Object.freeze?deepFreezeUsingObjectFreeze(object):object}return{isArray:isArray,isString:isString,isNumber:isNumber,isBoolean:isBoolean,join:join,map:map,filter:filter,deepFreeze:deepFreeze}}(),charHelper=function(){function isAlpha(chr){return chr>="a"&&chr<="z"||chr>="A"&&chr<="Z"}function isDigit(chr){return chr>="0"&&chr<="9"}function isHexDigit(chr){return isDigit(chr)||chr>="a"&&chr<="f"||chr>="A"&&chr<="F"}return{isAlpha:isAlpha,isDigit:isDigit,isHexDigit:isHexDigit}}(),pctEncoder=function(){function encodeCharacter(chr){var octet,index,result="",octets=utf8.encode(chr);for(index=0;index<octets.length;index+=1)octet=octets.charCodeAt(index),result+="%"+(octet<16?"0":"")+octet.toString(16).toUpperCase();return result}function isPercentDigitDigit(text,start){return"%"===text.charAt(start)&&charHelper.isHexDigit(text.charAt(start+1))&&charHelper.isHexDigit(text.charAt(start+2))}function parseHex2(text,start){return parseInt(text.substr(start,2),16)}function isPctEncoded(chr){if(!isPercentDigitDigit(chr,0))return!1;var firstCharCode=parseHex2(chr,1),numBytes=utf8.numBytes(firstCharCode);if(0===numBytes)return!1;for(var byteNumber=1;byteNumber<numBytes;byteNumber+=1)if(!isPercentDigitDigit(chr,3*byteNumber)||!utf8.isValidFollowingCharCode(parseHex2(chr,3*byteNumber+1)))return!1;return!0}function pctCharAt(text,startIndex){var chr=text.charAt(startIndex);if(!isPercentDigitDigit(text,startIndex))return chr;var utf8CharCode=parseHex2(text,startIndex+1),numBytes=utf8.numBytes(utf8CharCode);if(0===numBytes)return chr;for(var byteNumber=1;byteNumber<numBytes;byteNumber+=1)if(!isPercentDigitDigit(text,startIndex+3*byteNumber)||!utf8.isValidFollowingCharCode(parseHex2(text,startIndex+3*byteNumber+1)))return chr;return text.substr(startIndex,3*numBytes)}var utf8={encode:function(chr){return unescape(encodeURIComponent(chr))},numBytes:function(firstCharCode){return firstCharCode<=127?1:194<=firstCharCode&&firstCharCode<=223?2:224<=firstCharCode&&firstCharCode<=239?3:240<=firstCharCode&&firstCharCode<=244?4:0},isValidFollowingCharCode:function(charCode){return 128<=charCode&&charCode<=191}};return{encodeCharacter:encodeCharacter,isPctEncoded:isPctEncoded,pctCharAt:pctCharAt}}(),rfcCharHelper=function(){function isVarchar(chr){return charHelper.isAlpha(chr)||charHelper.isDigit(chr)||"_"===chr||pctEncoder.isPctEncoded(chr)}function isUnreserved(chr){return charHelper.isAlpha(chr)||charHelper.isDigit(chr)||"-"===chr||"."===chr||"_"===chr||"~"===chr}function isReserved(chr){return":"===chr||"/"===chr||"?"===chr||"#"===chr||"["===chr||"]"===chr||"@"===chr||"!"===chr||"$"===chr||"&"===chr||"("===chr||")"===chr||"*"===chr||"+"===chr||","===chr||";"===chr||"="===chr||"'"===chr}return{isVarchar:isVarchar,isUnreserved:isUnreserved,isReserved:isReserved}}(),encodingHelper=function(){function encode(text,passReserved){var index,result="",chr="";for("number"!=typeof text&&"boolean"!=typeof text||(text=text.toString()),index=0;index<text.length;index+=chr.length)chr=text.charAt(index),result+=rfcCharHelper.isUnreserved(chr)||passReserved&&rfcCharHelper.isReserved(chr)?chr:pctEncoder.encodeCharacter(chr);return result}function encodePassReserved(text){return encode(text,!0)}function encodeLiteralCharacter(literal,index){var chr=pctEncoder.pctCharAt(literal,index);return chr.length>1?chr:rfcCharHelper.isReserved(chr)||rfcCharHelper.isUnreserved(chr)?chr:pctEncoder.encodeCharacter(chr)}function encodeLiteral(literal){var index,result="",chr="";for(index=0;index<literal.length;index+=chr.length)chr=pctEncoder.pctCharAt(literal,index),result+=chr.length>1?chr:rfcCharHelper.isReserved(chr)||rfcCharHelper.isUnreserved(chr)?chr:pctEncoder.encodeCharacter(chr);return result}return{encode:encode,encodePassReserved:encodePassReserved,encodeLiteral:encodeLiteral,encodeLiteralCharacter:encodeLiteralCharacter}}(),operators=function(){function create(symbol){bySymbol[symbol]={symbol:symbol,separator:"?"===symbol?"&":""===symbol||"+"===symbol||"#"===symbol?",":symbol,named:";"===symbol||"&"===symbol||"?"===symbol,ifEmpty:"&"===symbol||"?"===symbol?"=":"",first:"+"===symbol?"":symbol,encode:"+"===symbol||"#"===symbol?encodingHelper.encodePassReserved:encodingHelper.encode,toString:function(){return this.symbol}}}var bySymbol={};return create(""),create("+"),create("#"),create("."),create("/"),create(";"),create("?"),create("&"),{valueOf:function(chr){return bySymbol[chr]?bySymbol[chr]:"=,!@|".indexOf(chr)>=0?null:bySymbol[""]}}}(),LiteralExpression=function(){function LiteralExpression(literal){this.literal=encodingHelper.encodeLiteral(literal)}return LiteralExpression.prototype.expand=function(){
return this.literal},LiteralExpression.prototype.toString=LiteralExpression.prototype.expand,LiteralExpression}(),parse=function(){function parseExpression(expressionText){function closeVarname(){var varname=expressionText.substring(varnameStart,index);if(0===varname.length)throw new UriTemplateError({expressionText:expressionText,message:"a varname must be specified",position:index});varspec={varname:varname,exploded:!1,maxLength:null},varnameStart=null}function closeMaxLength(){if(maxLengthStart===index)throw new UriTemplateError({expressionText:expressionText,message:"after a ':' you have to specify the length",position:index});varspec.maxLength=parseInt(expressionText.substring(maxLengthStart,index),10),maxLengthStart=null}var operator,index,varspecs=[],varspec=null,varnameStart=null,maxLengthStart=null,chr="";for(operator=function(operatorText){var op=operators.valueOf(operatorText);if(null===op)throw new UriTemplateError({expressionText:expressionText,message:"illegal use of reserved operator",position:index,operator:operatorText});return op}(expressionText.charAt(0)),index=operator.symbol.length,varnameStart=index;index<expressionText.length;index+=chr.length){if(chr=pctEncoder.pctCharAt(expressionText,index),null!==varnameStart){if("."===chr){if(varnameStart===index)throw new UriTemplateError({expressionText:expressionText,message:"a varname MUST NOT start with a dot",position:index});continue}if(rfcCharHelper.isVarchar(chr))continue;closeVarname()}if(null!==maxLengthStart){if(index===maxLengthStart&&"0"===chr)throw new UriTemplateError({expressionText:expressionText,message:"A :prefix must not start with digit 0",position:index});if(charHelper.isDigit(chr)){if(index-maxLengthStart>=4)throw new UriTemplateError({expressionText:expressionText,message:"A :prefix must have max 4 digits",position:index});continue}closeMaxLength()}if(":"!==chr)if("*"!==chr){if(","!==chr)throw new UriTemplateError({expressionText:expressionText,message:"illegal character",character:chr,position:index});varspecs.push(varspec),varspec=null,varnameStart=index+1}else{if(null===varspec)throw new UriTemplateError({expressionText:expressionText,message:"exploded without varspec",position:index});if(varspec.exploded)throw new UriTemplateError({expressionText:expressionText,message:"exploded twice",position:index});if(varspec.maxLength)throw new UriTemplateError({expressionText:expressionText,message:"an explode (*) MUST NOT follow to a prefix",position:index});varspec.exploded=!0}else{if(null!==varspec.maxLength)throw new UriTemplateError({expressionText:expressionText,message:"only one :maxLength is allowed per varspec",position:index});if(varspec.exploded)throw new UriTemplateError({expressionText:expressionText,message:"an exploeded varspec MUST NOT be varspeced",position:index});maxLengthStart=index+1}}return null!==varnameStart&&closeVarname(),null!==maxLengthStart&&closeMaxLength(),varspecs.push(varspec),new VariableExpression(expressionText,operator,varspecs)}function parse(uriTemplateText){var index,chr,expressions=[],braceOpenIndex=null,literalStart=0;for(index=0;index<uriTemplateText.length;index+=1)if(chr=uriTemplateText.charAt(index),null===literalStart){if(null===braceOpenIndex)throw new Error("reached unreachable code");if("{"===chr)throw new UriTemplateError({templateText:uriTemplateText,message:"brace already opened",position:index});if("}"===chr){if(braceOpenIndex+1===index)throw new UriTemplateError({templateText:uriTemplateText,message:"empty braces",position:braceOpenIndex});try{expressions.push(parseExpression(uriTemplateText.substring(braceOpenIndex+1,index)))}catch(error){if(error.prototype===UriTemplateError.prototype)throw new UriTemplateError({templateText:uriTemplateText,message:error.options.message,position:braceOpenIndex+error.options.position,details:error.options});throw error}braceOpenIndex=null,literalStart=index+1}}else{if("}"===chr)throw new UriTemplateError({templateText:uriTemplateText,message:"unopened brace closed",position:index});"{"===chr&&(literalStart<index&&expressions.push(new LiteralExpression(uriTemplateText.substring(literalStart,index))),literalStart=null,braceOpenIndex=index)}if(null!==braceOpenIndex)throw new UriTemplateError({templateText:uriTemplateText,message:"unclosed brace",position:braceOpenIndex});return literalStart<uriTemplateText.length&&expressions.push(new LiteralExpression(uriTemplateText.substr(literalStart))),new UriTemplate(uriTemplateText,expressions)}return parse}(),VariableExpression=function(){function prettyPrint(value){return JSON&&JSON.stringify?JSON.stringify(value):value}function isEmpty(value){if(!isDefined(value))return!0;if(objectHelper.isString(value))return""===value;if(objectHelper.isNumber(value)||objectHelper.isBoolean(value))return!1;if(objectHelper.isArray(value))return 0===value.length;for(var propertyName in value)if(value.hasOwnProperty(propertyName))return!1;return!0}function propertyArray(object){var propertyName,result=[];for(propertyName in object)object.hasOwnProperty(propertyName)&&result.push({name:propertyName,value:object[propertyName]});return result}function VariableExpression(templateText,operator,varspecs){this.templateText=templateText,this.operator=operator,this.varspecs=varspecs}function expandSimpleValue(varspec,operator,value){var result="";if(value=value.toString(),operator.named){if(result+=encodingHelper.encodeLiteral(varspec.varname),""===value)return result+=operator.ifEmpty;result+="="}return null!==varspec.maxLength&&(value=value.substr(0,varspec.maxLength)),result+=operator.encode(value)}function valueDefined(nameValue){return isDefined(nameValue.value)}function expandNotExploded(varspec,operator,value){var arr=[],result="";if(operator.named){if(result+=encodingHelper.encodeLiteral(varspec.varname),isEmpty(value))return result+=operator.ifEmpty;result+="="}return objectHelper.isArray(value)?(arr=value,arr=objectHelper.filter(arr,isDefined),arr=objectHelper.map(arr,operator.encode),result+=objectHelper.join(arr,",")):(arr=propertyArray(value),arr=objectHelper.filter(arr,valueDefined),arr=objectHelper.map(arr,function(nameValue){return operator.encode(nameValue.name)+","+operator.encode(nameValue.value)}),result+=objectHelper.join(arr,",")),result}function expandExplodedNamed(varspec,operator,value){var isArray=objectHelper.isArray(value),arr=[];return isArray?(arr=value,arr=objectHelper.filter(arr,isDefined),arr=objectHelper.map(arr,function(listElement){var tmp=encodingHelper.encodeLiteral(varspec.varname);return tmp+=isEmpty(listElement)?operator.ifEmpty:"="+operator.encode(listElement)})):(arr=propertyArray(value),arr=objectHelper.filter(arr,valueDefined),arr=objectHelper.map(arr,function(nameValue){var tmp=encodingHelper.encodeLiteral(nameValue.name);return tmp+=isEmpty(nameValue.value)?operator.ifEmpty:"="+operator.encode(nameValue.value)})),objectHelper.join(arr,operator.separator)}function expandExplodedUnnamed(operator,value){var arr=[],result="";return objectHelper.isArray(value)?(arr=value,arr=objectHelper.filter(arr,isDefined),arr=objectHelper.map(arr,operator.encode),result+=objectHelper.join(arr,operator.separator)):(arr=propertyArray(value),arr=objectHelper.filter(arr,function(nameValue){return isDefined(nameValue.value)}),arr=objectHelper.map(arr,function(nameValue){return operator.encode(nameValue.name)+"="+operator.encode(nameValue.value)}),result+=objectHelper.join(arr,operator.separator)),result}return VariableExpression.prototype.toString=function(){return this.templateText},VariableExpression.prototype.expand=function(variables){var index,varspec,value,valueIsArr,expanded=[],oneExploded=!1,operator=this.operator;for(index=0;index<this.varspecs.length;index+=1)if(varspec=this.varspecs[index],value=variables[varspec.varname],null!==value&&void 0!==value)if(varspec.exploded&&(oneExploded=!0),valueIsArr=objectHelper.isArray(value),"string"==typeof value||"number"==typeof value||"boolean"==typeof value)expanded.push(expandSimpleValue(varspec,operator,value));else{if(varspec.maxLength&&isDefined(value))throw new Error("Prefix modifiers are not applicable to variables that have composite values. You tried to expand "+this+" with "+prettyPrint(value));varspec.exploded?isDefined(value)&&(operator.named?expanded.push(expandExplodedNamed(varspec,operator,value)):expanded.push(expandExplodedUnnamed(operator,value))):!operator.named&&isEmpty(value)||expanded.push(expandNotExploded(varspec,operator,value))}return 0===expanded.length?"":operator.first+objectHelper.join(expanded,operator.separator)},VariableExpression}(),UriTemplate=function(){function UriTemplate(templateText,expressions){this.templateText=templateText,this.expressions=expressions,objectHelper.deepFreeze(this)}return UriTemplate.prototype.toString=function(){return this.templateText},UriTemplate.prototype.expand=function(variables){var index,result="";for(index=0;index<this.expressions.length;index+=1)result+=this.expressions[index].expand(variables);return result},UriTemplate.parse=parse,UriTemplate.UriTemplateError=UriTemplateError,UriTemplate}();exportCallback(UriTemplate)}(function(UriTemplate){"use strict";"undefined"!=typeof module?module.exports=UriTemplate:"function"==typeof define?define([],function(){return UriTemplate}):"undefined"!=typeof window?window.UriTemplate=UriTemplate:global.UriTemplate=UriTemplate})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],68:[function(require,module,exports){(function(global){function deprecate(fn,msg){function deprecated(){if(!warned){if(config("throwDeprecation"))throw new Error(msg);config("traceDeprecation")?console.trace(msg):console.warn(msg),warned=!0}return fn.apply(this,arguments)}if(config("noDeprecation"))return fn;var warned=!1;return deprecated}function config(name){try{if(!global.localStorage)return!1}catch(_){return!1}var val=global.localStorage[name];return null!=val&&"true"===String(val).toLowerCase()}module.exports=deprecate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],69:[function(require,module,exports){(function(process,Buffer){var Url=require("url"),spawn=require("child_process").spawn,fs=require("fs");exports.XMLHttpRequest=function(){var request,response,self=this,http=require("http"),https=require("https"),settings={},disableHeaderCheck=!1,defaultHeaders={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},headers=defaultHeaders,forbiddenRequestHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],forbiddenRequestMethods=["TRACE","TRACK","CONNECT"],sendFlag=!1,errorFlag=!1,listeners={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null;var isAllowedHttpHeader=function(header){return disableHeaderCheck||header&&forbiddenRequestHeaders.indexOf(header.toLowerCase())===-1},isAllowedHttpMethod=function(method){return method&&forbiddenRequestMethods.indexOf(method)===-1};this.open=function(method,url,async,user,password){if(this.abort(),errorFlag=!1,!isAllowedHttpMethod(method))throw"SecurityError: Request method not allowed";settings={method:method,url:url.toString(),async:"boolean"!=typeof async||async,user:user||null,password:password||null},setState(this.OPENED)},this.setDisableHeaderCheck=function(state){disableHeaderCheck=state},this.setRequestHeader=function(header,value){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN";if(!isAllowedHttpHeader(header))return void console.warn('Refused to set unsafe header "'+header+'"');if(sendFlag)throw"INVALID_STATE_ERR: send flag is true";headers[header]=value},this.getResponseHeader=function(header){return"string"==typeof header&&this.readyState>this.OPENED&&response.headers[header.toLowerCase()]&&!errorFlag?response.headers[header.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||errorFlag)return"";var result="";for(var i in response.headers)"set-cookie"!==i&&"set-cookie2"!==i&&(result+=i+": "+response.headers[i]+"\r\n");return result.substr(0,result.length-2)},this.getRequestHeader=function(name){return"string"==typeof name&&headers[name]?headers[name]:""},this.send=function(data){function responseHandler(resp){if(response=resp,302===response.statusCode||303===response.statusCode||307===response.statusCode){settings.url=response.headers.location;var url=Url.parse(settings.url);host=url.hostname;var newOptions={hostname:url.hostname,port:url.port,path:url.path,method:303===response.statusCode?"GET":settings.method,headers:headers};return request=doRequest(newOptions,responseHandler).on("error",errorHandler),void request.end()}response.setEncoding("utf8"),setState(self.HEADERS_RECEIVED),self.status=response.statusCode,response.on("data",function(chunk){chunk&&(self.responseText+=chunk),sendFlag&&setState(self.LOADING)}),response.on("end",function(){sendFlag&&(setState(self.DONE),sendFlag=!1)}),response.on("error",function(error){self.handleError(error)})}function errorHandler(error){self.handleError(error)}if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: connection must be opened before send() is called";if(sendFlag)throw"INVALID_STATE_ERR: send has already been called";var host,ssl=!1,local=!1,url=Url.parse(settings.url);switch(url.protocol){case"https:":ssl=!0;case"http:":host=url.hostname;break;case"file:":local=!0;break;case void 0:case"":host="localhost";break;default:throw"Protocol not supported."}if(local){if("GET"!==settings.method)throw"XMLHttpRequest: Only GET method is supported";if(settings.async)fs.readFile(url.pathname,"utf8",function(error,data){error?self.handleError(error):(self.status=200,self.responseText=data,setState(self.DONE))});else try{this.responseText=fs.readFileSync(url.pathname,"utf8"),this.status=200,setState(self.DONE)}catch(e){this.handleError(e)}}else{var port=url.port||(ssl?443:80),uri=url.pathname+(url.search?url.search:"");if(headers.Host=host,ssl&&443===port||80===port||(headers.Host+=":"+url.port),settings.user){"undefined"==typeof settings.password&&(settings.password="");var authBuf=new Buffer(settings.user+":"+settings.password);headers.Authorization="Basic "+authBuf.toString("base64")}"GET"===settings.method||"HEAD"===settings.method?data=null:data?(headers["Content-Length"]=Buffer.isBuffer(data)?data.length:Buffer.byteLength(data),headers["Content-Type"]||(headers["Content-Type"]="text/plain;charset=UTF-8")):"POST"===settings.method&&(headers["Content-Length"]=0);var options={host:host,port:port,path:uri,method:settings.method,headers:headers,agent:!1};if(errorFlag=!1,settings.async){var doRequest=ssl?https.request:http.request;sendFlag=!0,self.dispatchEvent("readystatechange"),request=doRequest(options,responseHandler).on("error",errorHandler),data&&request.write(data),request.end(),self.dispatchEvent("loadstart")}else{var contentFile=".node-xmlhttprequest-content-"+process.pid,syncFile=".node-xmlhttprequest-sync-"+process.pid;fs.writeFileSync(syncFile,"","utf8");for(var execString="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(ssl?"s":"")+".request;var options = "+JSON.stringify(options)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+contentFile+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+syncFile+"');});response.on('error', function(error) {fs.writeFileSync('"+contentFile+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+syncFile+"');});}).on('error', function(error) {fs.writeFileSync('"+contentFile+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+syncFile+"');});"+(data?"req.write('"+data.replace(/'/g,"\\'")+"');":"")+"req.end();",syncProc=spawn(process.argv[0],["-e",execString]);fs.existsSync(syncFile););if(self.responseText=fs.readFileSync(contentFile,"utf8"),syncProc.stdin.end(),fs.unlinkSync(contentFile),self.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var errorObj=self.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");self.handleError(errorObj)}else self.status=self.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),self.responseText=self.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),setState(self.DONE)}}},this.handleError=function(error){this.status=503,this.statusText=error,this.responseText=error.stack,errorFlag=!0,setState(this.DONE)},this.abort=function(){request&&(request.abort(),request=null),headers=defaultHeaders,this.responseText="",this.responseXML="",errorFlag=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!sendFlag||this.readyState===this.DONE||(sendFlag=!1,setState(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(event,callback){event in listeners||(listeners[event]=[]),listeners[event].push(callback)},this.removeEventListener=function(event,callback){event in listeners&&(listeners[event]=listeners[event].filter(function(ev){return ev!==callback}))},this.dispatchEvent=function(event){if("function"==typeof self["on"+event]&&self["on"+event](),event in listeners)for(var i=0,len=listeners[event].length;i<len;i++)listeners[event][i].call(self)};var setState=function(state){self.readyState!==state&&(self.readyState=state,(settings.async||self.readyState<self.OPENED||self.readyState===self.DONE)&&self.dispatchEvent("readystatechange"),self.readyState!==self.DONE||errorFlag||(self.dispatchEvent("load"),self.dispatchEvent("loadend")))}}}).call(this,require("_process"),require("buffer").Buffer)},{_process:27,buffer:6,child_process:5,fs:5,http:11,https:16,url:15}],70:[function(require,module,exports){function extend(){for(var target={},i=0;i<arguments.length;i++){var source=arguments[i];for(var key in source)hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}module.exports=extend;var hasOwnProperty=Object.prototype.hasOwnProperty},{}],71:[function(require,module,exports){module.exports=function(object,path,setter){for(var isSetter=arguments.length>2,i=0;i<path.length;i++){var prop=path[i];isSetter&&(i===path.length-1?object[prop]=setter:prop in object||(object[prop]={})),object=object[prop]}return object}},{}],72:[function(require,module,exports){var _=App.Library._,async=App.Library.async,template=require("./client-generator/template"),ORDER_PREFERENCE=["OAuth 2.0","OAuth 1.0","Basic Authentication"],DEFAULT_REQUIRED_FIELDS={"OAuth 1.0":{consumerKey:!0,consumerSecret:!0},"OAuth 2.0":{clientId:!0,clientSecret:!0},"Basic Authentication":{username:!0,password:!0}},DEFAULT_POSSIBLE_FIELDS={"OAuth 1.0":["consumerKey","consumerSecret"],"OAuth 2.0":["clientId","clientSecret","scopes"],"Basic Authentication":["username","password"]},DEFAULT_PROMPT_TITLES={"OAuth 1.0":"Please Enter Your OAuth 1.0 Keys","OAuth 2.0":"Please Enter Your OAuth 2.0 Keys","Basic Authentication":"Please Enter Your Username and Password"},DEFAULT_FIELD_NAMES={consumerKey:"Consumer Key",consumerSecret:"Consumer Secret",clientId:"Client ID",clientSecret:"Client Secret",scopes:"Permissions",username:"Username",password:"Password"},SECRET_FIELDS={clientSecret:!0,consumerSecret:!0,password:!0},requiredTokens=function(scheme){var keys=_.extend({},DEFAULT_REQUIRED_FIELDS[scheme.type]);return"OAuth 2.0"===scheme.type&&(keys.clientSecret=!_.contains(scheme.settings.authorizationGrants,"token")),keys},sanitizeScope=function(scopes){return _.isString(scopes)?scopes.split(" "):Array.isArray(scopes)?scopes:[]},hasRequiredTokens=function(scheme,tokens){return _.every(requiredTokens(scheme),function(value,key){return!value||tokens[key]})},promptTokens=function(scheme,options,done){var cancelled=!0,needsTokens=requiredTokens(scheme),possibleTokens=_.filter(DEFAULT_POSSIBLE_FIELDS[scheme.type],function(token){return needsTokens[token]!==!1});options.scopes=sanitizeScope(options.scope||options.scopes),delete options.scope;var promptForm=_.map(possibleTokens,function(key){if("scopes"===key){var scopes=sanitizeScope(scheme.settings.scopes);if(!scopes.length)return"";var scopeOptions=_.map(scopes,function(scope){var hasScope=_.contains(options.scopes,scope)||1===scopes.length;return['<div class="checkbox">',"<label>",'<input type="checkbox" id="scopes" value="'+scope+'" '+(hasScope?"checked":"")+">",scope,"</label>","</div>"].join("")}).join("\n");return['<div class="form-group">','<label class="form-label">'+DEFAULT_FIELD_NAMES[key]+"</label>",'<div class="form-content">'+scopeOptions+"</div>","</div>"].join("\n")}return['<div class="form-group">','<label for="'+key+'" class="form-label">',DEFAULT_FIELD_NAMES[key],"</label>",'<div class="form-content">','<input id="'+key+'" value="'+(options[key]||"")+'"'+(SECRET_FIELDS[key]?' type="password"':"")+">","</div>","</div>"].join("")}).join("\n");return App.middleware.trigger("ui:modal",{title:DEFAULT_PROMPT_TITLES[scheme.type],content:["<p>","This API requires authentication. Please enter your application keys.","</p>","<p><em>We do not store your keys.</em></p>","<form>",promptForm,'<div class="form-footer">','<button type="submit" class="btn btn-primary">Submit</button>',"</div>","</form>"].join("\n"),show:function(modal){modal.el.querySelector("form").addEventListener("submit",function(e){e.preventDefault(),_.each(this.querySelectorAll("input"),function(el){var name=el.getAttribute("id");if("scopes"===name){var indexOf=_.indexOf(options.scopes,el.value);el.checked?indexOf<0&&options.scopes.push(el.value):indexOf>-1&&options.scopes.splice(indexOf,1)}else options[name]=el.value.trim()}),cancelled=!1,modal.close()})}},function(err){return done(err||(cancelled?new Error("Modal closed"):null),options)})},authenticate=function(scheme,options,done){var opts=_.defaults({type:scheme.type},options,scheme.settings);_.each(["accessTokenUri","authorizationUri","requestTokenUri","authorizationUri","tokenCredentialsUri"],function(param){opts[param]=template(opts[param],opts.baseUriParameters)}),App.middleware.trigger("authenticate",opts,function(err,tokens){return err?done(err):tokens?done(null,scheme,options,tokens):done(new Error("Authentication failed"))},!0)},requestTokens=function(scheme,options,done){var cb=function(err,tokens){return done(err,_.extend({},tokens,options))};return App.middleware.trigger("ramlClient:token",scheme,cb,!0)},preferredScheme=function(schemes){if(schemes&&Object.keys(schemes).length){var method=_.intersection(ORDER_PREFERENCE,_.pluck(schemes,"type"))[0];return method?_.find(schemes,function(scheme){return scheme.type===method}):schemes[_.keys(schemes)[0]]}},retrieveTokens=function(schemes,options,done){var tokens;async.detectSeries(_.map(schemes,function(secured,method){return schemes[method]}),function(scheme,cb){return requestTokens(scheme,options,function(err,data){return cb(!err&&data&&hasRequiredTokens(scheme,data)?tokens=data:!1)})},function(scheme){return scheme?done(null,scheme,tokens):(scheme=preferredScheme(schemes),scheme?promptTokens(scheme,options,function(err,tokens){return done(err,scheme,tokens)}):done(new Error("No schemes available")))})},resolveScheme=function(schemes,options,done){return retrieveTokens(schemes,options,function(err,scheme,tokens){return err?done(err):authenticate(scheme,tokens,done)})};exports=module.exports=function(schemes,method,options,done){var auth=_.extend({},options);if(!method)return resolveScheme(schemes,auth,done);if(!Object.prototype.hasOwnProperty.call(schemes,method))return done(new Error("The only available authentication methods are: "+_.keys(schemes).map(JSON.stringify).join(", ")));var scheme=schemes[method];return hasRequiredTokens(scheme,auth)?authenticate(scheme,auth,done):requestTokens(scheme,auth,function(err,data){return err?done(err):hasRequiredTokens(scheme,_.defaults(auth,data))?authenticate(scheme,auth,done):promptTokens(scheme,auth,function(err,tokens){return err?done(err):authenticate(scheme,tokens,done)})})},exports.SECRET_FIELDS=SECRET_FIELDS},{"./client-generator/template":75}],73:[function(require,module,exports){var _=App.Library._,qs=App.Library.qs,template=require("./template"),sanitizeAST=require("./sanitize-ast"),CONFIG_PROPERTY="!config",CLIENT_PROPERTY="!client",JSON_REGEXP=/^application\/([\w!#\$%&\*`\-\.\^~]*\+)?json$/i,HTTP_METHODS=["get","head","put","post","patch","delete"],RETURN_PROPERTY="!return",DESCRIPTION_PROPERTY="!description",CONFIG_OPTIONS=["body","proxy","uriParameters","baseUri","baseUriParameters","headers","query","beforeSend"],OVERRIDABLE_CONFIG_OPTIONS=_.object(["body","proxy","baseUri","beforeSend"],!0),EXTENSION_DESCRIPTION={"!type":"fn(extension)","!args":[{"!type":"string","!doc":"Set the file extension with relevant `Accept` header."}],"!doc":["Set the path extension and corresponding accept header."].join(" ")},CLIENT_DESCRIPTION={"!type":"fn(url, data?)","!args":[{"!type":"string","!doc":"Provide a url relative to the base uri."},{"!type":"object","!doc":"Provide a data object to replace template tags in the `url`."}],"!doc":["Make an API request to a custom URL."].join(" ")},authMap={"OAuth 1.0":"oauth1","OAuth 2.0":"oauth2","Basic Authentication":"basicAuth"},toFormData=function(data){var form=new FormData;return _.each(data,function(value,key){form.append(key,value)}),form},parse=[[JSON_REGEXP,JSON.parse],["application/x-www-form-urlencoded",qs.parse]],serialize=[[JSON_REGEXP,JSON.stringify],["application/x-www-form-urlencoded",qs.stringify],["multipart/form-data",toFormData]],getMatch=function(array,test){var match=_.find(array,function(value){var check=value[0];return _.isRegExp(check)?check.test(test):check===test});return match&&match[1]},mimePreference=function(mime){return getMatch([[JSON_REGEXP,3],["application/x-www-form-urlencoded",2],["multipart/form-data",1]],mime)||0},codifyMarkdown=function(str){return"`"+str+"`"},ramlBodyToMarkdown=function(body){var mimes=_.keys(body).sort(mimePreference),documentation=[];return mimes.length>1&&documentation.push("The body for this resource supports multiple content types. By default, "+codifyMarkdown(mimes[0])+" will be used. However, you can easily specify another `Content-Type` to be used."),_.each(mimes,function(mime){var contentType=body[mime];_.isObject(contentType)&&(mimes.length>1&&documentation.push("When the content type is "+codifyMarkdown(mime)+":"),contentType.formParameters&&_.each(contentType.formParameters,function(param,key){documentation.push("* **"+key+(param.required?"":"?")+":** *"+param.type+"* "+param.description)}),contentType.example&&documentation.push("**Example:**","```\n"+contentType.example+"\n```"),contentType.schema&&documentation.push("**Schema:**","```\n"+contentType.schema+"\n```"))}),documentation.join("\n\n")},isQueryMethod=function(method){return"get"===method||"head"===method},METHOD_DESCRIPTION=_.object(_.map(HTTP_METHODS,function(method){var body=isQueryMethod(method)?"query?":"body?";return[method,{"!type":"fn("+body+", options?, async?)"}]})),ramlToDocumentationFormat=function(object){var documentation={};return _.each(object,function(object,key){documentation[key]={"!doc":object.description,"!type":object.type,"!required":object.required}}),documentation},toMethodDescription=function(nodes,method){var isQuery=isQueryMethod(method.method),configOptions={"!type":"object"},bodyOptions={"!type":"object"},callbackOptions={"!doc":"Pass a function to make the request execute asynchonously.","!type":"fn(error, response)"};return configOptions.proxy={"!type":"string|boolean","!doc":"Disable or set a custom proxy url for the current request."},configOptions.beforeSend={"!type":"fn(xhr)","!doc":"Modify the `XMLHttpRequest` before it gets sent."},configOptions.headers=_.extend({"!type":"object"},ramlToDocumentationFormat(method.headers)),isQuery?(_.extend(bodyOptions,ramlToDocumentationFormat(method.queryParameters)),configOptions.body={"!type":"object","!doc":ramlBodyToMarkdown(method.body)}):(bodyOptions={"!type":"object|string","!doc":ramlBodyToMarkdown(method.body)},configOptions.query=_.extend({"!type":"object"},ramlToDocumentationFormat(method.queryParameters))),nodes.client.baseUriParameters&&(configOptions.baseUriParameters=_.extend({"!type":"object"},ramlToDocumentationFormat(nodes.client.baseUriParameters))),_.extend({"!doc":method.description,"!args":[bodyOptions,configOptions,callbackOptions]},METHOD_DESCRIPTION[method.method])},allHttpMethods=_.chain(HTTP_METHODS).map(function(method){return[method,{method:method}]}).object().value(),getAllReponseHeaders=function(xhr){var responseHeaders={};return _.each(xhr.getAllResponseHeaders().split("\n"),function(header){if(header=header.split(":"),header.length>1){var name=header.shift(),value=header.join(":").trim();responseHeaders[name.toLowerCase()]=value}}),responseHeaders},getMime=function(contentType){return null==contentType?null:String(contentType).split(";")[0]},isHost=function(obj){var str=Object.prototype.toString.call(obj);switch(str){case"[object File]":case"[object Blob]":case"[object String]":case"[object Number]":case"[object Boolean]":case"[object FormData]":return!0;default:return!1}},sanitizeOption={query:function(query){return _.isString(query)?qs.parse(query):query}},findHeader=function(headers,header){return header=header.toLowerCase(),_.find(headers,function(value,name){return name.toLowerCase()===header})},sanitizeXHR=function(xhr){if(!xhr)return xhr;var mime=getMime(xhr.getResponseHeader("Content-Type")),body=xhr.responseText.trim(),headers=getAllReponseHeaders(xhr);return body=body?(getMatch(parse,mime)||_.identity)(body):void 0,{body:body,status:xhr.status,headers:headers}},httpRequest=function(nodes,method){return function(body,config,done){_.isFunction(arguments[1])&&(done=arguments[1],config=null),config=config||{},config=_.object(CONFIG_OPTIONS,_.map(CONFIG_OPTIONS,function(option){if(_.has(OVERRIDABLE_CONFIG_OPTIONS,option))return _.has(config,option)?config[option]:nodes.config[option];var nodeOption=nodes.config[option],configOption=config&&config[option],sanitize=sanitizeOption[option]||_.identity;return _.extend({},sanitize(nodeOption),sanitize(configOption))}));var async=!!done,request="ajax",mime=getMime(findHeader(config.headers,"Content-Type")),baseUri=template(config.baseUri,config.baseUriParameters),fullUri=baseUri.replace(/\/+$/,"")+"/"+nodes.join("/");if(async?(App._executeContext.timeout(1/0),_.isFunction(done)||(done=App._executeContext.async())):done=function(err,res){if(err)throw err;return res},isQueryMethod(method.method)&&(_.extend(config.query,sanitizeOption.query(body)),body=null),null!=body&&(config.body=body),_.keys(config.query).length&&(fullUri+="?"+qs.stringify(config.query)),findHeader(config.headers,"accept")||(config.headers.accept="*/*"),!isHost(config.body)){null==mime&&("object"==typeof method.body&&(mime=_.keys(method.body).sort(mimePreference).pop()),config.headers["Content-Type"]=mime=mime||"application/json");var serializer=getMatch(serialize,mime);if(!serializer)return done(new TypeError('Can not serialize content type of "'+mime+'"'));try{config.body=serializer(config.body)}catch(e){return done(new TypeError("Could not serialize body: "+e.message))}}var options={url:fullUri,data:config.body,async:async,proxy:config.proxy,method:method.method,headers:config.headers,beforeSend:config.beforeSend};_.some(method.securedBy||nodes.client.securedBy,function(secured,key){var scheme=nodes.client.securitySchemes[key];if(scheme){var authenticated=nodes.client.authentication[scheme.type],authType=authMap[scheme.type];
return authenticated?(options[authType]=authenticated,request="ajax:"+authType):void 0}});var response,error;if(App.middleware.trigger(request,options,function(err,xhr){if(error=err,!error)try{response=sanitizeXHR(xhr)}catch(e){error=new TypeError("Could not parse response: "+e.message)}return async&&done(error,response)}),!async)return done(error,response)}},attachMethods=function(nodes,context,methods){return _.each(methods,function(method,verb){context[verb]=httpRequest(nodes,method),context[verb][DESCRIPTION_PROPERTY]=toMethodDescription(nodes,method)}),context},attachMediaTypeExtension=function(nodes,context,resource){return context.extension=function(extension){extension=null==extension?"":String(extension),extension&&"."!==extension.charAt(0)&&(extension="."+extension);var newContext={},routeNodes=_.extend([],nodes);return routeNodes[routeNodes.length-1]+=extension,attachMethods(routeNodes,newContext,resource.methods),attachResources(routeNodes,newContext,resource.resources),newContext},context.extension[RETURN_PROPERTY]=context.extension(""),context.extension[DESCRIPTION_PROPERTY]=EXTENSION_DESCRIPTION,resource.uriParameters.mediaTypeExtension.required===!1&&attachMethods(nodes,context,resource.methods),_.each(resource.uriParameters.mediaTypeExtension["enum"],function(extension){"."===extension.charAt(0)&&(extension=extension.substr(1)),context[extension]=context.extension(extension)}),context},newContext=function(nodes,resource,hasMediaExtension,context){return context=context||{},hasMediaExtension?attachMediaTypeExtension(nodes,context,resource):(attachMethods(nodes,context,resource.methods),attachResources(nodes,context,resource.resources)),context},attachResources=function(nodes,context,resources){return _.each(resources,function(resource,route){var routeNodes=_.extend([],nodes),routeName=route,hasMediaExtension="{mediaTypeExtension}"===route.substr(-20);hasMediaExtension&&(route=routeName=route.slice(0,-20));var templateTags=route.match(template.REGEXP);if(routeNodes.push(route),templateTags){var routeSuffix=templateTags.join("");if(route.substr(-routeSuffix.length)!==routeSuffix)return!1;if(routeName=1===templateTags.length&&route===templateTags[0]?templateTags[0].slice(1,-1):route.substr(0,route.indexOf("{")),!routeName)return!1;var tags=_.map(templateTags,function(param){return resource.uriParameters[param.slice(1,-1)]});return context[routeName]=_.extend(function(){var args=arguments,parts=_.map(tags,function(tag,index){if(null==args[index]&&tag["enum"]&&1===tag["enum"].length)return tag["enum"][0];if(index in args)return args[index];var param=templateTags[index].slice(1,-1);return routeNodes.config&&routeNodes.config.uriParameters[param]});return routeNodes[routeNodes.length-1]=template(route,parts),newContext(routeNodes,resource,hasMediaExtension)},context[routeName]),context[routeName][DESCRIPTION_PROPERTY]={"!type":"fn("+_.map(tags,function(param){return param.displayName+(param.required?"":"?")}).join(", ")+")","!args":_.map(tags,function(param){return{"!type":param.type,"!doc":param.description}}),"!doc":"Dynamically inject variables into the request path."},context[routeName][RETURN_PROPERTY]=newContext(routeNodes,resource,hasMediaExtension),context[routeName]}routeName?context[routeName]=newContext(routeNodes,resource,hasMediaExtension,context[routeName]):context=newContext(routeNodes,resource,hasMediaExtension,context)}),context},generateClient=function(ast,config){var baseUriParameters=_.extend({},_.pick(ast,"version"),config.baseUriParameters),nodes=_.extend([],{config:_.extend({baseUri:ast.baseUri},config,{baseUriParameters:baseUriParameters}),client:{securedBy:ast.securedBy,authentication:{},securitySchemes:ast.securitySchemes,baseUriParameters:ast.baseUriParameters}});if(!_.isString(nodes.config.baseUri))throw new Error('A "baseUri" string is required');var client=function(path,context){var route=template(path||"",context||{}).replace(/^\/+/,"").split("/");return attachMethods(_.extend([],nodes,route),{},allHttpMethods)};return client[CONFIG_PROPERTY]=nodes.config,client[CLIENT_PROPERTY]=nodes.client,client[DESCRIPTION_PROPERTY]=CLIENT_DESCRIPTION,client[RETURN_PROPERTY]=attachMethods(nodes,{},allHttpMethods),attachResources(nodes,client,ast.resources),client};module.exports=function(ast,config){return generateClient(sanitizeAST(ast),config)}},{"./sanitize-ast":74,"./template":75}],74:[function(require,module,exports){var _=App.Library._,sanitizeSecuredBy=function(secured){if(!Array.isArray(secured))return null;var securedBy={};return _.each(secured,function(value){if(null!=value)return _.isString(value)?securedBy[value]=!0:_.extend(securedBy,value)}),securedBy};module.exports=function(ast){var sanitizedAst=_.pick(ast,["title","version","baseUri","baseUriParameters"]);return ast.securitySchemes&&(sanitizedAst.securitySchemes=_.extend.apply(_,ast.securitySchemes)),ast.securedBy&&(sanitizedAst.securedBy=sanitizeSecuredBy(ast.securedBy)),sanitizedAst.resources=function flattenResources(resources){var map={};return _.each(resources,function(resource){var sanitizedResource={};resource.methods&&(sanitizedResource.methods=_.object(_.pluck(resource.methods,"method"),_.map(resource.methods,function(method){var sanitizedMethod=_.pick(method,["method","body","headers","description","queryParameters"]);return method.securedBy&&(sanitizedMethod.securedBy=sanitizeSecuredBy(method.securedBy)),sanitizedMethod}))),resource.resources&&(sanitizedResource.resources=flattenResources(resource.resources)),function attachResource(map,segments){var segment=segments.shift(),part=map[segment]=map[segment]||{};segments.length||(part=map[segment]=sanitizedResource);var tags=_.map(segment.match(/\{([^\}]+)\}/g),function(tag){return tag.slice(1,-1)});if(tags.length&&(part.uriParameters=_.pick(resource.uriParameters,tags)),segments.length)return part.resources=part.resources||{},attachResource(part.resources,segments)}(map,resource.relativeUri.substr(1).split("/"))}),map}(ast.resources),sanitizedAst}},{}],75:[function(require,module,exports){var _=App.Library._,URI_PARAM_REGEXP=/{[^}]+}/g;exports=module.exports=function(string,context){if(context=context||{},null==string)return null;if(_.isArray(context)){var index=0;return string.replace(URI_PARAM_REGEXP,function(){return encodeURIComponent(context[index++]||"")})}return string.replace(URI_PARAM_REGEXP,function(match){return encodeURIComponent(context[match.slice(1,-1)]||"")})},exports.REGEXP=URI_PARAM_REGEXP},{}],76:[function(require,module,exports){var _=App._,ramlParser=require("raml-parser"),authenticate=require("./authenticate"),clientGenerator=require("./client-generator"),fromPath=require("../../lib/from-path"),plugin=({proxy:{proxyUrl:"/proxy"},envVariables:{yodaLink:"https://api.beta.yaas.io/hybris/yoda/v1",oauthService:"https://api.beta.yaas.io/hybris/oauth2/v1",accountService:"https://api.beta.yaas.io/hybris/account/v1/",APIManangementService:"https://api.beta.yaas.io/hybris/api-management/v1/",packageService:"https://api.beta.yaas.io/hybris/package/v1",clientId:"AhvOOZ7fLGgJu2PUZCOFTLsum0DqFCQH",redirUrl:"http://127.0.0.1:9778/auth.html",loginCssUrl:"https://devportal.yaas.io/styles/auth-iframe.css"},customLocation:{path:"./apinotebooks",mode:"external"}}||{}).customLocation||{},MODE=plugin.mode;require("./inject-api-keys"),require("./insert-api-client");var DESCRIPTION_PROPERTY="!description",createReader=function(config){return new ramlParser.FileReader(function(url){var deferred=this.q.defer();return App.middleware.trigger("ajax",{url:url,proxy:config.proxy,headers:{Accept:"application/raml+yaml, */*"}},function(err,xhr){return err?deferred.reject(err):2!==Math.floor(xhr.status/100)?deferred.reject(new Error("Received status code "+xhr.status+" loading "+url)):deferred.resolve(xhr.responseText)}),deferred.promise})},API={};API.createClient=function(name,uri,config,done){if(!_.isString(name))throw new Error("Provide a name for the generated client");if(!_.isString(uri))throw new Error("Provide a URL for the "+name+" RAML document");"function"==typeof config&&(done=arguments[2],config={}),App._executeContext.timeout(1/0),done=done||App._executeContext.async(),config=config||{};var createClient=function(ast){try{fromPath(App._executeWindow,name.split("."),clientGenerator(ast,config))}catch(e){return done(e)}return done(null,'Create a new code cell and type "'+name+'." to explore this API.')};return App.middleware.trigger("ajax",{url:uri,proxy:"local"===MODE&&config.proxy,headers:{Accept:"application/raml+yaml, application/json, */*"}},function(err,xhr){if(err)return console.log(err),done(err);if(2!==Math.floor(xhr.status/100))return done(new Error("HTTP "+xhr.status));try{return createClient(JSON.parse(xhr.responseText))}catch(e){console.log(e)}return ramlParser.load(xhr.responseText,uri,{reader:createReader(config)}).then(createClient,done)})},API.createClient[DESCRIPTION_PROPERTY]={"!type":"fn(alias, url, options?, cb?)","!args":[{"!type":"string"},{"!type":"string"},{"!type":"object","!doc":["Initialize the client with default config options. Valid options:","* **proxy**: Set to a custom proxy or `false` to disable entirely","* **body**: Set a fallback request body","* **uriParameters**: Set fallback uri parameters to inject","* **baseUri:** Override the base uri","* **baseUriParameters**: Inject base uri parameters to override","* **headers**: Set default headers to send with every request","* **query**: Set a default query string to send with every request"].join("\n")},{"!type":"fn(error, client)","!doc":["Pass in a custom callback to run when the client has loaded."].join("\n")}],"!doc":["Generate an API client from a RAML document and alias it on the window."].join(" ")},API.set=function(client,key,value){return arguments.length<3?_.extend(client["!config"],key):client["!config"][key]=value},API.set[DESCRIPTION_PROPERTY]={"!type":"fn(client, key, value)","!args":[{"!type":"fn()","!doc":"A function generated by `API.createClient`."},{"!type":"string"}],"!doc":"Set a configuration option of a RAML API client."},API.get=function(client,key){return arguments.length<2?client["!config"]:client["!config"][key]},API.get[DESCRIPTION_PROPERTY]={"!type":"fn(client, key)","!args":[{"!type":"fn()","!doc":"A function generated by `API.createClient`."},{"!type":"string"}],"!doc":"Get a configuration option from a RAML API client."},API.unset=function(client,key){return arguments.length<2?(_.each(client["!config"],function(value,key,obj){delete obj[key]}),!0):delete client["!config"][key]},API.unset[DESCRIPTION_PROPERTY]={"!type":"fn(client, key)","!args":[{"!type":"fn()","!doc":"A function generated by `API.createClient`."},{"!type":"string"}],"!doc":"Unset a configuration option from a RAML API client."},API.authenticate=function(client,method,options,done){App._executeContext.timeout(6e5),done=done||App._executeContext.async();var clientOption=client["!client"],securitySchemes=clientOption.securitySchemes;options=_.extend({},options,client["!config"]);var cb=function(err,scheme,options,tokens){return err?done(err):(clientOption.authentication[scheme.type]=_.extend({},options,tokens),_.each(tokens,function(value,key){authenticate.SECRET_FIELDS[key]&&(tokens[key]=new Array(5*Math.ceil(value.length/5)).join("*"))}),done(null,tokens))};return authenticate(securitySchemes,method,options,cb)},API.authenticate[DESCRIPTION_PROPERTY]={"!type":["fn(client, method?, options?, cb?)"].join(""),"!args":[{"!type":"fn()","!doc":"A function generated by `API.createClient`."},{"!type":"string","!doc":"Select an authentication method defined in the RAML file."},{"!type":"object","!doc":"Override the default selected authentication method options."},{"!type":"fn(error, response)"}],"!doc":["Authentication parameters are optional. For popular APIs, we provide","keys. If we need your keys we will prompt you via a modal. Never enter","keys directly into a notebook unless you explicitly intend to share","them. If you would like to know more about authenticating","with this API, see 'securityScheme.settings' in the RAML file."].join(" ")},exports["sandbox:context"]=function(context,next){return Object.defineProperty(context,"API",{value:API}),next()}},{"../../lib/from-path":71,"./authenticate":72,"./client-generator":73,"./inject-api-keys":77,"./insert-api-client":78,"raml-parser":42}],77:[function(require,module,exports){var apiKeys={proxy:{proxyUrl:"/proxy"},envVariables:{yodaLink:"https://api.beta.yaas.io/hybris/yoda/v1",oauthService:"https://api.beta.yaas.io/hybris/oauth2/v1",accountService:"https://api.beta.yaas.io/hybris/account/v1/",APIManangementService:"https://api.beta.yaas.io/hybris/api-management/v1/",packageService:"https://api.beta.yaas.io/hybris/package/v1",clientId:"AhvOOZ7fLGgJu2PUZCOFTLsum0DqFCQH",redirUrl:"http://127.0.0.1:9778/auth.html",loginCssUrl:"https://devportal.yaas.io/styles/auth-iframe.css"},customLocation:{path:"./apinotebooks",mode:"external"}}.ramlClient;App.middleware.register("ramlClient:token",function(scheme,next,done){var authUri=scheme.settings.authorizationUri;return"OAuth 1.0"===scheme.type&&apiKeys.oauth1[authUri]?done(null,apiKeys.oauth1[authUri]):"OAuth 2.0"===scheme.type&&apiKeys.oauth2[authUri]?done(null,apiKeys.oauth2[authUri]):next()})},{}],78:[function(require,module,exports){var _=App.Library._,qs=App.Library.qs,domify=App.Library.domify,Backbone=App.Library.Backbone,changeCase=App.Library.changeCase,BASE_URI="https://anypoint.mulesoft.com/apiplatform/repository/v2/organizations/52560d3f-c37a-409d-9887-79e0a9a9ecff/public/portals",ITEMS_PER_PAGE=10,createApiClientCell=function(cell,invoke){return function(err,api,version){if(!err){var variable=changeCase.camelCase(api.name),view=cell.notebook[invoke+"CodeView"](cell.el,["// Read about the "+api.name+" at "+version.portalUrl,"API.createClient('"+variable+"', '"+version.ramlUrl+"');"].join("\n")).execute();return cell.focus(),App.messages.trigger("ramlClient:insert"),view}}},selectAPIDefinition=function(done){App.messages.trigger("ramlClient:modal");var searchSpec={offset:0,limit:ITEMS_PER_PAGE,query:""};return App.middleware.trigger("ui:modal",{title:"Insert an API Client",content:function(done){return done(null,'<div class="modal-instructions">Insert an API client from a RAML specification. An API client is a JavaScript representation of an API that you can use to explore available endpoints and their parameters. <a href="http://raml.org/" target="_blank">Learn more about RAML</a>.</div><div class="form-group"><input class="item-search" placeholder="Search"></div><div class="items-loading" style="text-align: center; font-size: 3em;"><i class="icon-arrows-cw animate-spin"></i></div><div class="items-container clearfix"><ul class="items-list"></ul><button class="btn-secondary items-prev-btn" style="float: left">Previous</button><button class="btn-secondary items-next-btn" style="float: right">Next</button></div><p class="items-unavailable">No matching APIs found.</p>')},show:function(modal){var searchId,itemsEl=modal.el.querySelector(".items-container"),itemsListEl=itemsEl.querySelector(".items-list"),itemsLoadingEl=modal.el.querySelector(".items-loading"),itemsNextBtnEl=itemsEl.querySelector(".items-next-btn"),itemsPrevBtnEl=itemsEl.querySelector(".items-prev-btn"),itemsUnavailableEl=modal.el.querySelector(".items-unavailable"),loadAPIDefinitions=function(search,done){var currentSearchId=Math.random();return searchId=currentSearchId,itemsEl.classList.add("hide"),itemsUnavailableEl.classList.add("hide"),itemsLoadingEl.classList.remove("hide"),itemsNextBtnEl.setAttribute("disabled","disabled"),itemsPrevBtnEl.setAttribute("disabled","disabled"),App.middleware.trigger("ramlClient:search",search,function(err,data){if(currentSearchId===searchId)return done(err,data)})},updateResults=function(err,result){return itemsLoadingEl.classList.add("hide"),itemsListEl.innerHTML="",err?done(err):result.items?(itemsEl.classList.remove("hide"),searchSpec.offset>0&&itemsPrevBtnEl.removeAttribute("disabled"),searchSpec.offset<result.total-searchSpec.limit&&itemsNextBtnEl.removeAttribute("disabled"),void _.each(result.items,function(item){var name=_.escape(item.name),el=domify(["<li>",'<div class="item-info clearfix">','<div class="item-action">','<button class="btn btn-primary btn-small item-add">Add</button>',"</div>",'<a href="#" class="item-link">All versions</a>','<div class="item-name">'+name+"</div>","</div>",'<div class="item-versions">',_.map(item.versions,function(version,index){var name=_.escape(version.name),description=_.escape(version.description),portalUrl=_.escape(version.portalUrl);return['<div class="item-version clearfix">','<div class="item-action">','<button class="btn btn-primary btn-small item-add" data-index="'+index+'">',"Select","</button>","</div>",'<a href="'+portalUrl+'" class="item-link item-read-more" target="_blank">Read more</a>','<div class="item-name">','<span class="hint--top" data-hint="'+description+'">',name,"</span>","</div>","</div>"].join("\n")}).join("\n"),"</div>","</li>"].join("\n"));itemsListEl.appendChild(el),Backbone.$(el).on("click",function(e){if(!e.target.classList.contains("item-read-more")){e.preventDefault();var method="add";el.classList.contains("item-visible")&&(method="remove"),el.classList[method]("item-visible")}}).on("click",".item-add",function(e,el){modal.close(),e.stopPropagation();var version=item.versions[el.getAttribute("data-index")||0];return done(null,item,version)})})):itemsUnavailableEl.classList.remove("hide")};return Backbone.$(modal.el).on("click",".items-next-btn",function(){return loadAPIDefinitions(_.extend(searchSpec,{offset:searchSpec.offset+ITEMS_PER_PAGE}),updateResults)}).on("click",".items-prev-btn",function(){return loadAPIDefinitions(_.extend(searchSpec,{offset:searchSpec.offset-ITEMS_PER_PAGE}),updateResults)}).on("keyup",".item-search",_.throttle(function(e,el){if(searchSpec.query!==el.value)return loadAPIDefinitions(_.extend(searchSpec,{offset:0,query:el.value}),updateResults)},700)),loadAPIDefinitions(searchSpec,updateResults)}})};App.View.EditorCell.prototype.newRAMLAbove=function(){return selectAPIDefinition(createApiClientCell(this,"prepend"))},App.View.EditorCell.prototype.newRAMLBelow=function(){return selectAPIDefinition(createApiClientCell(this,"append"))},App.middleware.register("ramlClient:search",function(search,next,done){var url=BASE_URI+"?"+qs.stringify({sort:"name",ascending:!0,limit:search.limit,offset:search.offset,query:search.query});return App.middleware.trigger("ajax",{url:url},function(err,xhr){var result,data={};if(err)return done(err);try{result=JSON.parse(xhr.responseText)}catch(e){return done(e)}return data.total=result.total,data.items=result.apis.map(function(item){return{name:item.name,versions:item.versions.map(function(version){return{name:version.name,portalUrl:"https://anypoint.mulesoft.com/apiplatform/popular/#/portals/organizations/"+version.organizationId+"/apis/"+version.apiId+"/versions/"+version.id,ramlUrl:"https://anypoint.mulesoft.com/apiplatform/repository/v2/organizations/"+version.organizationId+"/public/apis/"+version.apiId+"/versions/"+version.id+"/files/root",description:version.description,deprecated:version.deprecated,tags:version.tags}})}}),done(null,data)})})},{}]},{},[76])(76)});